üîó Found pyo3 bindings
üêç Found CPython 3.13 at /projects/bfdz/zluo8/tool_and_judge2/.venv/bin/python
    Finished `release` profile [optimized] target(s) in 1.39s
üìñ Found type stub file at codebase_rs.pyi
üì¶ Built wheel for CPython 3.13 to /tmp/.tmpPVRL90/codebase_rs-0.1.0-cp313-cp313-linux_x86_64.whl
üõ† Installed codebase_rs-0.1.0
/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/transformers/models/auto/tokenization_auto.py:1041: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=355773)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=355773)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=355773)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=355773)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=355773)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=355773)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=355773)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=355773)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355773)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=355773)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=355773)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=355773)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=355773)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=355773)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=355773)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=355773)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=355773)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355773)[0;0m     )
[0;36m(EngineCore_DP0 pid=355773)[0;0m     ^
[0;36m(EngineCore_DP0 pid=355773)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=355773)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=355773)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355773)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=355773)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=355773)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=355773)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=355773)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=355773)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=355773)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=355773)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=355773)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355773)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=355773)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=355773)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=355773)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=355773)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355773)[0;0m     )
[0;36m(EngineCore_DP0 pid=355773)[0;0m     ^
[0;36m(EngineCore_DP0 pid=355773)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=355773)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=355773)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=355773)[0;0m     )
[0;36m(EngineCore_DP0 pid=355773)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=355773)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=355773)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=355773)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=355773)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=355773)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=355773)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355773)[0;0m     )
[0;36m(EngineCore_DP0 pid=355773)[0;0m     ^
[0;36m(EngineCore_DP0 pid=355773)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=355773)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=355773)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355773)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=355773)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=355773)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=355773)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=355773)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355773)[0;0m     )
[0;36m(EngineCore_DP0 pid=355773)[0;0m     ^
[0;36m(EngineCore_DP0 pid=355773)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=355773)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=355773)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355773)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=355773)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=355773)[0;0m         config,
[0;36m(EngineCore_DP0 pid=355773)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=355773)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=355773)[0;0m     )
[0;36m(EngineCore_DP0 pid=355773)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=355773)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=355773)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=355773)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=355773)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355773)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=355773)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=355773)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355773)[0;0m     )
[0;36m(EngineCore_DP0 pid=355773)[0;0m     ^
[0;36m(EngineCore_DP0 pid=355773)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=355773)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=355773)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=355773)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=355773)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355773)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=355773)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=355773)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355773)[0;0m     )
[0;36m(EngineCore_DP0 pid=355773)[0;0m     ^
[0;36m(EngineCore_DP0 pid=355773)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=355773)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=355773)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355773)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=355773)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=355773)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=355773)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=355773)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355773)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=355773)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=355773)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355773)[0;0m     ),
[0;36m(EngineCore_DP0 pid=355773)[0;0m     ^
[0;36m(EngineCore_DP0 pid=355773)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=355773)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=355773)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/transformers/models/auto/tokenization_auto.py:1041: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=355835)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=355835)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=355835)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=355835)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=355835)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=355835)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=355835)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=355835)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355835)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=355835)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=355835)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=355835)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=355835)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=355835)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=355835)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=355835)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=355835)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355835)[0;0m     )
[0;36m(EngineCore_DP0 pid=355835)[0;0m     ^
[0;36m(EngineCore_DP0 pid=355835)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=355835)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=355835)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355835)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=355835)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=355835)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=355835)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=355835)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=355835)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=355835)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=355835)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=355835)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355835)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=355835)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=355835)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=355835)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=355835)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355835)[0;0m     )
[0;36m(EngineCore_DP0 pid=355835)[0;0m     ^
[0;36m(EngineCore_DP0 pid=355835)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=355835)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=355835)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=355835)[0;0m     )
[0;36m(EngineCore_DP0 pid=355835)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=355835)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=355835)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=355835)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=355835)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=355835)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=355835)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355835)[0;0m     )
[0;36m(EngineCore_DP0 pid=355835)[0;0m     ^
[0;36m(EngineCore_DP0 pid=355835)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=355835)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=355835)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355835)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=355835)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=355835)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=355835)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=355835)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355835)[0;0m     )
[0;36m(EngineCore_DP0 pid=355835)[0;0m     ^
[0;36m(EngineCore_DP0 pid=355835)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=355835)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=355835)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355835)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=355835)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=355835)[0;0m         config,
[0;36m(EngineCore_DP0 pid=355835)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=355835)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=355835)[0;0m     )
[0;36m(EngineCore_DP0 pid=355835)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=355835)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=355835)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=355835)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=355835)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355835)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=355835)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=355835)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355835)[0;0m     )
[0;36m(EngineCore_DP0 pid=355835)[0;0m     ^
[0;36m(EngineCore_DP0 pid=355835)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=355835)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=355835)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=355835)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=355835)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355835)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=355835)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=355835)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355835)[0;0m     )
[0;36m(EngineCore_DP0 pid=355835)[0;0m     ^
[0;36m(EngineCore_DP0 pid=355835)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=355835)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=355835)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355835)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=355835)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=355835)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=355835)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=355835)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355835)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=355835)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=355835)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355835)[0;0m     ),
[0;36m(EngineCore_DP0 pid=355835)[0;0m     ^
[0;36m(EngineCore_DP0 pid=355835)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=355835)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=355835)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=355897)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=355897)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=355897)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=355897)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=355897)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=355897)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=355897)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=355897)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355897)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=355897)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=355897)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=355897)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=355897)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=355897)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=355897)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=355897)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=355897)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355897)[0;0m     )
[0;36m(EngineCore_DP0 pid=355897)[0;0m     ^
[0;36m(EngineCore_DP0 pid=355897)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=355897)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=355897)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355897)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=355897)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=355897)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=355897)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=355897)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=355897)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=355897)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=355897)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=355897)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355897)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=355897)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=355897)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=355897)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=355897)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355897)[0;0m     )
[0;36m(EngineCore_DP0 pid=355897)[0;0m     ^
[0;36m(EngineCore_DP0 pid=355897)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=355897)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=355897)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=355897)[0;0m     )
[0;36m(EngineCore_DP0 pid=355897)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=355897)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=355897)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=355897)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=355897)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=355897)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=355897)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355897)[0;0m     )
[0;36m(EngineCore_DP0 pid=355897)[0;0m     ^
[0;36m(EngineCore_DP0 pid=355897)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=355897)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=355897)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355897)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=355897)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=355897)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=355897)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=355897)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355897)[0;0m     )
[0;36m(EngineCore_DP0 pid=355897)[0;0m     ^
[0;36m(EngineCore_DP0 pid=355897)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=355897)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=355897)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355897)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=355897)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=355897)[0;0m         config,
[0;36m(EngineCore_DP0 pid=355897)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=355897)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=355897)[0;0m     )
[0;36m(EngineCore_DP0 pid=355897)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=355897)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=355897)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=355897)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=355897)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355897)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=355897)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=355897)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355897)[0;0m     )
[0;36m(EngineCore_DP0 pid=355897)[0;0m     ^
[0;36m(EngineCore_DP0 pid=355897)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=355897)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=355897)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=355897)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=355897)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355897)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=355897)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=355897)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355897)[0;0m     )
[0;36m(EngineCore_DP0 pid=355897)[0;0m     ^
[0;36m(EngineCore_DP0 pid=355897)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=355897)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=355897)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355897)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=355897)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=355897)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=355897)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=355897)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355897)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=355897)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=355897)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=355897)[0;0m     ),
[0;36m(EngineCore_DP0 pid=355897)[0;0m     ^
[0;36m(EngineCore_DP0 pid=355897)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=355897)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=355897)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=356302)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=356302)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=356302)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=356302)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=356302)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=356302)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=356302)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=356302)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356302)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=356302)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=356302)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=356302)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=356302)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=356302)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=356302)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356302)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=356302)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356302)[0;0m     )
[0;36m(EngineCore_DP0 pid=356302)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356302)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=356302)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=356302)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356302)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=356302)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=356302)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=356302)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=356302)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=356302)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=356302)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=356302)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=356302)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356302)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=356302)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=356302)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356302)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=356302)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356302)[0;0m     )
[0;36m(EngineCore_DP0 pid=356302)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356302)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=356302)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=356302)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=356302)[0;0m     )
[0;36m(EngineCore_DP0 pid=356302)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=356302)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=356302)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=356302)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=356302)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356302)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=356302)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356302)[0;0m     )
[0;36m(EngineCore_DP0 pid=356302)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356302)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=356302)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=356302)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356302)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=356302)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=356302)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356302)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=356302)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356302)[0;0m     )
[0;36m(EngineCore_DP0 pid=356302)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356302)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=356302)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=356302)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356302)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=356302)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=356302)[0;0m         config,
[0;36m(EngineCore_DP0 pid=356302)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=356302)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=356302)[0;0m     )
[0;36m(EngineCore_DP0 pid=356302)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=356302)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=356302)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356302)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=356302)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356302)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=356302)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=356302)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356302)[0;0m     )
[0;36m(EngineCore_DP0 pid=356302)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356302)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=356302)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=356302)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356302)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=356302)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356302)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=356302)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=356302)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356302)[0;0m     )
[0;36m(EngineCore_DP0 pid=356302)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356302)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=356302)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=356302)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356302)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=356302)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=356302)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356302)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=356302)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356302)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=356302)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=356302)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356302)[0;0m     ),
[0;36m(EngineCore_DP0 pid=356302)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356302)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=356302)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=356302)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=356364)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=356364)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=356364)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=356364)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=356364)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=356364)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=356364)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=356364)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356364)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=356364)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=356364)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=356364)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=356364)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=356364)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=356364)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356364)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=356364)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356364)[0;0m     )
[0;36m(EngineCore_DP0 pid=356364)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356364)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=356364)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=356364)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356364)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=356364)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=356364)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=356364)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=356364)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=356364)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=356364)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=356364)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=356364)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356364)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=356364)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=356364)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356364)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=356364)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356364)[0;0m     )
[0;36m(EngineCore_DP0 pid=356364)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356364)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=356364)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=356364)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=356364)[0;0m     )
[0;36m(EngineCore_DP0 pid=356364)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=356364)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=356364)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=356364)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=356364)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356364)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=356364)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356364)[0;0m     )
[0;36m(EngineCore_DP0 pid=356364)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356364)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=356364)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=356364)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356364)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=356364)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=356364)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356364)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=356364)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356364)[0;0m     )
[0;36m(EngineCore_DP0 pid=356364)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356364)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=356364)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=356364)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356364)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=356364)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=356364)[0;0m         config,
[0;36m(EngineCore_DP0 pid=356364)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=356364)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=356364)[0;0m     )
[0;36m(EngineCore_DP0 pid=356364)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=356364)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=356364)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356364)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=356364)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356364)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=356364)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=356364)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356364)[0;0m     )
[0;36m(EngineCore_DP0 pid=356364)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356364)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=356364)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=356364)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356364)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=356364)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356364)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=356364)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=356364)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356364)[0;0m     )
[0;36m(EngineCore_DP0 pid=356364)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356364)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=356364)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=356364)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356364)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=356364)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=356364)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356364)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=356364)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356364)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=356364)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=356364)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356364)[0;0m     ),
[0;36m(EngineCore_DP0 pid=356364)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356364)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=356364)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=356364)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=356426)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=356426)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=356426)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=356426)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=356426)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=356426)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=356426)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=356426)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356426)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=356426)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=356426)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=356426)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=356426)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=356426)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=356426)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356426)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=356426)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356426)[0;0m     )
[0;36m(EngineCore_DP0 pid=356426)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356426)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=356426)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=356426)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356426)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=356426)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=356426)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=356426)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=356426)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=356426)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=356426)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=356426)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=356426)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356426)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=356426)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=356426)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356426)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=356426)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356426)[0;0m     )
[0;36m(EngineCore_DP0 pid=356426)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356426)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=356426)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=356426)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=356426)[0;0m     )
[0;36m(EngineCore_DP0 pid=356426)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=356426)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=356426)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=356426)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=356426)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356426)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=356426)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356426)[0;0m     )
[0;36m(EngineCore_DP0 pid=356426)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356426)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=356426)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=356426)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356426)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=356426)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=356426)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356426)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=356426)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356426)[0;0m     )
[0;36m(EngineCore_DP0 pid=356426)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356426)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=356426)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=356426)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356426)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=356426)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=356426)[0;0m         config,
[0;36m(EngineCore_DP0 pid=356426)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=356426)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=356426)[0;0m     )
[0;36m(EngineCore_DP0 pid=356426)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=356426)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=356426)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356426)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=356426)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356426)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=356426)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=356426)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356426)[0;0m     )
[0;36m(EngineCore_DP0 pid=356426)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356426)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=356426)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=356426)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356426)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=356426)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356426)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=356426)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=356426)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356426)[0;0m     )
[0;36m(EngineCore_DP0 pid=356426)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356426)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=356426)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=356426)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356426)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=356426)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=356426)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356426)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=356426)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356426)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=356426)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=356426)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356426)[0;0m     ),
[0;36m(EngineCore_DP0 pid=356426)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356426)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=356426)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=356426)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=356488)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=356488)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=356488)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=356488)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=356488)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=356488)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=356488)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=356488)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356488)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=356488)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=356488)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=356488)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=356488)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=356488)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=356488)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356488)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=356488)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356488)[0;0m     )
[0;36m(EngineCore_DP0 pid=356488)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356488)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=356488)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=356488)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356488)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=356488)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=356488)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=356488)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=356488)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=356488)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=356488)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=356488)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=356488)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356488)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=356488)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=356488)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356488)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=356488)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356488)[0;0m     )
[0;36m(EngineCore_DP0 pid=356488)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356488)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=356488)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=356488)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=356488)[0;0m     )
[0;36m(EngineCore_DP0 pid=356488)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=356488)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=356488)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=356488)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=356488)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356488)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=356488)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356488)[0;0m     )
[0;36m(EngineCore_DP0 pid=356488)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356488)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=356488)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=356488)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356488)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=356488)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=356488)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356488)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=356488)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356488)[0;0m     )
[0;36m(EngineCore_DP0 pid=356488)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356488)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=356488)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=356488)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356488)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=356488)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=356488)[0;0m         config,
[0;36m(EngineCore_DP0 pid=356488)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=356488)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=356488)[0;0m     )
[0;36m(EngineCore_DP0 pid=356488)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=356488)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=356488)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356488)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=356488)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356488)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=356488)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=356488)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356488)[0;0m     )
[0;36m(EngineCore_DP0 pid=356488)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356488)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=356488)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=356488)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356488)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=356488)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356488)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=356488)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=356488)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356488)[0;0m     )
[0;36m(EngineCore_DP0 pid=356488)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356488)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=356488)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=356488)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356488)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=356488)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=356488)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356488)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=356488)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356488)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=356488)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=356488)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356488)[0;0m     ),
[0;36m(EngineCore_DP0 pid=356488)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356488)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=356488)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=356488)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=356550)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=356550)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=356550)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=356550)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=356550)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=356550)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=356550)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=356550)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356550)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=356550)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=356550)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=356550)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=356550)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=356550)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=356550)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356550)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=356550)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356550)[0;0m     )
[0;36m(EngineCore_DP0 pid=356550)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356550)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=356550)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=356550)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356550)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=356550)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=356550)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=356550)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=356550)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=356550)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=356550)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=356550)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=356550)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356550)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=356550)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=356550)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356550)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=356550)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356550)[0;0m     )
[0;36m(EngineCore_DP0 pid=356550)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356550)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=356550)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=356550)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=356550)[0;0m     )
[0;36m(EngineCore_DP0 pid=356550)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=356550)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=356550)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=356550)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=356550)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356550)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=356550)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356550)[0;0m     )
[0;36m(EngineCore_DP0 pid=356550)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356550)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=356550)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=356550)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356550)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=356550)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=356550)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356550)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=356550)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356550)[0;0m     )
[0;36m(EngineCore_DP0 pid=356550)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356550)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=356550)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=356550)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356550)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=356550)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=356550)[0;0m         config,
[0;36m(EngineCore_DP0 pid=356550)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=356550)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=356550)[0;0m     )
[0;36m(EngineCore_DP0 pid=356550)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=356550)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=356550)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356550)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=356550)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356550)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=356550)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=356550)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356550)[0;0m     )
[0;36m(EngineCore_DP0 pid=356550)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356550)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=356550)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=356550)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356550)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=356550)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356550)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=356550)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=356550)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356550)[0;0m     )
[0;36m(EngineCore_DP0 pid=356550)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356550)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=356550)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=356550)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356550)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=356550)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=356550)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356550)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=356550)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356550)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=356550)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=356550)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356550)[0;0m     ),
[0;36m(EngineCore_DP0 pid=356550)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356550)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=356550)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=356550)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=356612)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=356612)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=356612)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=356612)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=356612)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=356612)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=356612)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=356612)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356612)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=356612)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=356612)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=356612)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=356612)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=356612)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=356612)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356612)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=356612)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356612)[0;0m     )
[0;36m(EngineCore_DP0 pid=356612)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356612)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=356612)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=356612)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356612)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=356612)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=356612)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=356612)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=356612)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=356612)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=356612)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=356612)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=356612)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356612)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=356612)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=356612)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356612)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=356612)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356612)[0;0m     )
[0;36m(EngineCore_DP0 pid=356612)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356612)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=356612)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=356612)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=356612)[0;0m     )
[0;36m(EngineCore_DP0 pid=356612)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=356612)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=356612)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=356612)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=356612)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356612)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=356612)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356612)[0;0m     )
[0;36m(EngineCore_DP0 pid=356612)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356612)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=356612)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=356612)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356612)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=356612)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=356612)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356612)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=356612)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356612)[0;0m     )
[0;36m(EngineCore_DP0 pid=356612)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356612)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=356612)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=356612)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356612)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=356612)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=356612)[0;0m         config,
[0;36m(EngineCore_DP0 pid=356612)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=356612)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=356612)[0;0m     )
[0;36m(EngineCore_DP0 pid=356612)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=356612)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=356612)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356612)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=356612)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356612)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=356612)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=356612)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356612)[0;0m     )
[0;36m(EngineCore_DP0 pid=356612)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356612)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=356612)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=356612)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356612)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=356612)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356612)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=356612)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=356612)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356612)[0;0m     )
[0;36m(EngineCore_DP0 pid=356612)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356612)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=356612)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=356612)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356612)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=356612)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=356612)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356612)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=356612)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356612)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=356612)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=356612)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356612)[0;0m     ),
[0;36m(EngineCore_DP0 pid=356612)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356612)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=356612)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=356612)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=356675)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=356675)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=356675)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=356675)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=356675)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=356675)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=356675)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=356675)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356675)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=356675)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=356675)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=356675)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=356675)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=356675)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=356675)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356675)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=356675)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356675)[0;0m     )
[0;36m(EngineCore_DP0 pid=356675)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356675)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=356675)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=356675)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356675)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=356675)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=356675)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=356675)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=356675)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=356675)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=356675)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=356675)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=356675)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356675)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=356675)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=356675)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356675)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=356675)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356675)[0;0m     )
[0;36m(EngineCore_DP0 pid=356675)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356675)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=356675)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=356675)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=356675)[0;0m     )
[0;36m(EngineCore_DP0 pid=356675)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=356675)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=356675)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=356675)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=356675)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356675)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=356675)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356675)[0;0m     )
[0;36m(EngineCore_DP0 pid=356675)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356675)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=356675)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=356675)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356675)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=356675)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=356675)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356675)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=356675)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356675)[0;0m     )
[0;36m(EngineCore_DP0 pid=356675)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356675)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=356675)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=356675)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356675)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=356675)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=356675)[0;0m         config,
[0;36m(EngineCore_DP0 pid=356675)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=356675)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=356675)[0;0m     )
[0;36m(EngineCore_DP0 pid=356675)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=356675)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=356675)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356675)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=356675)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356675)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=356675)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=356675)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356675)[0;0m     )
[0;36m(EngineCore_DP0 pid=356675)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356675)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=356675)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=356675)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356675)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=356675)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356675)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=356675)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=356675)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356675)[0;0m     )
[0;36m(EngineCore_DP0 pid=356675)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356675)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=356675)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=356675)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356675)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=356675)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=356675)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356675)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=356675)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356675)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=356675)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=356675)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356675)[0;0m     ),
[0;36m(EngineCore_DP0 pid=356675)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356675)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=356675)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=356675)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=356737)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=356737)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=356737)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=356737)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=356737)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=356737)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=356737)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=356737)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356737)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=356737)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=356737)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=356737)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=356737)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=356737)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=356737)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356737)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=356737)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356737)[0;0m     )
[0;36m(EngineCore_DP0 pid=356737)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356737)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=356737)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=356737)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356737)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=356737)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=356737)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=356737)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=356737)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=356737)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=356737)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=356737)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=356737)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356737)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=356737)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=356737)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356737)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=356737)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356737)[0;0m     )
[0;36m(EngineCore_DP0 pid=356737)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356737)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=356737)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=356737)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=356737)[0;0m     )
[0;36m(EngineCore_DP0 pid=356737)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=356737)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=356737)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=356737)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=356737)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356737)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=356737)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356737)[0;0m     )
[0;36m(EngineCore_DP0 pid=356737)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356737)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=356737)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=356737)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356737)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=356737)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=356737)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356737)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=356737)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356737)[0;0m     )
[0;36m(EngineCore_DP0 pid=356737)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356737)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=356737)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=356737)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356737)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=356737)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=356737)[0;0m         config,
[0;36m(EngineCore_DP0 pid=356737)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=356737)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=356737)[0;0m     )
[0;36m(EngineCore_DP0 pid=356737)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=356737)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=356737)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356737)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=356737)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356737)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=356737)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=356737)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356737)[0;0m     )
[0;36m(EngineCore_DP0 pid=356737)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356737)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=356737)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=356737)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356737)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=356737)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356737)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=356737)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=356737)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356737)[0;0m     )
[0;36m(EngineCore_DP0 pid=356737)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356737)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=356737)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=356737)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356737)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=356737)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=356737)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=356737)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=356737)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356737)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=356737)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=356737)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=356737)[0;0m     ),
[0;36m(EngineCore_DP0 pid=356737)[0;0m     ^
[0;36m(EngineCore_DP0 pid=356737)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=356737)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=356737)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=357143)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=357143)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=357143)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=357143)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=357143)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357143)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=357143)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=357143)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357143)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=357143)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=357143)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=357143)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=357143)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=357143)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=357143)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357143)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=357143)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357143)[0;0m     )
[0;36m(EngineCore_DP0 pid=357143)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357143)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=357143)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=357143)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357143)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=357143)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=357143)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357143)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=357143)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=357143)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357143)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=357143)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=357143)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357143)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=357143)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=357143)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357143)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=357143)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357143)[0;0m     )
[0;36m(EngineCore_DP0 pid=357143)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357143)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=357143)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=357143)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=357143)[0;0m     )
[0;36m(EngineCore_DP0 pid=357143)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=357143)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=357143)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=357143)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=357143)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357143)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=357143)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357143)[0;0m     )
[0;36m(EngineCore_DP0 pid=357143)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357143)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=357143)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=357143)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357143)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=357143)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=357143)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357143)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=357143)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357143)[0;0m     )
[0;36m(EngineCore_DP0 pid=357143)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357143)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=357143)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=357143)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357143)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=357143)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=357143)[0;0m         config,
[0;36m(EngineCore_DP0 pid=357143)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=357143)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=357143)[0;0m     )
[0;36m(EngineCore_DP0 pid=357143)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=357143)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=357143)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357143)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=357143)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357143)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=357143)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=357143)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357143)[0;0m     )
[0;36m(EngineCore_DP0 pid=357143)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357143)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=357143)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=357143)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357143)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=357143)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357143)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=357143)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=357143)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357143)[0;0m     )
[0;36m(EngineCore_DP0 pid=357143)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357143)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=357143)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=357143)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357143)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=357143)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=357143)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357143)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=357143)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357143)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=357143)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=357143)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357143)[0;0m     ),
[0;36m(EngineCore_DP0 pid=357143)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357143)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=357143)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=357143)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=357205)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=357205)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=357205)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=357205)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=357205)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357205)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=357205)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=357205)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357205)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=357205)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=357205)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=357205)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=357205)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=357205)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=357205)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357205)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=357205)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357205)[0;0m     )
[0;36m(EngineCore_DP0 pid=357205)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357205)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=357205)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=357205)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357205)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=357205)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=357205)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357205)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=357205)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=357205)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357205)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=357205)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=357205)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357205)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=357205)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=357205)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357205)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=357205)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357205)[0;0m     )
[0;36m(EngineCore_DP0 pid=357205)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357205)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=357205)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=357205)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=357205)[0;0m     )
[0;36m(EngineCore_DP0 pid=357205)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=357205)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=357205)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=357205)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=357205)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357205)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=357205)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357205)[0;0m     )
[0;36m(EngineCore_DP0 pid=357205)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357205)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=357205)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=357205)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357205)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=357205)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=357205)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357205)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=357205)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357205)[0;0m     )
[0;36m(EngineCore_DP0 pid=357205)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357205)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=357205)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=357205)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357205)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=357205)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=357205)[0;0m         config,
[0;36m(EngineCore_DP0 pid=357205)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=357205)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=357205)[0;0m     )
[0;36m(EngineCore_DP0 pid=357205)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=357205)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=357205)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357205)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=357205)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357205)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=357205)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=357205)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357205)[0;0m     )
[0;36m(EngineCore_DP0 pid=357205)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357205)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=357205)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=357205)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357205)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=357205)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357205)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=357205)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=357205)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357205)[0;0m     )
[0;36m(EngineCore_DP0 pid=357205)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357205)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=357205)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=357205)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357205)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=357205)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=357205)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357205)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=357205)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357205)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=357205)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=357205)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357205)[0;0m     ),
[0;36m(EngineCore_DP0 pid=357205)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357205)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=357205)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=357205)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=357267)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=357267)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=357267)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=357267)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=357267)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357267)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=357267)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=357267)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357267)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=357267)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=357267)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=357267)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=357267)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=357267)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=357267)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357267)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=357267)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357267)[0;0m     )
[0;36m(EngineCore_DP0 pid=357267)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357267)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=357267)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=357267)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357267)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=357267)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=357267)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357267)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=357267)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=357267)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357267)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=357267)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=357267)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357267)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=357267)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=357267)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357267)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=357267)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357267)[0;0m     )
[0;36m(EngineCore_DP0 pid=357267)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357267)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=357267)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=357267)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=357267)[0;0m     )
[0;36m(EngineCore_DP0 pid=357267)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=357267)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=357267)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=357267)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=357267)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357267)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=357267)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357267)[0;0m     )
[0;36m(EngineCore_DP0 pid=357267)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357267)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=357267)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=357267)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357267)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=357267)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=357267)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357267)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=357267)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357267)[0;0m     )
[0;36m(EngineCore_DP0 pid=357267)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357267)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=357267)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=357267)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357267)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=357267)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=357267)[0;0m         config,
[0;36m(EngineCore_DP0 pid=357267)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=357267)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=357267)[0;0m     )
[0;36m(EngineCore_DP0 pid=357267)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=357267)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=357267)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357267)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=357267)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357267)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=357267)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=357267)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357267)[0;0m     )
[0;36m(EngineCore_DP0 pid=357267)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357267)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=357267)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=357267)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357267)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=357267)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357267)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=357267)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=357267)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357267)[0;0m     )
[0;36m(EngineCore_DP0 pid=357267)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357267)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=357267)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=357267)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357267)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=357267)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=357267)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357267)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=357267)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357267)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=357267)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=357267)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357267)[0;0m     ),
[0;36m(EngineCore_DP0 pid=357267)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357267)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=357267)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=357267)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=357330)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=357330)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=357330)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=357330)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=357330)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357330)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=357330)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=357330)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357330)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=357330)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=357330)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=357330)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=357330)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=357330)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=357330)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357330)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=357330)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357330)[0;0m     )
[0;36m(EngineCore_DP0 pid=357330)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357330)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=357330)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=357330)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357330)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=357330)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=357330)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357330)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=357330)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=357330)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357330)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=357330)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=357330)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357330)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=357330)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=357330)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357330)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=357330)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357330)[0;0m     )
[0;36m(EngineCore_DP0 pid=357330)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357330)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=357330)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=357330)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=357330)[0;0m     )
[0;36m(EngineCore_DP0 pid=357330)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=357330)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=357330)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=357330)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=357330)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357330)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=357330)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357330)[0;0m     )
[0;36m(EngineCore_DP0 pid=357330)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357330)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=357330)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=357330)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357330)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=357330)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=357330)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357330)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=357330)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357330)[0;0m     )
[0;36m(EngineCore_DP0 pid=357330)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357330)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=357330)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=357330)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357330)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=357330)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=357330)[0;0m         config,
[0;36m(EngineCore_DP0 pid=357330)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=357330)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=357330)[0;0m     )
[0;36m(EngineCore_DP0 pid=357330)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=357330)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=357330)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357330)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=357330)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357330)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=357330)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=357330)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357330)[0;0m     )
[0;36m(EngineCore_DP0 pid=357330)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357330)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=357330)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=357330)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357330)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=357330)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357330)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=357330)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=357330)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357330)[0;0m     )
[0;36m(EngineCore_DP0 pid=357330)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357330)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=357330)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=357330)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357330)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=357330)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=357330)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357330)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=357330)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357330)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=357330)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=357330)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357330)[0;0m     ),
[0;36m(EngineCore_DP0 pid=357330)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357330)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=357330)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=357330)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=357392)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=357392)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=357392)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=357392)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=357392)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357392)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=357392)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=357392)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357392)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=357392)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=357392)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=357392)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=357392)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=357392)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=357392)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357392)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=357392)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357392)[0;0m     )
[0;36m(EngineCore_DP0 pid=357392)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357392)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=357392)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=357392)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357392)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=357392)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=357392)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357392)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=357392)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=357392)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357392)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=357392)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=357392)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357392)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=357392)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=357392)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357392)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=357392)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357392)[0;0m     )
[0;36m(EngineCore_DP0 pid=357392)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357392)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=357392)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=357392)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=357392)[0;0m     )
[0;36m(EngineCore_DP0 pid=357392)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=357392)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=357392)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=357392)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=357392)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357392)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=357392)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357392)[0;0m     )
[0;36m(EngineCore_DP0 pid=357392)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357392)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=357392)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=357392)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357392)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=357392)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=357392)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357392)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=357392)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357392)[0;0m     )
[0;36m(EngineCore_DP0 pid=357392)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357392)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=357392)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=357392)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357392)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=357392)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=357392)[0;0m         config,
[0;36m(EngineCore_DP0 pid=357392)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=357392)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=357392)[0;0m     )
[0;36m(EngineCore_DP0 pid=357392)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=357392)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=357392)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357392)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=357392)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357392)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=357392)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=357392)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357392)[0;0m     )
[0;36m(EngineCore_DP0 pid=357392)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357392)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=357392)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=357392)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357392)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=357392)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357392)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=357392)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=357392)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357392)[0;0m     )
[0;36m(EngineCore_DP0 pid=357392)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357392)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=357392)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=357392)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357392)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=357392)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=357392)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357392)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=357392)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357392)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=357392)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=357392)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357392)[0;0m     ),
[0;36m(EngineCore_DP0 pid=357392)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357392)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=357392)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=357392)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=357454)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=357454)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=357454)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=357454)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=357454)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357454)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=357454)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=357454)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357454)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=357454)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=357454)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=357454)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=357454)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=357454)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=357454)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357454)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=357454)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357454)[0;0m     )
[0;36m(EngineCore_DP0 pid=357454)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357454)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=357454)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=357454)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357454)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=357454)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=357454)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357454)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=357454)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=357454)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357454)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=357454)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=357454)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357454)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=357454)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=357454)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357454)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=357454)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357454)[0;0m     )
[0;36m(EngineCore_DP0 pid=357454)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357454)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=357454)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=357454)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=357454)[0;0m     )
[0;36m(EngineCore_DP0 pid=357454)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=357454)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=357454)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=357454)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=357454)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357454)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=357454)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357454)[0;0m     )
[0;36m(EngineCore_DP0 pid=357454)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357454)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=357454)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=357454)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357454)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=357454)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=357454)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357454)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=357454)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357454)[0;0m     )
[0;36m(EngineCore_DP0 pid=357454)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357454)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=357454)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=357454)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357454)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=357454)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=357454)[0;0m         config,
[0;36m(EngineCore_DP0 pid=357454)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=357454)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=357454)[0;0m     )
[0;36m(EngineCore_DP0 pid=357454)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=357454)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=357454)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357454)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=357454)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357454)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=357454)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=357454)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357454)[0;0m     )
[0;36m(EngineCore_DP0 pid=357454)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357454)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=357454)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=357454)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357454)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=357454)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357454)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=357454)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=357454)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357454)[0;0m     )
[0;36m(EngineCore_DP0 pid=357454)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357454)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=357454)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=357454)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357454)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=357454)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=357454)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357454)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=357454)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357454)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=357454)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=357454)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357454)[0;0m     ),
[0;36m(EngineCore_DP0 pid=357454)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357454)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=357454)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=357454)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=357516)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=357516)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=357516)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=357516)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=357516)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357516)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=357516)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=357516)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357516)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=357516)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=357516)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=357516)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=357516)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=357516)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=357516)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357516)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=357516)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357516)[0;0m     )
[0;36m(EngineCore_DP0 pid=357516)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357516)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=357516)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=357516)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357516)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=357516)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=357516)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357516)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=357516)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=357516)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357516)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=357516)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=357516)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357516)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=357516)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=357516)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357516)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=357516)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357516)[0;0m     )
[0;36m(EngineCore_DP0 pid=357516)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357516)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=357516)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=357516)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=357516)[0;0m     )
[0;36m(EngineCore_DP0 pid=357516)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=357516)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=357516)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=357516)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=357516)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357516)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=357516)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357516)[0;0m     )
[0;36m(EngineCore_DP0 pid=357516)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357516)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=357516)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=357516)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357516)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=357516)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=357516)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357516)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=357516)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357516)[0;0m     )
[0;36m(EngineCore_DP0 pid=357516)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357516)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=357516)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=357516)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357516)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=357516)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=357516)[0;0m         config,
[0;36m(EngineCore_DP0 pid=357516)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=357516)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=357516)[0;0m     )
[0;36m(EngineCore_DP0 pid=357516)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=357516)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=357516)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357516)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=357516)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357516)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=357516)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=357516)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357516)[0;0m     )
[0;36m(EngineCore_DP0 pid=357516)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357516)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=357516)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=357516)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357516)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=357516)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357516)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=357516)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=357516)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357516)[0;0m     )
[0;36m(EngineCore_DP0 pid=357516)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357516)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=357516)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=357516)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357516)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=357516)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=357516)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357516)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=357516)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357516)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=357516)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=357516)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357516)[0;0m     ),
[0;36m(EngineCore_DP0 pid=357516)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357516)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=357516)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=357516)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=357578)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=357578)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=357578)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=357578)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=357578)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357578)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=357578)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=357578)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357578)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=357578)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=357578)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=357578)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=357578)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=357578)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=357578)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357578)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=357578)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357578)[0;0m     )
[0;36m(EngineCore_DP0 pid=357578)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357578)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=357578)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=357578)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357578)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=357578)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=357578)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357578)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=357578)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=357578)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357578)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=357578)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=357578)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357578)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=357578)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=357578)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357578)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=357578)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357578)[0;0m     )
[0;36m(EngineCore_DP0 pid=357578)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357578)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=357578)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=357578)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=357578)[0;0m     )
[0;36m(EngineCore_DP0 pid=357578)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=357578)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=357578)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=357578)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=357578)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357578)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=357578)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357578)[0;0m     )
[0;36m(EngineCore_DP0 pid=357578)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357578)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=357578)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=357578)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357578)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=357578)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=357578)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357578)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=357578)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357578)[0;0m     )
[0;36m(EngineCore_DP0 pid=357578)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357578)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=357578)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=357578)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357578)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=357578)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=357578)[0;0m         config,
[0;36m(EngineCore_DP0 pid=357578)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=357578)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=357578)[0;0m     )
[0;36m(EngineCore_DP0 pid=357578)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=357578)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=357578)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357578)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=357578)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357578)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=357578)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=357578)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357578)[0;0m     )
[0;36m(EngineCore_DP0 pid=357578)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357578)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=357578)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=357578)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357578)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=357578)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357578)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=357578)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=357578)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357578)[0;0m     )
[0;36m(EngineCore_DP0 pid=357578)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357578)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=357578)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=357578)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357578)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=357578)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=357578)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357578)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=357578)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357578)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=357578)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=357578)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357578)[0;0m     ),
[0;36m(EngineCore_DP0 pid=357578)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357578)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=357578)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=357578)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=357986)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=357986)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=357986)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=357986)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=357986)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357986)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=357986)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=357986)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357986)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=357986)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=357986)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=357986)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=357986)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=357986)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=357986)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357986)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=357986)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357986)[0;0m     )
[0;36m(EngineCore_DP0 pid=357986)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357986)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=357986)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=357986)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357986)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=357986)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=357986)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357986)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=357986)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=357986)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=357986)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=357986)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=357986)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357986)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=357986)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=357986)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357986)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=357986)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357986)[0;0m     )
[0;36m(EngineCore_DP0 pid=357986)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357986)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=357986)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=357986)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=357986)[0;0m     )
[0;36m(EngineCore_DP0 pid=357986)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=357986)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=357986)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=357986)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=357986)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357986)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=357986)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357986)[0;0m     )
[0;36m(EngineCore_DP0 pid=357986)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357986)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=357986)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=357986)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357986)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=357986)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=357986)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357986)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=357986)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357986)[0;0m     )
[0;36m(EngineCore_DP0 pid=357986)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357986)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=357986)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=357986)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357986)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=357986)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=357986)[0;0m         config,
[0;36m(EngineCore_DP0 pid=357986)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=357986)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=357986)[0;0m     )
[0;36m(EngineCore_DP0 pid=357986)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=357986)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=357986)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357986)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=357986)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357986)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=357986)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=357986)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357986)[0;0m     )
[0;36m(EngineCore_DP0 pid=357986)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357986)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=357986)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=357986)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357986)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=357986)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357986)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=357986)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=357986)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357986)[0;0m     )
[0;36m(EngineCore_DP0 pid=357986)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357986)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=357986)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=357986)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357986)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=357986)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=357986)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=357986)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=357986)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357986)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=357986)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=357986)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=357986)[0;0m     ),
[0;36m(EngineCore_DP0 pid=357986)[0;0m     ^
[0;36m(EngineCore_DP0 pid=357986)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=357986)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=357986)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=358048)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=358048)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=358048)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=358048)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=358048)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358048)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=358048)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=358048)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358048)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=358048)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=358048)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=358048)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=358048)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=358048)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=358048)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358048)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=358048)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358048)[0;0m     )
[0;36m(EngineCore_DP0 pid=358048)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358048)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=358048)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=358048)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358048)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=358048)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=358048)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358048)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=358048)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=358048)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358048)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=358048)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=358048)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358048)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=358048)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=358048)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358048)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=358048)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358048)[0;0m     )
[0;36m(EngineCore_DP0 pid=358048)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358048)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=358048)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=358048)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=358048)[0;0m     )
[0;36m(EngineCore_DP0 pid=358048)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=358048)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=358048)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=358048)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=358048)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358048)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=358048)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358048)[0;0m     )
[0;36m(EngineCore_DP0 pid=358048)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358048)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=358048)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=358048)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358048)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=358048)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=358048)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358048)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=358048)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358048)[0;0m     )
[0;36m(EngineCore_DP0 pid=358048)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358048)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=358048)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=358048)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358048)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=358048)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=358048)[0;0m         config,
[0;36m(EngineCore_DP0 pid=358048)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=358048)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=358048)[0;0m     )
[0;36m(EngineCore_DP0 pid=358048)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=358048)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=358048)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358048)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=358048)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358048)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=358048)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=358048)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358048)[0;0m     )
[0;36m(EngineCore_DP0 pid=358048)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358048)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=358048)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=358048)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358048)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=358048)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358048)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=358048)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=358048)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358048)[0;0m     )
[0;36m(EngineCore_DP0 pid=358048)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358048)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=358048)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=358048)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358048)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=358048)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=358048)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358048)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=358048)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358048)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=358048)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=358048)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358048)[0;0m     ),
[0;36m(EngineCore_DP0 pid=358048)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358048)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=358048)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=358048)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=358110)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=358110)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=358110)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=358110)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=358110)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358110)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=358110)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=358110)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358110)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=358110)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=358110)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=358110)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=358110)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=358110)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=358110)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358110)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=358110)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358110)[0;0m     )
[0;36m(EngineCore_DP0 pid=358110)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358110)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=358110)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=358110)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358110)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=358110)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=358110)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358110)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=358110)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=358110)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358110)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=358110)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=358110)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358110)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=358110)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=358110)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358110)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=358110)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358110)[0;0m     )
[0;36m(EngineCore_DP0 pid=358110)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358110)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=358110)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=358110)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=358110)[0;0m     )
[0;36m(EngineCore_DP0 pid=358110)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=358110)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=358110)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=358110)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=358110)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358110)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=358110)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358110)[0;0m     )
[0;36m(EngineCore_DP0 pid=358110)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358110)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=358110)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=358110)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358110)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=358110)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=358110)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358110)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=358110)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358110)[0;0m     )
[0;36m(EngineCore_DP0 pid=358110)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358110)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=358110)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=358110)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358110)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=358110)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=358110)[0;0m         config,
[0;36m(EngineCore_DP0 pid=358110)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=358110)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=358110)[0;0m     )
[0;36m(EngineCore_DP0 pid=358110)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=358110)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=358110)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358110)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=358110)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358110)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=358110)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=358110)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358110)[0;0m     )
[0;36m(EngineCore_DP0 pid=358110)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358110)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=358110)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=358110)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358110)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=358110)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358110)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=358110)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=358110)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358110)[0;0m     )
[0;36m(EngineCore_DP0 pid=358110)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358110)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=358110)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=358110)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358110)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=358110)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=358110)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358110)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=358110)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358110)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=358110)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=358110)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358110)[0;0m     ),
[0;36m(EngineCore_DP0 pid=358110)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358110)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=358110)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=358110)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=358172)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=358172)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=358172)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=358172)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=358172)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358172)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=358172)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=358172)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358172)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=358172)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=358172)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=358172)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=358172)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=358172)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=358172)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358172)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=358172)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358172)[0;0m     )
[0;36m(EngineCore_DP0 pid=358172)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358172)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=358172)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=358172)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358172)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=358172)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=358172)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358172)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=358172)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=358172)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358172)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=358172)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=358172)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358172)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=358172)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=358172)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358172)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=358172)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358172)[0;0m     )
[0;36m(EngineCore_DP0 pid=358172)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358172)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=358172)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=358172)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=358172)[0;0m     )
[0;36m(EngineCore_DP0 pid=358172)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=358172)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=358172)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=358172)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=358172)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358172)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=358172)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358172)[0;0m     )
[0;36m(EngineCore_DP0 pid=358172)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358172)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=358172)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=358172)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358172)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=358172)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=358172)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358172)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=358172)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358172)[0;0m     )
[0;36m(EngineCore_DP0 pid=358172)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358172)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=358172)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=358172)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358172)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=358172)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=358172)[0;0m         config,
[0;36m(EngineCore_DP0 pid=358172)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=358172)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=358172)[0;0m     )
[0;36m(EngineCore_DP0 pid=358172)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=358172)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=358172)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358172)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=358172)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358172)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=358172)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=358172)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358172)[0;0m     )
[0;36m(EngineCore_DP0 pid=358172)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358172)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=358172)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=358172)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358172)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=358172)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358172)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=358172)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=358172)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358172)[0;0m     )
[0;36m(EngineCore_DP0 pid=358172)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358172)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=358172)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=358172)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358172)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=358172)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=358172)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358172)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=358172)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358172)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=358172)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=358172)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358172)[0;0m     ),
[0;36m(EngineCore_DP0 pid=358172)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358172)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=358172)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=358172)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=358234)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=358234)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=358234)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=358234)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=358234)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358234)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=358234)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=358234)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358234)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=358234)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=358234)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=358234)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=358234)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=358234)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=358234)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358234)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=358234)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358234)[0;0m     )
[0;36m(EngineCore_DP0 pid=358234)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358234)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=358234)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=358234)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358234)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=358234)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=358234)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358234)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=358234)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=358234)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358234)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=358234)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=358234)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358234)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=358234)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=358234)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358234)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=358234)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358234)[0;0m     )
[0;36m(EngineCore_DP0 pid=358234)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358234)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=358234)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=358234)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=358234)[0;0m     )
[0;36m(EngineCore_DP0 pid=358234)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=358234)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=358234)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=358234)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=358234)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358234)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=358234)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358234)[0;0m     )
[0;36m(EngineCore_DP0 pid=358234)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358234)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=358234)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=358234)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358234)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=358234)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=358234)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358234)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=358234)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358234)[0;0m     )
[0;36m(EngineCore_DP0 pid=358234)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358234)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=358234)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=358234)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358234)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=358234)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=358234)[0;0m         config,
[0;36m(EngineCore_DP0 pid=358234)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=358234)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=358234)[0;0m     )
[0;36m(EngineCore_DP0 pid=358234)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=358234)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=358234)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358234)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=358234)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358234)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=358234)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=358234)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358234)[0;0m     )
[0;36m(EngineCore_DP0 pid=358234)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358234)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=358234)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=358234)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358234)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=358234)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358234)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=358234)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=358234)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358234)[0;0m     )
[0;36m(EngineCore_DP0 pid=358234)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358234)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=358234)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=358234)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358234)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=358234)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=358234)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358234)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=358234)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358234)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=358234)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=358234)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358234)[0;0m     ),
[0;36m(EngineCore_DP0 pid=358234)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358234)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=358234)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=358234)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=358296)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=358296)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=358296)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=358296)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=358296)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358296)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=358296)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=358296)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358296)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=358296)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=358296)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=358296)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=358296)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=358296)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=358296)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358296)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=358296)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358296)[0;0m     )
[0;36m(EngineCore_DP0 pid=358296)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358296)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=358296)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=358296)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358296)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=358296)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=358296)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358296)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=358296)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=358296)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358296)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=358296)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=358296)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358296)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=358296)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=358296)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358296)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=358296)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358296)[0;0m     )
[0;36m(EngineCore_DP0 pid=358296)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358296)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=358296)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=358296)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=358296)[0;0m     )
[0;36m(EngineCore_DP0 pid=358296)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=358296)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=358296)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=358296)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=358296)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358296)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=358296)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358296)[0;0m     )
[0;36m(EngineCore_DP0 pid=358296)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358296)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=358296)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=358296)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358296)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=358296)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=358296)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358296)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=358296)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358296)[0;0m     )
[0;36m(EngineCore_DP0 pid=358296)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358296)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=358296)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=358296)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358296)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=358296)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=358296)[0;0m         config,
[0;36m(EngineCore_DP0 pid=358296)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=358296)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=358296)[0;0m     )
[0;36m(EngineCore_DP0 pid=358296)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=358296)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=358296)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358296)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=358296)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358296)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=358296)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=358296)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358296)[0;0m     )
[0;36m(EngineCore_DP0 pid=358296)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358296)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=358296)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=358296)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358296)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=358296)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358296)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=358296)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=358296)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358296)[0;0m     )
[0;36m(EngineCore_DP0 pid=358296)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358296)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=358296)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=358296)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358296)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=358296)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=358296)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358296)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=358296)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358296)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=358296)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=358296)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358296)[0;0m     ),
[0;36m(EngineCore_DP0 pid=358296)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358296)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=358296)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=358296)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=358358)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=358358)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=358358)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=358358)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=358358)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358358)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=358358)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=358358)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=358358)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=358358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=358358)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=358358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=358358)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=358358)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358358)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=358358)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358358)[0;0m     )
[0;36m(EngineCore_DP0 pid=358358)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=358358)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=358358)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=358358)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=358358)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=358358)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=358358)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=358358)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=358358)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=358358)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=358358)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358358)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=358358)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358358)[0;0m     )
[0;36m(EngineCore_DP0 pid=358358)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=358358)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=358358)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=358358)[0;0m     )
[0;36m(EngineCore_DP0 pid=358358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=358358)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=358358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=358358)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=358358)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358358)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=358358)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358358)[0;0m     )
[0;36m(EngineCore_DP0 pid=358358)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=358358)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=358358)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=358358)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=358358)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358358)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=358358)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358358)[0;0m     )
[0;36m(EngineCore_DP0 pid=358358)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=358358)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=358358)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=358358)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=358358)[0;0m         config,
[0;36m(EngineCore_DP0 pid=358358)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=358358)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=358358)[0;0m     )
[0;36m(EngineCore_DP0 pid=358358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=358358)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=358358)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358358)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=358358)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358358)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=358358)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=358358)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358358)[0;0m     )
[0;36m(EngineCore_DP0 pid=358358)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=358358)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=358358)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358358)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=358358)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358358)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=358358)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=358358)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358358)[0;0m     )
[0;36m(EngineCore_DP0 pid=358358)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=358358)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=358358)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=358358)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=358358)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358358)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=358358)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358358)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=358358)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=358358)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358358)[0;0m     ),
[0;36m(EngineCore_DP0 pid=358358)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=358358)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=358358)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=358420)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=358420)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=358420)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=358420)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=358420)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358420)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=358420)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=358420)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358420)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=358420)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=358420)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=358420)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=358420)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=358420)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=358420)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358420)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=358420)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358420)[0;0m     )
[0;36m(EngineCore_DP0 pid=358420)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358420)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=358420)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=358420)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358420)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=358420)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=358420)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358420)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=358420)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=358420)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358420)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=358420)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=358420)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358420)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=358420)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=358420)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358420)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=358420)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358420)[0;0m     )
[0;36m(EngineCore_DP0 pid=358420)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358420)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=358420)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=358420)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=358420)[0;0m     )
[0;36m(EngineCore_DP0 pid=358420)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=358420)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=358420)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=358420)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=358420)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358420)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=358420)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358420)[0;0m     )
[0;36m(EngineCore_DP0 pid=358420)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358420)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=358420)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=358420)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358420)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=358420)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=358420)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358420)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=358420)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358420)[0;0m     )
[0;36m(EngineCore_DP0 pid=358420)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358420)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=358420)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=358420)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358420)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=358420)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=358420)[0;0m         config,
[0;36m(EngineCore_DP0 pid=358420)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=358420)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=358420)[0;0m     )
[0;36m(EngineCore_DP0 pid=358420)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=358420)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=358420)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358420)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=358420)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358420)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=358420)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=358420)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358420)[0;0m     )
[0;36m(EngineCore_DP0 pid=358420)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358420)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=358420)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=358420)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358420)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=358420)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358420)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=358420)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=358420)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358420)[0;0m     )
[0;36m(EngineCore_DP0 pid=358420)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358420)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=358420)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=358420)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358420)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=358420)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=358420)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358420)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=358420)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358420)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=358420)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=358420)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358420)[0;0m     ),
[0;36m(EngineCore_DP0 pid=358420)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358420)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=358420)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=358420)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=358482)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=358482)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=358482)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=358482)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=358482)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358482)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=358482)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=358482)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358482)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=358482)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=358482)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=358482)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=358482)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=358482)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=358482)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358482)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=358482)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358482)[0;0m     )
[0;36m(EngineCore_DP0 pid=358482)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358482)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=358482)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=358482)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358482)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=358482)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=358482)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358482)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=358482)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=358482)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358482)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=358482)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=358482)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358482)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=358482)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=358482)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358482)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=358482)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358482)[0;0m     )
[0;36m(EngineCore_DP0 pid=358482)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358482)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=358482)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=358482)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=358482)[0;0m     )
[0;36m(EngineCore_DP0 pid=358482)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=358482)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=358482)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=358482)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=358482)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358482)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=358482)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358482)[0;0m     )
[0;36m(EngineCore_DP0 pid=358482)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358482)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=358482)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=358482)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358482)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=358482)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=358482)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358482)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=358482)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358482)[0;0m     )
[0;36m(EngineCore_DP0 pid=358482)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358482)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=358482)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=358482)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358482)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=358482)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=358482)[0;0m         config,
[0;36m(EngineCore_DP0 pid=358482)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=358482)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=358482)[0;0m     )
[0;36m(EngineCore_DP0 pid=358482)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=358482)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=358482)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358482)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=358482)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358482)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=358482)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=358482)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358482)[0;0m     )
[0;36m(EngineCore_DP0 pid=358482)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358482)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=358482)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=358482)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358482)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=358482)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358482)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=358482)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=358482)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358482)[0;0m     )
[0;36m(EngineCore_DP0 pid=358482)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358482)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=358482)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=358482)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358482)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=358482)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=358482)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358482)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=358482)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358482)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=358482)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=358482)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358482)[0;0m     ),
[0;36m(EngineCore_DP0 pid=358482)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358482)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=358482)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=358482)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=358887)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=358887)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=358887)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=358887)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=358887)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358887)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=358887)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=358887)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358887)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=358887)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=358887)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=358887)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=358887)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=358887)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=358887)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358887)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=358887)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358887)[0;0m     )
[0;36m(EngineCore_DP0 pid=358887)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358887)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=358887)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=358887)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358887)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=358887)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=358887)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358887)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=358887)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=358887)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358887)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=358887)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=358887)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358887)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=358887)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=358887)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358887)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=358887)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358887)[0;0m     )
[0;36m(EngineCore_DP0 pid=358887)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358887)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=358887)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=358887)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=358887)[0;0m     )
[0;36m(EngineCore_DP0 pid=358887)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=358887)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=358887)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=358887)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=358887)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358887)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=358887)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358887)[0;0m     )
[0;36m(EngineCore_DP0 pid=358887)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358887)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=358887)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=358887)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358887)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=358887)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=358887)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358887)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=358887)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358887)[0;0m     )
[0;36m(EngineCore_DP0 pid=358887)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358887)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=358887)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=358887)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358887)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=358887)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=358887)[0;0m         config,
[0;36m(EngineCore_DP0 pid=358887)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=358887)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=358887)[0;0m     )
[0;36m(EngineCore_DP0 pid=358887)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=358887)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=358887)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358887)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=358887)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358887)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=358887)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=358887)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358887)[0;0m     )
[0;36m(EngineCore_DP0 pid=358887)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358887)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=358887)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=358887)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358887)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=358887)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358887)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=358887)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=358887)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358887)[0;0m     )
[0;36m(EngineCore_DP0 pid=358887)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358887)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=358887)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=358887)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358887)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=358887)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=358887)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358887)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=358887)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358887)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=358887)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=358887)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358887)[0;0m     ),
[0;36m(EngineCore_DP0 pid=358887)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358887)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=358887)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=358887)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=358949)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=358949)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=358949)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=358949)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=358949)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358949)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=358949)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=358949)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358949)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=358949)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=358949)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=358949)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=358949)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=358949)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=358949)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358949)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=358949)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358949)[0;0m     )
[0;36m(EngineCore_DP0 pid=358949)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358949)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=358949)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=358949)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358949)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=358949)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=358949)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358949)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=358949)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=358949)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=358949)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=358949)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=358949)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358949)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=358949)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=358949)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358949)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=358949)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358949)[0;0m     )
[0;36m(EngineCore_DP0 pid=358949)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358949)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=358949)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=358949)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=358949)[0;0m     )
[0;36m(EngineCore_DP0 pid=358949)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=358949)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=358949)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=358949)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=358949)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358949)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=358949)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358949)[0;0m     )
[0;36m(EngineCore_DP0 pid=358949)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358949)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=358949)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=358949)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358949)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=358949)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=358949)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358949)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=358949)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358949)[0;0m     )
[0;36m(EngineCore_DP0 pid=358949)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358949)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=358949)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=358949)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358949)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=358949)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=358949)[0;0m         config,
[0;36m(EngineCore_DP0 pid=358949)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=358949)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=358949)[0;0m     )
[0;36m(EngineCore_DP0 pid=358949)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=358949)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=358949)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358949)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=358949)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358949)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=358949)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=358949)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358949)[0;0m     )
[0;36m(EngineCore_DP0 pid=358949)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358949)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=358949)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=358949)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358949)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=358949)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358949)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=358949)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=358949)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358949)[0;0m     )
[0;36m(EngineCore_DP0 pid=358949)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358949)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=358949)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=358949)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358949)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=358949)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=358949)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=358949)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=358949)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358949)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=358949)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=358949)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=358949)[0;0m     ),
[0;36m(EngineCore_DP0 pid=358949)[0;0m     ^
[0;36m(EngineCore_DP0 pid=358949)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=358949)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=358949)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=359011)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=359011)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=359011)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=359011)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=359011)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359011)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=359011)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=359011)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359011)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=359011)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=359011)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=359011)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=359011)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=359011)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=359011)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359011)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=359011)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359011)[0;0m     )
[0;36m(EngineCore_DP0 pid=359011)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359011)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=359011)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=359011)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359011)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=359011)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=359011)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359011)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=359011)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=359011)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359011)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=359011)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=359011)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359011)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=359011)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=359011)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359011)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=359011)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359011)[0;0m     )
[0;36m(EngineCore_DP0 pid=359011)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359011)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=359011)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=359011)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=359011)[0;0m     )
[0;36m(EngineCore_DP0 pid=359011)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=359011)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=359011)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=359011)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=359011)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359011)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=359011)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359011)[0;0m     )
[0;36m(EngineCore_DP0 pid=359011)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359011)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=359011)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=359011)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359011)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=359011)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=359011)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359011)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=359011)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359011)[0;0m     )
[0;36m(EngineCore_DP0 pid=359011)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359011)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=359011)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=359011)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359011)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=359011)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=359011)[0;0m         config,
[0;36m(EngineCore_DP0 pid=359011)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=359011)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=359011)[0;0m     )
[0;36m(EngineCore_DP0 pid=359011)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=359011)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=359011)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359011)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=359011)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359011)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=359011)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=359011)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359011)[0;0m     )
[0;36m(EngineCore_DP0 pid=359011)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359011)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=359011)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=359011)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359011)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=359011)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359011)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=359011)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=359011)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359011)[0;0m     )
[0;36m(EngineCore_DP0 pid=359011)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359011)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=359011)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=359011)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359011)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=359011)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=359011)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359011)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=359011)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359011)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=359011)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=359011)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359011)[0;0m     ),
[0;36m(EngineCore_DP0 pid=359011)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359011)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=359011)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=359011)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=359073)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=359073)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=359073)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=359073)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=359073)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359073)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=359073)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=359073)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359073)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=359073)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=359073)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=359073)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=359073)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=359073)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=359073)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359073)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=359073)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359073)[0;0m     )
[0;36m(EngineCore_DP0 pid=359073)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359073)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=359073)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=359073)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359073)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=359073)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=359073)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359073)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=359073)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=359073)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359073)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=359073)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=359073)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359073)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=359073)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=359073)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359073)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=359073)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359073)[0;0m     )
[0;36m(EngineCore_DP0 pid=359073)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359073)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=359073)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=359073)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=359073)[0;0m     )
[0;36m(EngineCore_DP0 pid=359073)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=359073)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=359073)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=359073)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=359073)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359073)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=359073)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359073)[0;0m     )
[0;36m(EngineCore_DP0 pid=359073)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359073)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=359073)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=359073)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359073)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=359073)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=359073)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359073)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=359073)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359073)[0;0m     )
[0;36m(EngineCore_DP0 pid=359073)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359073)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=359073)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=359073)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359073)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=359073)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=359073)[0;0m         config,
[0;36m(EngineCore_DP0 pid=359073)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=359073)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=359073)[0;0m     )
[0;36m(EngineCore_DP0 pid=359073)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=359073)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=359073)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359073)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=359073)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359073)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=359073)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=359073)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359073)[0;0m     )
[0;36m(EngineCore_DP0 pid=359073)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359073)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=359073)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=359073)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359073)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=359073)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359073)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=359073)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=359073)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359073)[0;0m     )
[0;36m(EngineCore_DP0 pid=359073)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359073)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=359073)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=359073)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359073)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=359073)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=359073)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359073)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=359073)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359073)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=359073)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=359073)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359073)[0;0m     ),
[0;36m(EngineCore_DP0 pid=359073)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359073)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=359073)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=359073)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=359135)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=359135)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=359135)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=359135)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=359135)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359135)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=359135)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=359135)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359135)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=359135)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=359135)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=359135)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=359135)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=359135)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=359135)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359135)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=359135)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359135)[0;0m     )
[0;36m(EngineCore_DP0 pid=359135)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359135)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=359135)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=359135)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359135)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=359135)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=359135)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359135)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=359135)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=359135)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359135)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=359135)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=359135)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359135)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=359135)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=359135)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359135)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=359135)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359135)[0;0m     )
[0;36m(EngineCore_DP0 pid=359135)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359135)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=359135)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=359135)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=359135)[0;0m     )
[0;36m(EngineCore_DP0 pid=359135)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=359135)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=359135)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=359135)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=359135)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359135)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=359135)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359135)[0;0m     )
[0;36m(EngineCore_DP0 pid=359135)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359135)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=359135)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=359135)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359135)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=359135)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=359135)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359135)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=359135)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359135)[0;0m     )
[0;36m(EngineCore_DP0 pid=359135)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359135)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=359135)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=359135)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359135)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=359135)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=359135)[0;0m         config,
[0;36m(EngineCore_DP0 pid=359135)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=359135)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=359135)[0;0m     )
[0;36m(EngineCore_DP0 pid=359135)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=359135)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=359135)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359135)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=359135)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359135)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=359135)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=359135)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359135)[0;0m     )
[0;36m(EngineCore_DP0 pid=359135)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359135)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=359135)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=359135)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359135)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=359135)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359135)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=359135)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=359135)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359135)[0;0m     )
[0;36m(EngineCore_DP0 pid=359135)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359135)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=359135)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=359135)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359135)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=359135)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=359135)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359135)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=359135)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359135)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=359135)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=359135)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359135)[0;0m     ),
[0;36m(EngineCore_DP0 pid=359135)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359135)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=359135)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=359135)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=359197)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=359197)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=359197)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=359197)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=359197)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359197)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=359197)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=359197)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359197)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=359197)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=359197)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=359197)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=359197)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=359197)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=359197)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359197)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=359197)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359197)[0;0m     )
[0;36m(EngineCore_DP0 pid=359197)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359197)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=359197)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=359197)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359197)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=359197)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=359197)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359197)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=359197)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=359197)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359197)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=359197)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=359197)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359197)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=359197)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=359197)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359197)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=359197)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359197)[0;0m     )
[0;36m(EngineCore_DP0 pid=359197)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359197)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=359197)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=359197)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=359197)[0;0m     )
[0;36m(EngineCore_DP0 pid=359197)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=359197)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=359197)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=359197)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=359197)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359197)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=359197)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359197)[0;0m     )
[0;36m(EngineCore_DP0 pid=359197)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359197)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=359197)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=359197)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359197)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=359197)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=359197)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359197)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=359197)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359197)[0;0m     )
[0;36m(EngineCore_DP0 pid=359197)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359197)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=359197)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=359197)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359197)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=359197)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=359197)[0;0m         config,
[0;36m(EngineCore_DP0 pid=359197)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=359197)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=359197)[0;0m     )
[0;36m(EngineCore_DP0 pid=359197)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=359197)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=359197)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359197)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=359197)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359197)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=359197)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=359197)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359197)[0;0m     )
[0;36m(EngineCore_DP0 pid=359197)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359197)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=359197)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=359197)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359197)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=359197)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359197)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=359197)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=359197)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359197)[0;0m     )
[0;36m(EngineCore_DP0 pid=359197)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359197)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=359197)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=359197)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359197)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=359197)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=359197)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359197)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=359197)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359197)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=359197)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=359197)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359197)[0;0m     ),
[0;36m(EngineCore_DP0 pid=359197)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359197)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=359197)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=359197)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=359259)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=359259)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=359259)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=359259)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=359259)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359259)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=359259)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=359259)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359259)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=359259)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=359259)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=359259)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=359259)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=359259)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=359259)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359259)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=359259)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359259)[0;0m     )
[0;36m(EngineCore_DP0 pid=359259)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359259)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=359259)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=359259)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359259)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=359259)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=359259)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359259)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=359259)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=359259)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359259)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=359259)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=359259)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359259)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=359259)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=359259)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359259)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=359259)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359259)[0;0m     )
[0;36m(EngineCore_DP0 pid=359259)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359259)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=359259)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=359259)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=359259)[0;0m     )
[0;36m(EngineCore_DP0 pid=359259)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=359259)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=359259)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=359259)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=359259)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359259)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=359259)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359259)[0;0m     )
[0;36m(EngineCore_DP0 pid=359259)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359259)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=359259)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=359259)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359259)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=359259)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=359259)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359259)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=359259)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359259)[0;0m     )
[0;36m(EngineCore_DP0 pid=359259)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359259)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=359259)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=359259)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359259)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=359259)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=359259)[0;0m         config,
[0;36m(EngineCore_DP0 pid=359259)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=359259)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=359259)[0;0m     )
[0;36m(EngineCore_DP0 pid=359259)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=359259)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=359259)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359259)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=359259)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359259)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=359259)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=359259)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359259)[0;0m     )
[0;36m(EngineCore_DP0 pid=359259)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359259)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=359259)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=359259)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359259)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=359259)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359259)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=359259)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=359259)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359259)[0;0m     )
[0;36m(EngineCore_DP0 pid=359259)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359259)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=359259)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=359259)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359259)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=359259)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=359259)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359259)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=359259)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359259)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=359259)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=359259)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359259)[0;0m     ),
[0;36m(EngineCore_DP0 pid=359259)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359259)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=359259)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=359259)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=359321)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=359321)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=359321)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=359321)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=359321)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359321)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=359321)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=359321)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359321)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=359321)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=359321)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=359321)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=359321)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=359321)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=359321)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359321)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=359321)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359321)[0;0m     )
[0;36m(EngineCore_DP0 pid=359321)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359321)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=359321)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=359321)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359321)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=359321)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=359321)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359321)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=359321)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=359321)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359321)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=359321)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=359321)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359321)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=359321)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=359321)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359321)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=359321)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359321)[0;0m     )
[0;36m(EngineCore_DP0 pid=359321)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359321)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=359321)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=359321)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=359321)[0;0m     )
[0;36m(EngineCore_DP0 pid=359321)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=359321)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=359321)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=359321)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=359321)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359321)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=359321)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359321)[0;0m     )
[0;36m(EngineCore_DP0 pid=359321)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359321)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=359321)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=359321)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359321)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=359321)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=359321)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359321)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=359321)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359321)[0;0m     )
[0;36m(EngineCore_DP0 pid=359321)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359321)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=359321)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=359321)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359321)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=359321)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=359321)[0;0m         config,
[0;36m(EngineCore_DP0 pid=359321)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=359321)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=359321)[0;0m     )
[0;36m(EngineCore_DP0 pid=359321)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=359321)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=359321)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359321)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=359321)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359321)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=359321)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=359321)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359321)[0;0m     )
[0;36m(EngineCore_DP0 pid=359321)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359321)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=359321)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=359321)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359321)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=359321)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359321)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=359321)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=359321)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359321)[0;0m     )
[0;36m(EngineCore_DP0 pid=359321)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359321)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=359321)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=359321)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359321)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=359321)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=359321)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359321)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=359321)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359321)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=359321)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=359321)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359321)[0;0m     ),
[0;36m(EngineCore_DP0 pid=359321)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359321)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=359321)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=359321)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=359383)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=359383)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=359383)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=359383)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=359383)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359383)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=359383)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=359383)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359383)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=359383)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=359383)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=359383)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=359383)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=359383)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=359383)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359383)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=359383)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359383)[0;0m     )
[0;36m(EngineCore_DP0 pid=359383)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359383)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=359383)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=359383)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359383)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=359383)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=359383)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359383)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=359383)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=359383)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359383)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=359383)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=359383)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359383)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=359383)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=359383)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359383)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=359383)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359383)[0;0m     )
[0;36m(EngineCore_DP0 pid=359383)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359383)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=359383)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=359383)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=359383)[0;0m     )
[0;36m(EngineCore_DP0 pid=359383)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=359383)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=359383)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=359383)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=359383)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359383)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=359383)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359383)[0;0m     )
[0;36m(EngineCore_DP0 pid=359383)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359383)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=359383)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=359383)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359383)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=359383)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=359383)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359383)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=359383)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359383)[0;0m     )
[0;36m(EngineCore_DP0 pid=359383)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359383)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=359383)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=359383)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359383)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=359383)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=359383)[0;0m         config,
[0;36m(EngineCore_DP0 pid=359383)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=359383)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=359383)[0;0m     )
[0;36m(EngineCore_DP0 pid=359383)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=359383)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=359383)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359383)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=359383)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359383)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=359383)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=359383)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359383)[0;0m     )
[0;36m(EngineCore_DP0 pid=359383)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359383)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=359383)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=359383)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359383)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=359383)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359383)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=359383)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=359383)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359383)[0;0m     )
[0;36m(EngineCore_DP0 pid=359383)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359383)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=359383)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=359383)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359383)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=359383)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=359383)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359383)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=359383)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359383)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=359383)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=359383)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359383)[0;0m     ),
[0;36m(EngineCore_DP0 pid=359383)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359383)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=359383)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=359383)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=359445)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=359445)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=359445)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=359445)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=359445)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359445)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=359445)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=359445)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359445)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=359445)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=359445)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=359445)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=359445)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=359445)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=359445)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359445)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=359445)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359445)[0;0m     )
[0;36m(EngineCore_DP0 pid=359445)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359445)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=359445)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=359445)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359445)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=359445)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=359445)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359445)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=359445)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=359445)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359445)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=359445)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=359445)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359445)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=359445)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=359445)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359445)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=359445)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359445)[0;0m     )
[0;36m(EngineCore_DP0 pid=359445)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359445)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=359445)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=359445)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=359445)[0;0m     )
[0;36m(EngineCore_DP0 pid=359445)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=359445)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=359445)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=359445)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=359445)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359445)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=359445)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359445)[0;0m     )
[0;36m(EngineCore_DP0 pid=359445)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359445)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=359445)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=359445)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359445)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=359445)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=359445)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359445)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=359445)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359445)[0;0m     )
[0;36m(EngineCore_DP0 pid=359445)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359445)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=359445)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=359445)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359445)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=359445)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=359445)[0;0m         config,
[0;36m(EngineCore_DP0 pid=359445)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=359445)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=359445)[0;0m     )
[0;36m(EngineCore_DP0 pid=359445)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=359445)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=359445)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359445)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=359445)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359445)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=359445)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=359445)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359445)[0;0m     )
[0;36m(EngineCore_DP0 pid=359445)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359445)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=359445)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=359445)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359445)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=359445)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359445)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=359445)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=359445)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359445)[0;0m     )
[0;36m(EngineCore_DP0 pid=359445)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359445)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=359445)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=359445)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359445)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=359445)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=359445)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359445)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=359445)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359445)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=359445)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=359445)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359445)[0;0m     ),
[0;36m(EngineCore_DP0 pid=359445)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359445)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=359445)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=359445)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=359850)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=359850)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=359850)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=359850)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=359850)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359850)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=359850)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=359850)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359850)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=359850)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=359850)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=359850)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=359850)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=359850)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=359850)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359850)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=359850)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359850)[0;0m     )
[0;36m(EngineCore_DP0 pid=359850)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359850)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=359850)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=359850)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359850)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=359850)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=359850)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359850)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=359850)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=359850)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359850)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=359850)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=359850)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359850)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=359850)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=359850)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359850)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=359850)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359850)[0;0m     )
[0;36m(EngineCore_DP0 pid=359850)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359850)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=359850)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=359850)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=359850)[0;0m     )
[0;36m(EngineCore_DP0 pid=359850)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=359850)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=359850)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=359850)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=359850)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359850)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=359850)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359850)[0;0m     )
[0;36m(EngineCore_DP0 pid=359850)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359850)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=359850)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=359850)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359850)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=359850)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=359850)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359850)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=359850)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359850)[0;0m     )
[0;36m(EngineCore_DP0 pid=359850)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359850)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=359850)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=359850)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359850)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=359850)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=359850)[0;0m         config,
[0;36m(EngineCore_DP0 pid=359850)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=359850)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=359850)[0;0m     )
[0;36m(EngineCore_DP0 pid=359850)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=359850)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=359850)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359850)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=359850)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359850)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=359850)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=359850)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359850)[0;0m     )
[0;36m(EngineCore_DP0 pid=359850)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359850)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=359850)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=359850)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359850)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=359850)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359850)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=359850)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=359850)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359850)[0;0m     )
[0;36m(EngineCore_DP0 pid=359850)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359850)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=359850)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=359850)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359850)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=359850)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=359850)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359850)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=359850)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359850)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=359850)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=359850)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359850)[0;0m     ),
[0;36m(EngineCore_DP0 pid=359850)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359850)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=359850)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=359850)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=359912)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=359912)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=359912)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=359912)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=359912)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359912)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=359912)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=359912)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359912)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=359912)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=359912)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=359912)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=359912)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=359912)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=359912)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359912)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=359912)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359912)[0;0m     )
[0;36m(EngineCore_DP0 pid=359912)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359912)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=359912)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=359912)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359912)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=359912)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=359912)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359912)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=359912)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=359912)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359912)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=359912)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=359912)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359912)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=359912)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=359912)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359912)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=359912)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359912)[0;0m     )
[0;36m(EngineCore_DP0 pid=359912)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359912)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=359912)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=359912)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=359912)[0;0m     )
[0;36m(EngineCore_DP0 pid=359912)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=359912)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=359912)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=359912)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=359912)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359912)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=359912)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359912)[0;0m     )
[0;36m(EngineCore_DP0 pid=359912)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359912)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=359912)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=359912)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359912)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=359912)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=359912)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359912)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=359912)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359912)[0;0m     )
[0;36m(EngineCore_DP0 pid=359912)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359912)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=359912)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=359912)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359912)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=359912)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=359912)[0;0m         config,
[0;36m(EngineCore_DP0 pid=359912)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=359912)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=359912)[0;0m     )
[0;36m(EngineCore_DP0 pid=359912)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=359912)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=359912)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359912)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=359912)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359912)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=359912)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=359912)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359912)[0;0m     )
[0;36m(EngineCore_DP0 pid=359912)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359912)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=359912)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=359912)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359912)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=359912)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359912)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=359912)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=359912)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359912)[0;0m     )
[0;36m(EngineCore_DP0 pid=359912)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359912)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=359912)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=359912)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359912)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=359912)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=359912)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359912)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=359912)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359912)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=359912)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=359912)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359912)[0;0m     ),
[0;36m(EngineCore_DP0 pid=359912)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359912)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=359912)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=359912)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=359974)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=359974)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=359974)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=359974)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=359974)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359974)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=359974)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=359974)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359974)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=359974)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=359974)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=359974)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=359974)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=359974)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=359974)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359974)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=359974)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359974)[0;0m     )
[0;36m(EngineCore_DP0 pid=359974)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359974)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=359974)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=359974)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359974)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=359974)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=359974)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359974)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=359974)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=359974)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=359974)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=359974)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=359974)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359974)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=359974)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=359974)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359974)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=359974)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359974)[0;0m     )
[0;36m(EngineCore_DP0 pid=359974)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359974)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=359974)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=359974)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=359974)[0;0m     )
[0;36m(EngineCore_DP0 pid=359974)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=359974)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=359974)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=359974)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=359974)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359974)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=359974)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359974)[0;0m     )
[0;36m(EngineCore_DP0 pid=359974)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359974)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=359974)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=359974)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359974)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=359974)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=359974)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359974)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=359974)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359974)[0;0m     )
[0;36m(EngineCore_DP0 pid=359974)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359974)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=359974)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=359974)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359974)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=359974)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=359974)[0;0m         config,
[0;36m(EngineCore_DP0 pid=359974)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=359974)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=359974)[0;0m     )
[0;36m(EngineCore_DP0 pid=359974)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=359974)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=359974)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359974)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=359974)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359974)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=359974)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=359974)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359974)[0;0m     )
[0;36m(EngineCore_DP0 pid=359974)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359974)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=359974)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=359974)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359974)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=359974)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359974)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=359974)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=359974)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359974)[0;0m     )
[0;36m(EngineCore_DP0 pid=359974)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359974)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=359974)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=359974)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359974)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=359974)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=359974)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=359974)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=359974)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359974)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=359974)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=359974)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=359974)[0;0m     ),
[0;36m(EngineCore_DP0 pid=359974)[0;0m     ^
[0;36m(EngineCore_DP0 pid=359974)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=359974)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=359974)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=360036)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=360036)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=360036)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=360036)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=360036)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360036)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=360036)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=360036)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360036)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=360036)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=360036)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=360036)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=360036)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=360036)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=360036)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360036)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=360036)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360036)[0;0m     )
[0;36m(EngineCore_DP0 pid=360036)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360036)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=360036)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=360036)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360036)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=360036)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=360036)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360036)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=360036)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=360036)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360036)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=360036)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=360036)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360036)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=360036)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=360036)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360036)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=360036)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360036)[0;0m     )
[0;36m(EngineCore_DP0 pid=360036)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360036)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=360036)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=360036)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=360036)[0;0m     )
[0;36m(EngineCore_DP0 pid=360036)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=360036)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=360036)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=360036)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=360036)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360036)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=360036)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360036)[0;0m     )
[0;36m(EngineCore_DP0 pid=360036)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360036)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=360036)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=360036)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360036)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=360036)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=360036)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360036)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=360036)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360036)[0;0m     )
[0;36m(EngineCore_DP0 pid=360036)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360036)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=360036)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=360036)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360036)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=360036)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=360036)[0;0m         config,
[0;36m(EngineCore_DP0 pid=360036)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=360036)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=360036)[0;0m     )
[0;36m(EngineCore_DP0 pid=360036)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=360036)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=360036)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360036)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=360036)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360036)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=360036)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=360036)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360036)[0;0m     )
[0;36m(EngineCore_DP0 pid=360036)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360036)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=360036)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=360036)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360036)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=360036)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360036)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=360036)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=360036)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360036)[0;0m     )
[0;36m(EngineCore_DP0 pid=360036)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360036)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=360036)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=360036)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360036)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=360036)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=360036)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360036)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=360036)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360036)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=360036)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=360036)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360036)[0;0m     ),
[0;36m(EngineCore_DP0 pid=360036)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360036)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=360036)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=360036)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=360098)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=360098)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=360098)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=360098)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=360098)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360098)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=360098)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=360098)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360098)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=360098)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=360098)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=360098)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=360098)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=360098)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=360098)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360098)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=360098)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360098)[0;0m     )
[0;36m(EngineCore_DP0 pid=360098)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360098)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=360098)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=360098)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360098)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=360098)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=360098)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360098)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=360098)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=360098)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360098)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=360098)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=360098)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360098)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=360098)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=360098)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360098)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=360098)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360098)[0;0m     )
[0;36m(EngineCore_DP0 pid=360098)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360098)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=360098)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=360098)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=360098)[0;0m     )
[0;36m(EngineCore_DP0 pid=360098)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=360098)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=360098)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=360098)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=360098)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360098)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=360098)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360098)[0;0m     )
[0;36m(EngineCore_DP0 pid=360098)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360098)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=360098)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=360098)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360098)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=360098)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=360098)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360098)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=360098)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360098)[0;0m     )
[0;36m(EngineCore_DP0 pid=360098)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360098)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=360098)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=360098)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360098)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=360098)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=360098)[0;0m         config,
[0;36m(EngineCore_DP0 pid=360098)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=360098)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=360098)[0;0m     )
[0;36m(EngineCore_DP0 pid=360098)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=360098)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=360098)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360098)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=360098)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360098)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=360098)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=360098)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360098)[0;0m     )
[0;36m(EngineCore_DP0 pid=360098)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360098)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=360098)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=360098)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360098)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=360098)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360098)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=360098)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=360098)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360098)[0;0m     )
[0;36m(EngineCore_DP0 pid=360098)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360098)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=360098)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=360098)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360098)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=360098)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=360098)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360098)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=360098)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360098)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=360098)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=360098)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360098)[0;0m     ),
[0;36m(EngineCore_DP0 pid=360098)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360098)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=360098)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=360098)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=360160)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=360160)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=360160)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=360160)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=360160)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360160)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=360160)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=360160)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360160)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=360160)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=360160)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=360160)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=360160)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=360160)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=360160)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360160)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=360160)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360160)[0;0m     )
[0;36m(EngineCore_DP0 pid=360160)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360160)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=360160)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=360160)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360160)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=360160)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=360160)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360160)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=360160)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=360160)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360160)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=360160)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=360160)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360160)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=360160)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=360160)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360160)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=360160)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360160)[0;0m     )
[0;36m(EngineCore_DP0 pid=360160)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360160)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=360160)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=360160)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=360160)[0;0m     )
[0;36m(EngineCore_DP0 pid=360160)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=360160)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=360160)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=360160)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=360160)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360160)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=360160)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360160)[0;0m     )
[0;36m(EngineCore_DP0 pid=360160)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360160)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=360160)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=360160)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360160)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=360160)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=360160)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360160)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=360160)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360160)[0;0m     )
[0;36m(EngineCore_DP0 pid=360160)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360160)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=360160)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=360160)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360160)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=360160)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=360160)[0;0m         config,
[0;36m(EngineCore_DP0 pid=360160)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=360160)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=360160)[0;0m     )
[0;36m(EngineCore_DP0 pid=360160)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=360160)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=360160)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360160)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=360160)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360160)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=360160)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=360160)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360160)[0;0m     )
[0;36m(EngineCore_DP0 pid=360160)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360160)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=360160)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=360160)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360160)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=360160)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360160)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=360160)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=360160)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360160)[0;0m     )
[0;36m(EngineCore_DP0 pid=360160)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360160)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=360160)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=360160)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360160)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=360160)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=360160)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360160)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=360160)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360160)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=360160)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=360160)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360160)[0;0m     ),
[0;36m(EngineCore_DP0 pid=360160)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360160)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=360160)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=360160)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=360223)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=360223)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=360223)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=360223)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=360223)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360223)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=360223)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=360223)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360223)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=360223)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=360223)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=360223)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=360223)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=360223)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=360223)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360223)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=360223)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360223)[0;0m     )
[0;36m(EngineCore_DP0 pid=360223)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360223)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=360223)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=360223)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360223)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=360223)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=360223)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360223)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=360223)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=360223)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360223)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=360223)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=360223)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360223)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=360223)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=360223)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360223)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=360223)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360223)[0;0m     )
[0;36m(EngineCore_DP0 pid=360223)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360223)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=360223)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=360223)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=360223)[0;0m     )
[0;36m(EngineCore_DP0 pid=360223)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=360223)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=360223)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=360223)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=360223)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360223)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=360223)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360223)[0;0m     )
[0;36m(EngineCore_DP0 pid=360223)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360223)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=360223)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=360223)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360223)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=360223)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=360223)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360223)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=360223)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360223)[0;0m     )
[0;36m(EngineCore_DP0 pid=360223)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360223)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=360223)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=360223)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360223)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=360223)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=360223)[0;0m         config,
[0;36m(EngineCore_DP0 pid=360223)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=360223)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=360223)[0;0m     )
[0;36m(EngineCore_DP0 pid=360223)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=360223)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=360223)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360223)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=360223)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360223)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=360223)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=360223)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360223)[0;0m     )
[0;36m(EngineCore_DP0 pid=360223)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360223)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=360223)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=360223)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360223)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=360223)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360223)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=360223)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=360223)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360223)[0;0m     )
[0;36m(EngineCore_DP0 pid=360223)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360223)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=360223)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=360223)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360223)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=360223)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=360223)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360223)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=360223)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360223)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=360223)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=360223)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360223)[0;0m     ),
[0;36m(EngineCore_DP0 pid=360223)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360223)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=360223)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=360223)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=360628)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=360628)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=360628)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=360628)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=360628)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360628)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=360628)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=360628)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360628)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=360628)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=360628)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=360628)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=360628)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=360628)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=360628)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360628)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=360628)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360628)[0;0m     )
[0;36m(EngineCore_DP0 pid=360628)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360628)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=360628)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=360628)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360628)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=360628)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=360628)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360628)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=360628)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=360628)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360628)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=360628)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=360628)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360628)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=360628)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=360628)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360628)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=360628)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360628)[0;0m     )
[0;36m(EngineCore_DP0 pid=360628)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360628)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=360628)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=360628)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=360628)[0;0m     )
[0;36m(EngineCore_DP0 pid=360628)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=360628)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=360628)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=360628)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=360628)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360628)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=360628)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360628)[0;0m     )
[0;36m(EngineCore_DP0 pid=360628)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360628)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=360628)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=360628)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360628)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=360628)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=360628)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360628)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=360628)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360628)[0;0m     )
[0;36m(EngineCore_DP0 pid=360628)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360628)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=360628)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=360628)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360628)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=360628)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=360628)[0;0m         config,
[0;36m(EngineCore_DP0 pid=360628)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=360628)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=360628)[0;0m     )
[0;36m(EngineCore_DP0 pid=360628)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=360628)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=360628)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360628)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=360628)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360628)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=360628)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=360628)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360628)[0;0m     )
[0;36m(EngineCore_DP0 pid=360628)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360628)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=360628)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=360628)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360628)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=360628)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360628)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=360628)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=360628)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360628)[0;0m     )
[0;36m(EngineCore_DP0 pid=360628)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360628)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=360628)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=360628)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360628)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=360628)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=360628)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360628)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=360628)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360628)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=360628)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=360628)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360628)[0;0m     ),
[0;36m(EngineCore_DP0 pid=360628)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360628)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=360628)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=360628)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=360690)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=360690)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=360690)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=360690)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=360690)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360690)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=360690)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=360690)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360690)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=360690)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=360690)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=360690)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=360690)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=360690)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=360690)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360690)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=360690)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360690)[0;0m     )
[0;36m(EngineCore_DP0 pid=360690)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360690)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=360690)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=360690)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360690)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=360690)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=360690)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360690)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=360690)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=360690)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360690)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=360690)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=360690)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360690)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=360690)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=360690)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360690)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=360690)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360690)[0;0m     )
[0;36m(EngineCore_DP0 pid=360690)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360690)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=360690)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=360690)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=360690)[0;0m     )
[0;36m(EngineCore_DP0 pid=360690)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=360690)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=360690)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=360690)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=360690)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360690)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=360690)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360690)[0;0m     )
[0;36m(EngineCore_DP0 pid=360690)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360690)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=360690)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=360690)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360690)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=360690)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=360690)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360690)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=360690)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360690)[0;0m     )
[0;36m(EngineCore_DP0 pid=360690)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360690)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=360690)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=360690)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360690)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=360690)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=360690)[0;0m         config,
[0;36m(EngineCore_DP0 pid=360690)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=360690)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=360690)[0;0m     )
[0;36m(EngineCore_DP0 pid=360690)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=360690)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=360690)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360690)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=360690)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360690)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=360690)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=360690)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360690)[0;0m     )
[0;36m(EngineCore_DP0 pid=360690)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360690)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=360690)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=360690)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360690)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=360690)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360690)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=360690)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=360690)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360690)[0;0m     )
[0;36m(EngineCore_DP0 pid=360690)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360690)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=360690)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=360690)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360690)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=360690)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=360690)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360690)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=360690)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360690)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=360690)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=360690)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360690)[0;0m     ),
[0;36m(EngineCore_DP0 pid=360690)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360690)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=360690)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=360690)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=360752)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=360752)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=360752)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=360752)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=360752)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360752)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=360752)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=360752)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360752)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=360752)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=360752)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=360752)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=360752)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=360752)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=360752)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360752)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=360752)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360752)[0;0m     )
[0;36m(EngineCore_DP0 pid=360752)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360752)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=360752)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=360752)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360752)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=360752)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=360752)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360752)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=360752)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=360752)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360752)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=360752)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=360752)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360752)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=360752)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=360752)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360752)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=360752)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360752)[0;0m     )
[0;36m(EngineCore_DP0 pid=360752)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360752)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=360752)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=360752)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=360752)[0;0m     )
[0;36m(EngineCore_DP0 pid=360752)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=360752)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=360752)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=360752)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=360752)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360752)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=360752)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360752)[0;0m     )
[0;36m(EngineCore_DP0 pid=360752)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360752)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=360752)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=360752)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360752)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=360752)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=360752)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360752)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=360752)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360752)[0;0m     )
[0;36m(EngineCore_DP0 pid=360752)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360752)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=360752)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=360752)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360752)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=360752)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=360752)[0;0m         config,
[0;36m(EngineCore_DP0 pid=360752)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=360752)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=360752)[0;0m     )
[0;36m(EngineCore_DP0 pid=360752)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=360752)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=360752)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360752)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=360752)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360752)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=360752)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=360752)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360752)[0;0m     )
[0;36m(EngineCore_DP0 pid=360752)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360752)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=360752)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=360752)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360752)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=360752)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360752)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=360752)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=360752)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360752)[0;0m     )
[0;36m(EngineCore_DP0 pid=360752)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360752)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=360752)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=360752)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360752)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=360752)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=360752)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360752)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=360752)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360752)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=360752)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=360752)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360752)[0;0m     ),
[0;36m(EngineCore_DP0 pid=360752)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360752)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=360752)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=360752)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=360814)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=360814)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=360814)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=360814)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=360814)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360814)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=360814)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=360814)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360814)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=360814)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=360814)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=360814)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=360814)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=360814)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=360814)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360814)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=360814)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360814)[0;0m     )
[0;36m(EngineCore_DP0 pid=360814)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360814)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=360814)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=360814)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360814)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=360814)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=360814)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360814)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=360814)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=360814)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360814)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=360814)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=360814)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360814)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=360814)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=360814)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360814)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=360814)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360814)[0;0m     )
[0;36m(EngineCore_DP0 pid=360814)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360814)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=360814)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=360814)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=360814)[0;0m     )
[0;36m(EngineCore_DP0 pid=360814)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=360814)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=360814)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=360814)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=360814)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360814)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=360814)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360814)[0;0m     )
[0;36m(EngineCore_DP0 pid=360814)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360814)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=360814)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=360814)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360814)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=360814)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=360814)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360814)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=360814)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360814)[0;0m     )
[0;36m(EngineCore_DP0 pid=360814)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360814)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=360814)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=360814)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360814)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=360814)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=360814)[0;0m         config,
[0;36m(EngineCore_DP0 pid=360814)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=360814)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=360814)[0;0m     )
[0;36m(EngineCore_DP0 pid=360814)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=360814)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=360814)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360814)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=360814)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360814)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=360814)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=360814)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360814)[0;0m     )
[0;36m(EngineCore_DP0 pid=360814)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360814)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=360814)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=360814)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360814)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=360814)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360814)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=360814)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=360814)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360814)[0;0m     )
[0;36m(EngineCore_DP0 pid=360814)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360814)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=360814)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=360814)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360814)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=360814)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=360814)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360814)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=360814)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360814)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=360814)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=360814)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360814)[0;0m     ),
[0;36m(EngineCore_DP0 pid=360814)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360814)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=360814)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=360814)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=360876)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=360876)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=360876)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=360876)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=360876)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360876)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=360876)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=360876)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360876)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=360876)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=360876)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=360876)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=360876)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=360876)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=360876)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360876)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=360876)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360876)[0;0m     )
[0;36m(EngineCore_DP0 pid=360876)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360876)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=360876)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=360876)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360876)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=360876)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=360876)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360876)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=360876)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=360876)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=360876)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=360876)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=360876)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360876)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=360876)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=360876)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360876)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=360876)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360876)[0;0m     )
[0;36m(EngineCore_DP0 pid=360876)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360876)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=360876)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=360876)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=360876)[0;0m     )
[0;36m(EngineCore_DP0 pid=360876)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=360876)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=360876)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=360876)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=360876)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360876)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=360876)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360876)[0;0m     )
[0;36m(EngineCore_DP0 pid=360876)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360876)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=360876)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=360876)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360876)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=360876)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=360876)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360876)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=360876)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360876)[0;0m     )
[0;36m(EngineCore_DP0 pid=360876)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360876)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=360876)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=360876)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360876)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=360876)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=360876)[0;0m         config,
[0;36m(EngineCore_DP0 pid=360876)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=360876)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=360876)[0;0m     )
[0;36m(EngineCore_DP0 pid=360876)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=360876)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=360876)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360876)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=360876)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360876)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=360876)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=360876)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360876)[0;0m     )
[0;36m(EngineCore_DP0 pid=360876)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360876)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=360876)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=360876)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360876)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=360876)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360876)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=360876)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=360876)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360876)[0;0m     )
[0;36m(EngineCore_DP0 pid=360876)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360876)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=360876)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=360876)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360876)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=360876)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=360876)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=360876)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=360876)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360876)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=360876)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=360876)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=360876)[0;0m     ),
[0;36m(EngineCore_DP0 pid=360876)[0;0m     ^
[0;36m(EngineCore_DP0 pid=360876)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=360876)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=360876)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=361281)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=361281)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=361281)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=361281)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=361281)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=361281)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=361281)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=361281)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361281)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=361281)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=361281)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=361281)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=361281)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=361281)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=361281)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361281)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=361281)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361281)[0;0m     )
[0;36m(EngineCore_DP0 pid=361281)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361281)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=361281)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=361281)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361281)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=361281)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=361281)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=361281)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=361281)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=361281)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=361281)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=361281)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=361281)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361281)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=361281)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=361281)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361281)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=361281)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361281)[0;0m     )
[0;36m(EngineCore_DP0 pid=361281)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361281)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=361281)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=361281)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=361281)[0;0m     )
[0;36m(EngineCore_DP0 pid=361281)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=361281)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=361281)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=361281)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=361281)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361281)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=361281)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361281)[0;0m     )
[0;36m(EngineCore_DP0 pid=361281)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361281)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=361281)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=361281)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361281)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=361281)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=361281)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361281)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=361281)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361281)[0;0m     )
[0;36m(EngineCore_DP0 pid=361281)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361281)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=361281)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=361281)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361281)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=361281)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=361281)[0;0m         config,
[0;36m(EngineCore_DP0 pid=361281)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=361281)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=361281)[0;0m     )
[0;36m(EngineCore_DP0 pid=361281)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=361281)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=361281)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361281)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=361281)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361281)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=361281)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=361281)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361281)[0;0m     )
[0;36m(EngineCore_DP0 pid=361281)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361281)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=361281)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=361281)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361281)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=361281)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361281)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=361281)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=361281)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361281)[0;0m     )
[0;36m(EngineCore_DP0 pid=361281)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361281)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=361281)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=361281)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361281)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=361281)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=361281)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361281)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=361281)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361281)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=361281)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=361281)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361281)[0;0m     ),
[0;36m(EngineCore_DP0 pid=361281)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361281)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=361281)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=361281)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=361343)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=361343)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=361343)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=361343)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=361343)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=361343)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=361343)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=361343)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361343)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=361343)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=361343)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=361343)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=361343)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=361343)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=361343)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361343)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=361343)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361343)[0;0m     )
[0;36m(EngineCore_DP0 pid=361343)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361343)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=361343)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=361343)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361343)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=361343)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=361343)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=361343)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=361343)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=361343)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=361343)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=361343)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=361343)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361343)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=361343)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=361343)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361343)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=361343)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361343)[0;0m     )
[0;36m(EngineCore_DP0 pid=361343)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361343)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=361343)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=361343)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=361343)[0;0m     )
[0;36m(EngineCore_DP0 pid=361343)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=361343)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=361343)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=361343)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=361343)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361343)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=361343)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361343)[0;0m     )
[0;36m(EngineCore_DP0 pid=361343)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361343)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=361343)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=361343)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361343)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=361343)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=361343)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361343)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=361343)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361343)[0;0m     )
[0;36m(EngineCore_DP0 pid=361343)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361343)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=361343)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=361343)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361343)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=361343)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=361343)[0;0m         config,
[0;36m(EngineCore_DP0 pid=361343)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=361343)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=361343)[0;0m     )
[0;36m(EngineCore_DP0 pid=361343)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=361343)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=361343)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361343)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=361343)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361343)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=361343)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=361343)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361343)[0;0m     )
[0;36m(EngineCore_DP0 pid=361343)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361343)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=361343)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=361343)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361343)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=361343)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361343)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=361343)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=361343)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361343)[0;0m     )
[0;36m(EngineCore_DP0 pid=361343)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361343)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=361343)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=361343)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361343)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=361343)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=361343)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361343)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=361343)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361343)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=361343)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=361343)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361343)[0;0m     ),
[0;36m(EngineCore_DP0 pid=361343)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361343)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=361343)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=361343)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=361405)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=361405)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=361405)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=361405)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=361405)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=361405)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=361405)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=361405)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361405)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=361405)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=361405)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=361405)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=361405)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=361405)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=361405)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361405)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=361405)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361405)[0;0m     )
[0;36m(EngineCore_DP0 pid=361405)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361405)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=361405)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=361405)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361405)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=361405)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=361405)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=361405)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=361405)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=361405)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=361405)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=361405)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=361405)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361405)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=361405)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=361405)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361405)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=361405)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361405)[0;0m     )
[0;36m(EngineCore_DP0 pid=361405)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361405)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=361405)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=361405)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=361405)[0;0m     )
[0;36m(EngineCore_DP0 pid=361405)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=361405)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=361405)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=361405)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=361405)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361405)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=361405)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361405)[0;0m     )
[0;36m(EngineCore_DP0 pid=361405)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361405)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=361405)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=361405)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361405)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=361405)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=361405)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361405)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=361405)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361405)[0;0m     )
[0;36m(EngineCore_DP0 pid=361405)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361405)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=361405)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=361405)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361405)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=361405)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=361405)[0;0m         config,
[0;36m(EngineCore_DP0 pid=361405)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=361405)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=361405)[0;0m     )
[0;36m(EngineCore_DP0 pid=361405)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=361405)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=361405)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361405)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=361405)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361405)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=361405)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=361405)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361405)[0;0m     )
[0;36m(EngineCore_DP0 pid=361405)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361405)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=361405)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=361405)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361405)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=361405)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361405)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=361405)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=361405)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361405)[0;0m     )
[0;36m(EngineCore_DP0 pid=361405)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361405)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=361405)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=361405)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361405)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=361405)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=361405)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361405)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=361405)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361405)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=361405)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=361405)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361405)[0;0m     ),
[0;36m(EngineCore_DP0 pid=361405)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361405)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=361405)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=361405)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=361467)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=361467)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=361467)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=361467)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=361467)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=361467)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=361467)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=361467)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361467)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=361467)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=361467)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=361467)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=361467)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=361467)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=361467)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361467)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=361467)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361467)[0;0m     )
[0;36m(EngineCore_DP0 pid=361467)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361467)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=361467)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=361467)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361467)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=361467)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=361467)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=361467)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=361467)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=361467)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=361467)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=361467)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=361467)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361467)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=361467)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=361467)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361467)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=361467)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361467)[0;0m     )
[0;36m(EngineCore_DP0 pid=361467)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361467)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=361467)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=361467)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=361467)[0;0m     )
[0;36m(EngineCore_DP0 pid=361467)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=361467)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=361467)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=361467)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=361467)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361467)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=361467)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361467)[0;0m     )
[0;36m(EngineCore_DP0 pid=361467)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361467)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=361467)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=361467)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361467)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=361467)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=361467)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361467)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=361467)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361467)[0;0m     )
[0;36m(EngineCore_DP0 pid=361467)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361467)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=361467)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=361467)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361467)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=361467)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=361467)[0;0m         config,
[0;36m(EngineCore_DP0 pid=361467)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=361467)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=361467)[0;0m     )
[0;36m(EngineCore_DP0 pid=361467)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=361467)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=361467)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361467)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=361467)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361467)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=361467)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=361467)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361467)[0;0m     )
[0;36m(EngineCore_DP0 pid=361467)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361467)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=361467)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=361467)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361467)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=361467)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361467)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=361467)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=361467)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361467)[0;0m     )
[0;36m(EngineCore_DP0 pid=361467)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361467)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=361467)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=361467)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361467)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=361467)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=361467)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361467)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=361467)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361467)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=361467)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=361467)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361467)[0;0m     ),
[0;36m(EngineCore_DP0 pid=361467)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361467)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=361467)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=361467)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=361529)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=361529)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=361529)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=361529)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=361529)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=361529)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=361529)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=361529)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361529)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=361529)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=361529)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=361529)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=361529)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=361529)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=361529)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361529)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=361529)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361529)[0;0m     )
[0;36m(EngineCore_DP0 pid=361529)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361529)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=361529)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=361529)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361529)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=361529)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=361529)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=361529)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=361529)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=361529)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=361529)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=361529)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=361529)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361529)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=361529)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=361529)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361529)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=361529)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361529)[0;0m     )
[0;36m(EngineCore_DP0 pid=361529)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361529)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=361529)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=361529)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=361529)[0;0m     )
[0;36m(EngineCore_DP0 pid=361529)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=361529)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=361529)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=361529)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=361529)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361529)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=361529)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361529)[0;0m     )
[0;36m(EngineCore_DP0 pid=361529)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361529)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=361529)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=361529)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361529)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=361529)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=361529)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361529)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=361529)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361529)[0;0m     )
[0;36m(EngineCore_DP0 pid=361529)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361529)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=361529)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=361529)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361529)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=361529)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=361529)[0;0m         config,
[0;36m(EngineCore_DP0 pid=361529)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=361529)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=361529)[0;0m     )
[0;36m(EngineCore_DP0 pid=361529)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=361529)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=361529)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361529)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=361529)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361529)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=361529)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=361529)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361529)[0;0m     )
[0;36m(EngineCore_DP0 pid=361529)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361529)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=361529)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=361529)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361529)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=361529)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361529)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=361529)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=361529)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361529)[0;0m     )
[0;36m(EngineCore_DP0 pid=361529)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361529)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=361529)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=361529)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361529)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=361529)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=361529)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361529)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=361529)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361529)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=361529)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=361529)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361529)[0;0m     ),
[0;36m(EngineCore_DP0 pid=361529)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361529)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=361529)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=361529)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=361960)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=361960)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=361960)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=361960)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=361960)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=361960)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=361960)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=361960)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361960)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=361960)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=361960)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=361960)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=361960)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=361960)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=361960)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361960)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=361960)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361960)[0;0m     )
[0;36m(EngineCore_DP0 pid=361960)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361960)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=361960)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=361960)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361960)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=361960)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=361960)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=361960)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=361960)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=361960)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=361960)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=361960)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=361960)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361960)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=361960)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=361960)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361960)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=361960)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361960)[0;0m     )
[0;36m(EngineCore_DP0 pid=361960)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361960)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=361960)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=361960)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=361960)[0;0m     )
[0;36m(EngineCore_DP0 pid=361960)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=361960)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=361960)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=361960)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=361960)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361960)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=361960)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361960)[0;0m     )
[0;36m(EngineCore_DP0 pid=361960)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361960)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=361960)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=361960)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361960)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=361960)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=361960)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361960)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=361960)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361960)[0;0m     )
[0;36m(EngineCore_DP0 pid=361960)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361960)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=361960)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=361960)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361960)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=361960)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=361960)[0;0m         config,
[0;36m(EngineCore_DP0 pid=361960)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=361960)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=361960)[0;0m     )
[0;36m(EngineCore_DP0 pid=361960)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=361960)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=361960)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361960)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=361960)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361960)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=361960)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=361960)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361960)[0;0m     )
[0;36m(EngineCore_DP0 pid=361960)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361960)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=361960)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=361960)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361960)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=361960)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361960)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=361960)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=361960)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361960)[0;0m     )
[0;36m(EngineCore_DP0 pid=361960)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361960)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=361960)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=361960)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361960)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=361960)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=361960)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=361960)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=361960)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361960)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=361960)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=361960)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=361960)[0;0m     ),
[0;36m(EngineCore_DP0 pid=361960)[0;0m     ^
[0;36m(EngineCore_DP0 pid=361960)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=361960)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=361960)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=362022)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=362022)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=362022)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=362022)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=362022)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362022)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=362022)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=362022)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362022)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=362022)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=362022)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=362022)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=362022)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=362022)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=362022)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362022)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=362022)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362022)[0;0m     )
[0;36m(EngineCore_DP0 pid=362022)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362022)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=362022)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=362022)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362022)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=362022)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=362022)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362022)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=362022)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=362022)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362022)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=362022)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=362022)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362022)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=362022)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=362022)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362022)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=362022)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362022)[0;0m     )
[0;36m(EngineCore_DP0 pid=362022)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362022)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=362022)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=362022)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=362022)[0;0m     )
[0;36m(EngineCore_DP0 pid=362022)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=362022)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=362022)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=362022)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=362022)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362022)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=362022)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362022)[0;0m     )
[0;36m(EngineCore_DP0 pid=362022)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362022)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=362022)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=362022)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362022)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=362022)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=362022)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362022)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=362022)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362022)[0;0m     )
[0;36m(EngineCore_DP0 pid=362022)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362022)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=362022)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=362022)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362022)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=362022)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=362022)[0;0m         config,
[0;36m(EngineCore_DP0 pid=362022)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=362022)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=362022)[0;0m     )
[0;36m(EngineCore_DP0 pid=362022)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=362022)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=362022)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362022)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=362022)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362022)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=362022)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=362022)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362022)[0;0m     )
[0;36m(EngineCore_DP0 pid=362022)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362022)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=362022)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=362022)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362022)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=362022)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362022)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=362022)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=362022)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362022)[0;0m     )
[0;36m(EngineCore_DP0 pid=362022)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362022)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=362022)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=362022)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362022)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=362022)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=362022)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362022)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=362022)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362022)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=362022)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=362022)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362022)[0;0m     ),
[0;36m(EngineCore_DP0 pid=362022)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362022)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=362022)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=362022)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=362084)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=362084)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=362084)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=362084)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=362084)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362084)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=362084)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=362084)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362084)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=362084)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=362084)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=362084)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=362084)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=362084)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=362084)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362084)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=362084)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362084)[0;0m     )
[0;36m(EngineCore_DP0 pid=362084)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362084)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=362084)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=362084)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362084)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=362084)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=362084)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362084)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=362084)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=362084)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362084)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=362084)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=362084)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362084)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=362084)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=362084)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362084)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=362084)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362084)[0;0m     )
[0;36m(EngineCore_DP0 pid=362084)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362084)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=362084)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=362084)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=362084)[0;0m     )
[0;36m(EngineCore_DP0 pid=362084)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=362084)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=362084)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=362084)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=362084)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362084)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=362084)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362084)[0;0m     )
[0;36m(EngineCore_DP0 pid=362084)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362084)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=362084)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=362084)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362084)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=362084)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=362084)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362084)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=362084)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362084)[0;0m     )
[0;36m(EngineCore_DP0 pid=362084)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362084)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=362084)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=362084)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362084)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=362084)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=362084)[0;0m         config,
[0;36m(EngineCore_DP0 pid=362084)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=362084)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=362084)[0;0m     )
[0;36m(EngineCore_DP0 pid=362084)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=362084)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=362084)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362084)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=362084)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362084)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=362084)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=362084)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362084)[0;0m     )
[0;36m(EngineCore_DP0 pid=362084)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362084)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=362084)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=362084)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362084)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=362084)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362084)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=362084)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=362084)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362084)[0;0m     )
[0;36m(EngineCore_DP0 pid=362084)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362084)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=362084)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=362084)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362084)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=362084)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=362084)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362084)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=362084)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362084)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=362084)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=362084)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362084)[0;0m     ),
[0;36m(EngineCore_DP0 pid=362084)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362084)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=362084)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=362084)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=362146)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=362146)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=362146)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=362146)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=362146)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362146)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=362146)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=362146)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362146)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=362146)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=362146)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=362146)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=362146)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=362146)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=362146)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362146)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=362146)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362146)[0;0m     )
[0;36m(EngineCore_DP0 pid=362146)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362146)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=362146)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=362146)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362146)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=362146)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=362146)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362146)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=362146)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=362146)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362146)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=362146)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=362146)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362146)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=362146)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=362146)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362146)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=362146)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362146)[0;0m     )
[0;36m(EngineCore_DP0 pid=362146)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362146)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=362146)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=362146)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=362146)[0;0m     )
[0;36m(EngineCore_DP0 pid=362146)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=362146)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=362146)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=362146)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=362146)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362146)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=362146)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362146)[0;0m     )
[0;36m(EngineCore_DP0 pid=362146)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362146)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=362146)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=362146)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362146)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=362146)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=362146)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362146)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=362146)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362146)[0;0m     )
[0;36m(EngineCore_DP0 pid=362146)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362146)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=362146)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=362146)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362146)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=362146)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=362146)[0;0m         config,
[0;36m(EngineCore_DP0 pid=362146)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=362146)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=362146)[0;0m     )
[0;36m(EngineCore_DP0 pid=362146)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=362146)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=362146)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362146)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=362146)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362146)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=362146)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=362146)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362146)[0;0m     )
[0;36m(EngineCore_DP0 pid=362146)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362146)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=362146)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=362146)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362146)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=362146)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362146)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=362146)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=362146)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362146)[0;0m     )
[0;36m(EngineCore_DP0 pid=362146)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362146)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=362146)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=362146)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362146)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=362146)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=362146)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362146)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=362146)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362146)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=362146)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=362146)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362146)[0;0m     ),
[0;36m(EngineCore_DP0 pid=362146)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362146)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=362146)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=362146)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=362208)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=362208)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=362208)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=362208)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=362208)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362208)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=362208)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=362208)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362208)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=362208)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=362208)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=362208)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=362208)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=362208)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=362208)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362208)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=362208)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362208)[0;0m     )
[0;36m(EngineCore_DP0 pid=362208)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362208)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=362208)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=362208)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362208)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=362208)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=362208)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362208)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=362208)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=362208)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362208)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=362208)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=362208)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362208)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=362208)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=362208)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362208)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=362208)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362208)[0;0m     )
[0;36m(EngineCore_DP0 pid=362208)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362208)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=362208)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=362208)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=362208)[0;0m     )
[0;36m(EngineCore_DP0 pid=362208)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=362208)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=362208)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=362208)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=362208)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362208)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=362208)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362208)[0;0m     )
[0;36m(EngineCore_DP0 pid=362208)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362208)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=362208)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=362208)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362208)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=362208)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=362208)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362208)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=362208)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362208)[0;0m     )
[0;36m(EngineCore_DP0 pid=362208)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362208)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=362208)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=362208)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362208)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=362208)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=362208)[0;0m         config,
[0;36m(EngineCore_DP0 pid=362208)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=362208)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=362208)[0;0m     )
[0;36m(EngineCore_DP0 pid=362208)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=362208)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=362208)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362208)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=362208)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362208)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=362208)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=362208)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362208)[0;0m     )
[0;36m(EngineCore_DP0 pid=362208)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362208)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=362208)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=362208)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362208)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=362208)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362208)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=362208)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=362208)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362208)[0;0m     )
[0;36m(EngineCore_DP0 pid=362208)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362208)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=362208)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=362208)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362208)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=362208)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=362208)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362208)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=362208)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362208)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=362208)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=362208)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362208)[0;0m     ),
[0;36m(EngineCore_DP0 pid=362208)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362208)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=362208)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=362208)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=362270)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=362270)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=362270)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=362270)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=362270)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362270)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=362270)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=362270)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362270)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=362270)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=362270)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=362270)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=362270)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=362270)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=362270)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362270)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=362270)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362270)[0;0m     )
[0;36m(EngineCore_DP0 pid=362270)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362270)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=362270)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=362270)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362270)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=362270)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=362270)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362270)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=362270)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=362270)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362270)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=362270)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=362270)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362270)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=362270)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=362270)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362270)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=362270)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362270)[0;0m     )
[0;36m(EngineCore_DP0 pid=362270)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362270)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=362270)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=362270)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=362270)[0;0m     )
[0;36m(EngineCore_DP0 pid=362270)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=362270)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=362270)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=362270)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=362270)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362270)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=362270)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362270)[0;0m     )
[0;36m(EngineCore_DP0 pid=362270)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362270)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=362270)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=362270)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362270)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=362270)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=362270)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362270)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=362270)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362270)[0;0m     )
[0;36m(EngineCore_DP0 pid=362270)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362270)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=362270)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=362270)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362270)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=362270)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=362270)[0;0m         config,
[0;36m(EngineCore_DP0 pid=362270)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=362270)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=362270)[0;0m     )
[0;36m(EngineCore_DP0 pid=362270)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=362270)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=362270)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362270)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=362270)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362270)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=362270)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=362270)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362270)[0;0m     )
[0;36m(EngineCore_DP0 pid=362270)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362270)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=362270)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=362270)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362270)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=362270)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362270)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=362270)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=362270)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362270)[0;0m     )
[0;36m(EngineCore_DP0 pid=362270)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362270)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=362270)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=362270)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362270)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=362270)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=362270)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362270)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=362270)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362270)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=362270)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=362270)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362270)[0;0m     ),
[0;36m(EngineCore_DP0 pid=362270)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362270)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=362270)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=362270)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=362332)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=362332)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=362332)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=362332)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=362332)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362332)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=362332)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=362332)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362332)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=362332)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=362332)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=362332)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=362332)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=362332)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=362332)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362332)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=362332)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362332)[0;0m     )
[0;36m(EngineCore_DP0 pid=362332)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362332)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=362332)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=362332)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362332)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=362332)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=362332)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362332)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=362332)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=362332)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362332)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=362332)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=362332)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362332)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=362332)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=362332)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362332)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=362332)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362332)[0;0m     )
[0;36m(EngineCore_DP0 pid=362332)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362332)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=362332)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=362332)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=362332)[0;0m     )
[0;36m(EngineCore_DP0 pid=362332)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=362332)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=362332)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=362332)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=362332)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362332)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=362332)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362332)[0;0m     )
[0;36m(EngineCore_DP0 pid=362332)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362332)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=362332)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=362332)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362332)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=362332)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=362332)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362332)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=362332)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362332)[0;0m     )
[0;36m(EngineCore_DP0 pid=362332)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362332)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=362332)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=362332)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362332)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=362332)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=362332)[0;0m         config,
[0;36m(EngineCore_DP0 pid=362332)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=362332)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=362332)[0;0m     )
[0;36m(EngineCore_DP0 pid=362332)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=362332)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=362332)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362332)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=362332)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362332)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=362332)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=362332)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362332)[0;0m     )
[0;36m(EngineCore_DP0 pid=362332)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362332)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=362332)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=362332)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362332)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=362332)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362332)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=362332)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=362332)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362332)[0;0m     )
[0;36m(EngineCore_DP0 pid=362332)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362332)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=362332)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=362332)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362332)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=362332)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=362332)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362332)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=362332)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362332)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=362332)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=362332)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362332)[0;0m     ),
[0;36m(EngineCore_DP0 pid=362332)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362332)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=362332)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=362332)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=362738)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=362738)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=362738)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=362738)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=362738)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362738)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=362738)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=362738)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362738)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=362738)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=362738)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=362738)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=362738)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=362738)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=362738)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362738)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=362738)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362738)[0;0m     )
[0;36m(EngineCore_DP0 pid=362738)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362738)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=362738)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=362738)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362738)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=362738)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=362738)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362738)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=362738)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=362738)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362738)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=362738)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=362738)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362738)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=362738)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=362738)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362738)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=362738)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362738)[0;0m     )
[0;36m(EngineCore_DP0 pid=362738)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362738)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=362738)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=362738)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=362738)[0;0m     )
[0;36m(EngineCore_DP0 pid=362738)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=362738)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=362738)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=362738)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=362738)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362738)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=362738)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362738)[0;0m     )
[0;36m(EngineCore_DP0 pid=362738)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362738)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=362738)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=362738)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362738)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=362738)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=362738)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362738)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=362738)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362738)[0;0m     )
[0;36m(EngineCore_DP0 pid=362738)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362738)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=362738)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=362738)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362738)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=362738)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=362738)[0;0m         config,
[0;36m(EngineCore_DP0 pid=362738)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=362738)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=362738)[0;0m     )
[0;36m(EngineCore_DP0 pid=362738)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=362738)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=362738)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362738)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=362738)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362738)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=362738)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=362738)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362738)[0;0m     )
[0;36m(EngineCore_DP0 pid=362738)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362738)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=362738)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=362738)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362738)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=362738)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362738)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=362738)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=362738)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362738)[0;0m     )
[0;36m(EngineCore_DP0 pid=362738)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362738)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=362738)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=362738)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362738)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=362738)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=362738)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362738)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=362738)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362738)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=362738)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=362738)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362738)[0;0m     ),
[0;36m(EngineCore_DP0 pid=362738)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362738)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=362738)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=362738)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=362801)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=362801)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=362801)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=362801)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=362801)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362801)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=362801)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=362801)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362801)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=362801)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=362801)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=362801)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=362801)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=362801)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=362801)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362801)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=362801)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362801)[0;0m     )
[0;36m(EngineCore_DP0 pid=362801)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362801)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=362801)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=362801)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362801)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=362801)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=362801)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362801)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=362801)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=362801)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362801)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=362801)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=362801)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362801)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=362801)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=362801)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362801)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=362801)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362801)[0;0m     )
[0;36m(EngineCore_DP0 pid=362801)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362801)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=362801)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=362801)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=362801)[0;0m     )
[0;36m(EngineCore_DP0 pid=362801)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=362801)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=362801)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=362801)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=362801)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362801)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=362801)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362801)[0;0m     )
[0;36m(EngineCore_DP0 pid=362801)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362801)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=362801)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=362801)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362801)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=362801)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=362801)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362801)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=362801)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362801)[0;0m     )
[0;36m(EngineCore_DP0 pid=362801)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362801)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=362801)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=362801)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362801)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=362801)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=362801)[0;0m         config,
[0;36m(EngineCore_DP0 pid=362801)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=362801)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=362801)[0;0m     )
[0;36m(EngineCore_DP0 pid=362801)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=362801)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=362801)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362801)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=362801)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362801)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=362801)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=362801)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362801)[0;0m     )
[0;36m(EngineCore_DP0 pid=362801)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362801)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=362801)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=362801)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362801)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=362801)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362801)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=362801)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=362801)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362801)[0;0m     )
[0;36m(EngineCore_DP0 pid=362801)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362801)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=362801)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=362801)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362801)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=362801)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=362801)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362801)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=362801)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362801)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=362801)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=362801)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362801)[0;0m     ),
[0;36m(EngineCore_DP0 pid=362801)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362801)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=362801)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=362801)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=362863)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=362863)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=362863)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=362863)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=362863)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362863)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=362863)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=362863)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362863)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=362863)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=362863)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=362863)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=362863)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=362863)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=362863)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362863)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=362863)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362863)[0;0m     )
[0;36m(EngineCore_DP0 pid=362863)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362863)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=362863)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=362863)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362863)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=362863)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=362863)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362863)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=362863)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=362863)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362863)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=362863)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=362863)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362863)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=362863)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=362863)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362863)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=362863)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362863)[0;0m     )
[0;36m(EngineCore_DP0 pid=362863)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362863)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=362863)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=362863)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=362863)[0;0m     )
[0;36m(EngineCore_DP0 pid=362863)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=362863)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=362863)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=362863)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=362863)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362863)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=362863)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362863)[0;0m     )
[0;36m(EngineCore_DP0 pid=362863)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362863)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=362863)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=362863)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362863)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=362863)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=362863)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362863)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=362863)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362863)[0;0m     )
[0;36m(EngineCore_DP0 pid=362863)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362863)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=362863)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=362863)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362863)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=362863)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=362863)[0;0m         config,
[0;36m(EngineCore_DP0 pid=362863)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=362863)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=362863)[0;0m     )
[0;36m(EngineCore_DP0 pid=362863)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=362863)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=362863)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362863)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=362863)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362863)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=362863)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=362863)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362863)[0;0m     )
[0;36m(EngineCore_DP0 pid=362863)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362863)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=362863)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=362863)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362863)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=362863)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362863)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=362863)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=362863)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362863)[0;0m     )
[0;36m(EngineCore_DP0 pid=362863)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362863)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=362863)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=362863)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362863)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=362863)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=362863)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362863)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=362863)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362863)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=362863)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=362863)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362863)[0;0m     ),
[0;36m(EngineCore_DP0 pid=362863)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362863)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=362863)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=362863)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=362925)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=362925)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=362925)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=362925)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=362925)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362925)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=362925)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=362925)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362925)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=362925)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=362925)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=362925)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=362925)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=362925)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=362925)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362925)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=362925)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362925)[0;0m     )
[0;36m(EngineCore_DP0 pid=362925)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362925)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=362925)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=362925)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362925)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=362925)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=362925)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362925)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=362925)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=362925)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362925)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=362925)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=362925)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362925)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=362925)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=362925)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362925)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=362925)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362925)[0;0m     )
[0;36m(EngineCore_DP0 pid=362925)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362925)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=362925)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=362925)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=362925)[0;0m     )
[0;36m(EngineCore_DP0 pid=362925)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=362925)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=362925)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=362925)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=362925)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362925)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=362925)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362925)[0;0m     )
[0;36m(EngineCore_DP0 pid=362925)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362925)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=362925)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=362925)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362925)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=362925)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=362925)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362925)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=362925)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362925)[0;0m     )
[0;36m(EngineCore_DP0 pid=362925)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362925)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=362925)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=362925)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362925)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=362925)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=362925)[0;0m         config,
[0;36m(EngineCore_DP0 pid=362925)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=362925)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=362925)[0;0m     )
[0;36m(EngineCore_DP0 pid=362925)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=362925)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=362925)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362925)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=362925)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362925)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=362925)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=362925)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362925)[0;0m     )
[0;36m(EngineCore_DP0 pid=362925)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362925)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=362925)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=362925)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362925)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=362925)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362925)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=362925)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=362925)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362925)[0;0m     )
[0;36m(EngineCore_DP0 pid=362925)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362925)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=362925)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=362925)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362925)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=362925)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=362925)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362925)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=362925)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362925)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=362925)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=362925)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362925)[0;0m     ),
[0;36m(EngineCore_DP0 pid=362925)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362925)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=362925)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=362925)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=362987)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=362987)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=362987)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=362987)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=362987)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362987)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=362987)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=362987)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362987)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=362987)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=362987)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=362987)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=362987)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=362987)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=362987)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362987)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=362987)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362987)[0;0m     )
[0;36m(EngineCore_DP0 pid=362987)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362987)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=362987)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=362987)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362987)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=362987)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=362987)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362987)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=362987)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=362987)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=362987)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=362987)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=362987)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362987)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=362987)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=362987)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362987)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=362987)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362987)[0;0m     )
[0;36m(EngineCore_DP0 pid=362987)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362987)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=362987)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=362987)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=362987)[0;0m     )
[0;36m(EngineCore_DP0 pid=362987)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=362987)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=362987)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=362987)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=362987)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362987)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=362987)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362987)[0;0m     )
[0;36m(EngineCore_DP0 pid=362987)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362987)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=362987)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=362987)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362987)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=362987)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=362987)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362987)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=362987)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362987)[0;0m     )
[0;36m(EngineCore_DP0 pid=362987)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362987)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=362987)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=362987)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362987)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=362987)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=362987)[0;0m         config,
[0;36m(EngineCore_DP0 pid=362987)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=362987)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=362987)[0;0m     )
[0;36m(EngineCore_DP0 pid=362987)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=362987)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=362987)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362987)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=362987)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362987)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=362987)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=362987)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362987)[0;0m     )
[0;36m(EngineCore_DP0 pid=362987)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362987)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=362987)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=362987)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362987)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=362987)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362987)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=362987)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=362987)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362987)[0;0m     )
[0;36m(EngineCore_DP0 pid=362987)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362987)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=362987)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=362987)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362987)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=362987)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=362987)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=362987)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=362987)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362987)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=362987)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=362987)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=362987)[0;0m     ),
[0;36m(EngineCore_DP0 pid=362987)[0;0m     ^
[0;36m(EngineCore_DP0 pid=362987)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=362987)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=362987)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=363049)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=363049)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=363049)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=363049)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=363049)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363049)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=363049)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=363049)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363049)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=363049)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=363049)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=363049)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=363049)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=363049)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=363049)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363049)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=363049)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363049)[0;0m     )
[0;36m(EngineCore_DP0 pid=363049)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363049)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=363049)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=363049)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363049)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=363049)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=363049)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363049)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=363049)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=363049)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363049)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=363049)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=363049)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363049)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=363049)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=363049)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363049)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=363049)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363049)[0;0m     )
[0;36m(EngineCore_DP0 pid=363049)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363049)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=363049)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=363049)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=363049)[0;0m     )
[0;36m(EngineCore_DP0 pid=363049)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=363049)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=363049)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=363049)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=363049)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363049)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=363049)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363049)[0;0m     )
[0;36m(EngineCore_DP0 pid=363049)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363049)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=363049)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=363049)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363049)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=363049)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=363049)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363049)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=363049)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363049)[0;0m     )
[0;36m(EngineCore_DP0 pid=363049)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363049)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=363049)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=363049)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363049)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=363049)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=363049)[0;0m         config,
[0;36m(EngineCore_DP0 pid=363049)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=363049)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=363049)[0;0m     )
[0;36m(EngineCore_DP0 pid=363049)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=363049)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=363049)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363049)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=363049)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363049)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=363049)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=363049)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363049)[0;0m     )
[0;36m(EngineCore_DP0 pid=363049)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363049)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=363049)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=363049)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363049)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=363049)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363049)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=363049)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=363049)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363049)[0;0m     )
[0;36m(EngineCore_DP0 pid=363049)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363049)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=363049)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=363049)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363049)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=363049)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=363049)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363049)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=363049)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363049)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=363049)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=363049)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363049)[0;0m     ),
[0;36m(EngineCore_DP0 pid=363049)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363049)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=363049)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=363049)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=363111)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=363111)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=363111)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=363111)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=363111)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363111)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=363111)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=363111)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363111)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=363111)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=363111)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=363111)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=363111)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=363111)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=363111)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363111)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=363111)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363111)[0;0m     )
[0;36m(EngineCore_DP0 pid=363111)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363111)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=363111)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=363111)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363111)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=363111)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=363111)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363111)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=363111)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=363111)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363111)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=363111)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=363111)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363111)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=363111)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=363111)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363111)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=363111)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363111)[0;0m     )
[0;36m(EngineCore_DP0 pid=363111)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363111)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=363111)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=363111)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=363111)[0;0m     )
[0;36m(EngineCore_DP0 pid=363111)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=363111)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=363111)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=363111)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=363111)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363111)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=363111)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363111)[0;0m     )
[0;36m(EngineCore_DP0 pid=363111)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363111)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=363111)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=363111)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363111)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=363111)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=363111)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363111)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=363111)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363111)[0;0m     )
[0;36m(EngineCore_DP0 pid=363111)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363111)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=363111)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=363111)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363111)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=363111)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=363111)[0;0m         config,
[0;36m(EngineCore_DP0 pid=363111)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=363111)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=363111)[0;0m     )
[0;36m(EngineCore_DP0 pid=363111)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=363111)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=363111)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363111)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=363111)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363111)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=363111)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=363111)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363111)[0;0m     )
[0;36m(EngineCore_DP0 pid=363111)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363111)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=363111)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=363111)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363111)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=363111)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363111)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=363111)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=363111)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363111)[0;0m     )
[0;36m(EngineCore_DP0 pid=363111)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363111)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=363111)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=363111)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363111)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=363111)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=363111)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363111)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=363111)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363111)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=363111)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=363111)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363111)[0;0m     ),
[0;36m(EngineCore_DP0 pid=363111)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363111)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=363111)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=363111)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=363176)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=363176)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=363176)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=363176)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=363176)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363176)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=363176)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=363176)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363176)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=363176)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=363176)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=363176)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=363176)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=363176)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=363176)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363176)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=363176)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363176)[0;0m     )
[0;36m(EngineCore_DP0 pid=363176)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363176)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=363176)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=363176)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363176)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=363176)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=363176)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363176)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=363176)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=363176)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363176)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=363176)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=363176)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363176)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=363176)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=363176)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363176)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=363176)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363176)[0;0m     )
[0;36m(EngineCore_DP0 pid=363176)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363176)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=363176)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=363176)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=363176)[0;0m     )
[0;36m(EngineCore_DP0 pid=363176)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=363176)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=363176)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=363176)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=363176)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363176)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=363176)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363176)[0;0m     )
[0;36m(EngineCore_DP0 pid=363176)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363176)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=363176)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=363176)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363176)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=363176)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=363176)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363176)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=363176)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363176)[0;0m     )
[0;36m(EngineCore_DP0 pid=363176)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363176)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=363176)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=363176)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363176)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=363176)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=363176)[0;0m         config,
[0;36m(EngineCore_DP0 pid=363176)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=363176)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=363176)[0;0m     )
[0;36m(EngineCore_DP0 pid=363176)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=363176)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=363176)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363176)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=363176)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363176)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=363176)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=363176)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363176)[0;0m     )
[0;36m(EngineCore_DP0 pid=363176)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363176)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=363176)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=363176)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363176)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=363176)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363176)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=363176)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=363176)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363176)[0;0m     )
[0;36m(EngineCore_DP0 pid=363176)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363176)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=363176)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=363176)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363176)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=363176)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=363176)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363176)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=363176)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363176)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=363176)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=363176)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363176)[0;0m     ),
[0;36m(EngineCore_DP0 pid=363176)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363176)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=363176)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=363176)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=363581)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=363581)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=363581)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=363581)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=363581)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363581)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=363581)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=363581)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363581)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=363581)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=363581)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=363581)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=363581)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=363581)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=363581)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363581)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=363581)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363581)[0;0m     )
[0;36m(EngineCore_DP0 pid=363581)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363581)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=363581)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=363581)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363581)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=363581)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=363581)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363581)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=363581)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=363581)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363581)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=363581)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=363581)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363581)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=363581)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=363581)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363581)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=363581)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363581)[0;0m     )
[0;36m(EngineCore_DP0 pid=363581)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363581)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=363581)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=363581)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=363581)[0;0m     )
[0;36m(EngineCore_DP0 pid=363581)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=363581)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=363581)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=363581)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=363581)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363581)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=363581)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363581)[0;0m     )
[0;36m(EngineCore_DP0 pid=363581)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363581)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=363581)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=363581)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363581)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=363581)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=363581)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363581)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=363581)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363581)[0;0m     )
[0;36m(EngineCore_DP0 pid=363581)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363581)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=363581)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=363581)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363581)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=363581)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=363581)[0;0m         config,
[0;36m(EngineCore_DP0 pid=363581)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=363581)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=363581)[0;0m     )
[0;36m(EngineCore_DP0 pid=363581)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=363581)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=363581)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363581)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=363581)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363581)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=363581)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=363581)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363581)[0;0m     )
[0;36m(EngineCore_DP0 pid=363581)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363581)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=363581)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=363581)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363581)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=363581)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363581)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=363581)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=363581)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363581)[0;0m     )
[0;36m(EngineCore_DP0 pid=363581)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363581)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=363581)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=363581)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363581)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=363581)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=363581)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363581)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=363581)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363581)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=363581)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=363581)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363581)[0;0m     ),
[0;36m(EngineCore_DP0 pid=363581)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363581)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=363581)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=363581)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=363643)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=363643)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=363643)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=363643)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=363643)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363643)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=363643)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=363643)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363643)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=363643)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=363643)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=363643)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=363643)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=363643)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=363643)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363643)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=363643)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363643)[0;0m     )
[0;36m(EngineCore_DP0 pid=363643)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363643)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=363643)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=363643)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363643)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=363643)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=363643)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363643)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=363643)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=363643)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363643)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=363643)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=363643)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363643)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=363643)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=363643)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363643)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=363643)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363643)[0;0m     )
[0;36m(EngineCore_DP0 pid=363643)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363643)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=363643)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=363643)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=363643)[0;0m     )
[0;36m(EngineCore_DP0 pid=363643)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=363643)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=363643)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=363643)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=363643)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363643)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=363643)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363643)[0;0m     )
[0;36m(EngineCore_DP0 pid=363643)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363643)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=363643)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=363643)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363643)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=363643)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=363643)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363643)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=363643)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363643)[0;0m     )
[0;36m(EngineCore_DP0 pid=363643)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363643)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=363643)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=363643)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363643)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=363643)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=363643)[0;0m         config,
[0;36m(EngineCore_DP0 pid=363643)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=363643)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=363643)[0;0m     )
[0;36m(EngineCore_DP0 pid=363643)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=363643)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=363643)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363643)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=363643)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363643)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=363643)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=363643)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363643)[0;0m     )
[0;36m(EngineCore_DP0 pid=363643)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363643)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=363643)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=363643)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363643)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=363643)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363643)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=363643)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=363643)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363643)[0;0m     )
[0;36m(EngineCore_DP0 pid=363643)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363643)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=363643)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=363643)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363643)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=363643)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=363643)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363643)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=363643)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363643)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=363643)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=363643)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363643)[0;0m     ),
[0;36m(EngineCore_DP0 pid=363643)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363643)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=363643)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=363643)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=363705)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=363705)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=363705)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=363705)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=363705)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363705)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=363705)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=363705)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363705)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=363705)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=363705)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=363705)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=363705)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=363705)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=363705)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363705)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=363705)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363705)[0;0m     )
[0;36m(EngineCore_DP0 pid=363705)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363705)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=363705)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=363705)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363705)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=363705)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=363705)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363705)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=363705)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=363705)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363705)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=363705)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=363705)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363705)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=363705)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=363705)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363705)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=363705)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363705)[0;0m     )
[0;36m(EngineCore_DP0 pid=363705)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363705)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=363705)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=363705)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=363705)[0;0m     )
[0;36m(EngineCore_DP0 pid=363705)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=363705)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=363705)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=363705)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=363705)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363705)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=363705)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363705)[0;0m     )
[0;36m(EngineCore_DP0 pid=363705)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363705)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=363705)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=363705)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363705)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=363705)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=363705)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363705)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=363705)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363705)[0;0m     )
[0;36m(EngineCore_DP0 pid=363705)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363705)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=363705)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=363705)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363705)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=363705)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=363705)[0;0m         config,
[0;36m(EngineCore_DP0 pid=363705)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=363705)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=363705)[0;0m     )
[0;36m(EngineCore_DP0 pid=363705)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=363705)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=363705)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363705)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=363705)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363705)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=363705)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=363705)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363705)[0;0m     )
[0;36m(EngineCore_DP0 pid=363705)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363705)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=363705)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=363705)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363705)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=363705)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363705)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=363705)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=363705)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363705)[0;0m     )
[0;36m(EngineCore_DP0 pid=363705)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363705)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=363705)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=363705)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363705)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=363705)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=363705)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363705)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=363705)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363705)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=363705)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=363705)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363705)[0;0m     ),
[0;36m(EngineCore_DP0 pid=363705)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363705)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=363705)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=363705)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=363767)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=363767)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=363767)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=363767)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=363767)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363767)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=363767)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=363767)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363767)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=363767)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=363767)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=363767)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=363767)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=363767)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=363767)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363767)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=363767)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363767)[0;0m     )
[0;36m(EngineCore_DP0 pid=363767)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363767)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=363767)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=363767)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363767)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=363767)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=363767)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363767)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=363767)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=363767)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363767)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=363767)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=363767)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363767)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=363767)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=363767)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363767)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=363767)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363767)[0;0m     )
[0;36m(EngineCore_DP0 pid=363767)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363767)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=363767)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=363767)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=363767)[0;0m     )
[0;36m(EngineCore_DP0 pid=363767)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=363767)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=363767)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=363767)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=363767)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363767)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=363767)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363767)[0;0m     )
[0;36m(EngineCore_DP0 pid=363767)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363767)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=363767)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=363767)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363767)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=363767)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=363767)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363767)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=363767)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363767)[0;0m     )
[0;36m(EngineCore_DP0 pid=363767)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363767)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=363767)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=363767)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363767)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=363767)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=363767)[0;0m         config,
[0;36m(EngineCore_DP0 pid=363767)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=363767)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=363767)[0;0m     )
[0;36m(EngineCore_DP0 pid=363767)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=363767)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=363767)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363767)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=363767)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363767)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=363767)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=363767)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363767)[0;0m     )
[0;36m(EngineCore_DP0 pid=363767)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363767)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=363767)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=363767)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363767)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=363767)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363767)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=363767)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=363767)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363767)[0;0m     )
[0;36m(EngineCore_DP0 pid=363767)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363767)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=363767)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=363767)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363767)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=363767)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=363767)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363767)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=363767)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363767)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=363767)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=363767)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363767)[0;0m     ),
[0;36m(EngineCore_DP0 pid=363767)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363767)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=363767)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=363767)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=363829)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=363829)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=363829)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=363829)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=363829)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363829)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=363829)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=363829)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363829)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=363829)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=363829)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=363829)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=363829)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=363829)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=363829)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363829)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=363829)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363829)[0;0m     )
[0;36m(EngineCore_DP0 pid=363829)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363829)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=363829)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=363829)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363829)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=363829)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=363829)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363829)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=363829)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=363829)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363829)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=363829)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=363829)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363829)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=363829)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=363829)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363829)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=363829)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363829)[0;0m     )
[0;36m(EngineCore_DP0 pid=363829)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363829)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=363829)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=363829)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=363829)[0;0m     )
[0;36m(EngineCore_DP0 pid=363829)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=363829)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=363829)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=363829)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=363829)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363829)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=363829)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363829)[0;0m     )
[0;36m(EngineCore_DP0 pid=363829)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363829)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=363829)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=363829)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363829)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=363829)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=363829)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363829)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=363829)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363829)[0;0m     )
[0;36m(EngineCore_DP0 pid=363829)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363829)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=363829)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=363829)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363829)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=363829)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=363829)[0;0m         config,
[0;36m(EngineCore_DP0 pid=363829)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=363829)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=363829)[0;0m     )
[0;36m(EngineCore_DP0 pid=363829)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=363829)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=363829)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363829)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=363829)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363829)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=363829)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=363829)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363829)[0;0m     )
[0;36m(EngineCore_DP0 pid=363829)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363829)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=363829)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=363829)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363829)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=363829)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363829)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=363829)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=363829)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363829)[0;0m     )
[0;36m(EngineCore_DP0 pid=363829)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363829)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=363829)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=363829)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363829)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=363829)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=363829)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363829)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=363829)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363829)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=363829)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=363829)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363829)[0;0m     ),
[0;36m(EngineCore_DP0 pid=363829)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363829)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=363829)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=363829)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=363891)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=363891)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=363891)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=363891)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=363891)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363891)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=363891)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=363891)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363891)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=363891)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=363891)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=363891)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=363891)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=363891)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=363891)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363891)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=363891)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363891)[0;0m     )
[0;36m(EngineCore_DP0 pid=363891)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363891)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=363891)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=363891)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363891)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=363891)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=363891)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363891)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=363891)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=363891)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=363891)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=363891)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=363891)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363891)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=363891)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=363891)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363891)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=363891)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363891)[0;0m     )
[0;36m(EngineCore_DP0 pid=363891)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363891)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=363891)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=363891)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=363891)[0;0m     )
[0;36m(EngineCore_DP0 pid=363891)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=363891)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=363891)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=363891)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=363891)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363891)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=363891)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363891)[0;0m     )
[0;36m(EngineCore_DP0 pid=363891)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363891)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=363891)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=363891)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363891)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=363891)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=363891)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363891)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=363891)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363891)[0;0m     )
[0;36m(EngineCore_DP0 pid=363891)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363891)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=363891)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=363891)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363891)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=363891)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=363891)[0;0m         config,
[0;36m(EngineCore_DP0 pid=363891)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=363891)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=363891)[0;0m     )
[0;36m(EngineCore_DP0 pid=363891)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=363891)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=363891)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363891)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=363891)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363891)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=363891)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=363891)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363891)[0;0m     )
[0;36m(EngineCore_DP0 pid=363891)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363891)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=363891)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=363891)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363891)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=363891)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363891)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=363891)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=363891)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363891)[0;0m     )
[0;36m(EngineCore_DP0 pid=363891)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363891)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=363891)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=363891)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363891)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=363891)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=363891)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=363891)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=363891)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363891)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=363891)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=363891)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=363891)[0;0m     ),
[0;36m(EngineCore_DP0 pid=363891)[0;0m     ^
[0;36m(EngineCore_DP0 pid=363891)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=363891)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=363891)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=364292)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=364292)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=364292)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=364292)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=364292)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=364292)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=364292)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=364292)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364292)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=364292)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=364292)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=364292)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=364292)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=364292)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=364292)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364292)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=364292)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364292)[0;0m     )
[0;36m(EngineCore_DP0 pid=364292)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364292)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=364292)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=364292)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364292)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=364292)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=364292)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=364292)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=364292)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=364292)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=364292)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=364292)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=364292)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364292)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=364292)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=364292)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364292)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=364292)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364292)[0;0m     )
[0;36m(EngineCore_DP0 pid=364292)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364292)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=364292)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=364292)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=364292)[0;0m     )
[0;36m(EngineCore_DP0 pid=364292)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=364292)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=364292)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=364292)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=364292)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364292)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=364292)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364292)[0;0m     )
[0;36m(EngineCore_DP0 pid=364292)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364292)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=364292)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=364292)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364292)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=364292)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=364292)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364292)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=364292)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364292)[0;0m     )
[0;36m(EngineCore_DP0 pid=364292)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364292)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=364292)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=364292)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364292)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=364292)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=364292)[0;0m         config,
[0;36m(EngineCore_DP0 pid=364292)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=364292)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=364292)[0;0m     )
[0;36m(EngineCore_DP0 pid=364292)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=364292)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=364292)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364292)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=364292)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364292)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=364292)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=364292)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364292)[0;0m     )
[0;36m(EngineCore_DP0 pid=364292)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364292)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=364292)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=364292)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364292)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=364292)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364292)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=364292)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=364292)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364292)[0;0m     )
[0;36m(EngineCore_DP0 pid=364292)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364292)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=364292)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=364292)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364292)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=364292)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=364292)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364292)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=364292)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364292)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=364292)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=364292)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364292)[0;0m     ),
[0;36m(EngineCore_DP0 pid=364292)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364292)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=364292)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=364292)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=364358)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=364358)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=364358)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=364358)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=364358)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=364358)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=364358)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=364358)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=364358)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=364358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=364358)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=364358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=364358)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=364358)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364358)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=364358)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364358)[0;0m     )
[0;36m(EngineCore_DP0 pid=364358)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=364358)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=364358)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=364358)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=364358)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=364358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=364358)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=364358)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=364358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=364358)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=364358)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=364358)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=364358)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364358)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=364358)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364358)[0;0m     )
[0;36m(EngineCore_DP0 pid=364358)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=364358)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=364358)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=364358)[0;0m     )
[0;36m(EngineCore_DP0 pid=364358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=364358)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=364358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=364358)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=364358)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364358)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=364358)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364358)[0;0m     )
[0;36m(EngineCore_DP0 pid=364358)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=364358)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=364358)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=364358)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=364358)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364358)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=364358)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364358)[0;0m     )
[0;36m(EngineCore_DP0 pid=364358)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=364358)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=364358)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=364358)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=364358)[0;0m         config,
[0;36m(EngineCore_DP0 pid=364358)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=364358)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=364358)[0;0m     )
[0;36m(EngineCore_DP0 pid=364358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=364358)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=364358)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364358)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=364358)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364358)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=364358)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=364358)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364358)[0;0m     )
[0;36m(EngineCore_DP0 pid=364358)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=364358)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=364358)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364358)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=364358)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364358)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=364358)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=364358)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364358)[0;0m     )
[0;36m(EngineCore_DP0 pid=364358)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=364358)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=364358)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=364358)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=364358)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364358)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=364358)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364358)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=364358)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=364358)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364358)[0;0m     ),
[0;36m(EngineCore_DP0 pid=364358)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364358)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=364358)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=364358)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=364421)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=364421)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=364421)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=364421)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=364421)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=364421)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=364421)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=364421)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364421)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=364421)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=364421)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=364421)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=364421)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=364421)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=364421)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364421)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=364421)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364421)[0;0m     )
[0;36m(EngineCore_DP0 pid=364421)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364421)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=364421)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=364421)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364421)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=364421)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=364421)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=364421)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=364421)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=364421)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=364421)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=364421)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=364421)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364421)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=364421)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=364421)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364421)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=364421)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364421)[0;0m     )
[0;36m(EngineCore_DP0 pid=364421)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364421)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=364421)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=364421)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=364421)[0;0m     )
[0;36m(EngineCore_DP0 pid=364421)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=364421)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=364421)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=364421)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=364421)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364421)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=364421)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364421)[0;0m     )
[0;36m(EngineCore_DP0 pid=364421)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364421)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=364421)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=364421)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364421)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=364421)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=364421)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364421)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=364421)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364421)[0;0m     )
[0;36m(EngineCore_DP0 pid=364421)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364421)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=364421)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=364421)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364421)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=364421)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=364421)[0;0m         config,
[0;36m(EngineCore_DP0 pid=364421)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=364421)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=364421)[0;0m     )
[0;36m(EngineCore_DP0 pid=364421)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=364421)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=364421)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364421)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=364421)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364421)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=364421)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=364421)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364421)[0;0m     )
[0;36m(EngineCore_DP0 pid=364421)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364421)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=364421)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=364421)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364421)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=364421)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364421)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=364421)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=364421)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364421)[0;0m     )
[0;36m(EngineCore_DP0 pid=364421)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364421)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=364421)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=364421)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364421)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=364421)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=364421)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364421)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=364421)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364421)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=364421)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=364421)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364421)[0;0m     ),
[0;36m(EngineCore_DP0 pid=364421)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364421)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=364421)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=364421)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=364483)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=364483)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=364483)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=364483)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=364483)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=364483)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=364483)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=364483)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364483)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=364483)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=364483)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=364483)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=364483)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=364483)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=364483)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364483)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=364483)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364483)[0;0m     )
[0;36m(EngineCore_DP0 pid=364483)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364483)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=364483)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=364483)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364483)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=364483)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=364483)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=364483)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=364483)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=364483)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=364483)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=364483)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=364483)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364483)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=364483)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=364483)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364483)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=364483)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364483)[0;0m     )
[0;36m(EngineCore_DP0 pid=364483)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364483)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=364483)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=364483)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=364483)[0;0m     )
[0;36m(EngineCore_DP0 pid=364483)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=364483)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=364483)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=364483)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=364483)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364483)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=364483)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364483)[0;0m     )
[0;36m(EngineCore_DP0 pid=364483)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364483)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=364483)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=364483)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364483)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=364483)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=364483)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364483)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=364483)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364483)[0;0m     )
[0;36m(EngineCore_DP0 pid=364483)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364483)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=364483)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=364483)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364483)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=364483)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=364483)[0;0m         config,
[0;36m(EngineCore_DP0 pid=364483)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=364483)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=364483)[0;0m     )
[0;36m(EngineCore_DP0 pid=364483)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=364483)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=364483)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364483)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=364483)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364483)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=364483)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=364483)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364483)[0;0m     )
[0;36m(EngineCore_DP0 pid=364483)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364483)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=364483)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=364483)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364483)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=364483)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364483)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=364483)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=364483)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364483)[0;0m     )
[0;36m(EngineCore_DP0 pid=364483)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364483)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=364483)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=364483)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364483)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=364483)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=364483)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364483)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=364483)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364483)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=364483)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=364483)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364483)[0;0m     ),
[0;36m(EngineCore_DP0 pid=364483)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364483)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=364483)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=364483)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=364545)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=364545)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=364545)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=364545)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=364545)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=364545)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=364545)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=364545)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364545)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=364545)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=364545)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=364545)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=364545)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=364545)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=364545)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364545)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=364545)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364545)[0;0m     )
[0;36m(EngineCore_DP0 pid=364545)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364545)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=364545)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=364545)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364545)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=364545)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=364545)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=364545)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=364545)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=364545)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=364545)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=364545)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=364545)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364545)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=364545)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=364545)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364545)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=364545)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364545)[0;0m     )
[0;36m(EngineCore_DP0 pid=364545)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364545)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=364545)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=364545)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=364545)[0;0m     )
[0;36m(EngineCore_DP0 pid=364545)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=364545)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=364545)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=364545)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=364545)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364545)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=364545)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364545)[0;0m     )
[0;36m(EngineCore_DP0 pid=364545)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364545)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=364545)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=364545)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364545)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=364545)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=364545)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364545)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=364545)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364545)[0;0m     )
[0;36m(EngineCore_DP0 pid=364545)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364545)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=364545)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=364545)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364545)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=364545)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=364545)[0;0m         config,
[0;36m(EngineCore_DP0 pid=364545)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=364545)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=364545)[0;0m     )
[0;36m(EngineCore_DP0 pid=364545)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=364545)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=364545)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364545)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=364545)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364545)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=364545)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=364545)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364545)[0;0m     )
[0;36m(EngineCore_DP0 pid=364545)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364545)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=364545)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=364545)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364545)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=364545)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364545)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=364545)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=364545)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364545)[0;0m     )
[0;36m(EngineCore_DP0 pid=364545)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364545)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=364545)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=364545)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364545)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=364545)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=364545)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364545)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=364545)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364545)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=364545)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=364545)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364545)[0;0m     ),
[0;36m(EngineCore_DP0 pid=364545)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364545)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=364545)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=364545)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=364607)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=364607)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=364607)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=364607)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=364607)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=364607)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=364607)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=364607)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364607)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=364607)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=364607)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=364607)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=364607)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=364607)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=364607)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364607)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=364607)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364607)[0;0m     )
[0;36m(EngineCore_DP0 pid=364607)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364607)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=364607)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=364607)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364607)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=364607)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=364607)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=364607)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=364607)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=364607)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=364607)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=364607)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=364607)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364607)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=364607)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=364607)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364607)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=364607)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364607)[0;0m     )
[0;36m(EngineCore_DP0 pid=364607)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364607)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=364607)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=364607)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=364607)[0;0m     )
[0;36m(EngineCore_DP0 pid=364607)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=364607)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=364607)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=364607)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=364607)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364607)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=364607)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364607)[0;0m     )
[0;36m(EngineCore_DP0 pid=364607)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364607)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=364607)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=364607)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364607)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=364607)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=364607)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364607)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=364607)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364607)[0;0m     )
[0;36m(EngineCore_DP0 pid=364607)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364607)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=364607)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=364607)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364607)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=364607)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=364607)[0;0m         config,
[0;36m(EngineCore_DP0 pid=364607)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=364607)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=364607)[0;0m     )
[0;36m(EngineCore_DP0 pid=364607)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=364607)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=364607)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364607)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=364607)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364607)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=364607)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=364607)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364607)[0;0m     )
[0;36m(EngineCore_DP0 pid=364607)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364607)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=364607)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=364607)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364607)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=364607)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364607)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=364607)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=364607)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364607)[0;0m     )
[0;36m(EngineCore_DP0 pid=364607)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364607)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=364607)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=364607)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364607)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=364607)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=364607)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364607)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=364607)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364607)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=364607)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=364607)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364607)[0;0m     ),
[0;36m(EngineCore_DP0 pid=364607)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364607)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=364607)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=364607)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=364669)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=364669)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=364669)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=364669)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=364669)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=364669)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=364669)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=364669)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364669)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=364669)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=364669)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=364669)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=364669)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=364669)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=364669)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364669)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=364669)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364669)[0;0m     )
[0;36m(EngineCore_DP0 pid=364669)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364669)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=364669)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=364669)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364669)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=364669)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=364669)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=364669)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=364669)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=364669)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=364669)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=364669)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=364669)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364669)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=364669)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=364669)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364669)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=364669)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364669)[0;0m     )
[0;36m(EngineCore_DP0 pid=364669)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364669)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=364669)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=364669)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=364669)[0;0m     )
[0;36m(EngineCore_DP0 pid=364669)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=364669)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=364669)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=364669)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=364669)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364669)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=364669)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364669)[0;0m     )
[0;36m(EngineCore_DP0 pid=364669)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364669)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=364669)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=364669)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364669)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=364669)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=364669)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364669)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=364669)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364669)[0;0m     )
[0;36m(EngineCore_DP0 pid=364669)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364669)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=364669)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=364669)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364669)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=364669)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=364669)[0;0m         config,
[0;36m(EngineCore_DP0 pid=364669)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=364669)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=364669)[0;0m     )
[0;36m(EngineCore_DP0 pid=364669)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=364669)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=364669)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364669)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=364669)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364669)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=364669)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=364669)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364669)[0;0m     )
[0;36m(EngineCore_DP0 pid=364669)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364669)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=364669)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=364669)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364669)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=364669)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364669)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=364669)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=364669)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364669)[0;0m     )
[0;36m(EngineCore_DP0 pid=364669)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364669)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=364669)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=364669)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364669)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=364669)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=364669)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364669)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=364669)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364669)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=364669)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=364669)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364669)[0;0m     ),
[0;36m(EngineCore_DP0 pid=364669)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364669)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=364669)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=364669)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=364731)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=364731)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=364731)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=364731)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=364731)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=364731)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=364731)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=364731)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364731)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=364731)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=364731)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=364731)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=364731)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=364731)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=364731)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364731)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=364731)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364731)[0;0m     )
[0;36m(EngineCore_DP0 pid=364731)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364731)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=364731)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=364731)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364731)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=364731)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=364731)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=364731)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=364731)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=364731)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=364731)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=364731)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=364731)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364731)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=364731)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=364731)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364731)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=364731)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364731)[0;0m     )
[0;36m(EngineCore_DP0 pid=364731)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364731)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=364731)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=364731)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=364731)[0;0m     )
[0;36m(EngineCore_DP0 pid=364731)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=364731)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=364731)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=364731)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=364731)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364731)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=364731)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364731)[0;0m     )
[0;36m(EngineCore_DP0 pid=364731)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364731)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=364731)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=364731)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364731)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=364731)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=364731)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364731)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=364731)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364731)[0;0m     )
[0;36m(EngineCore_DP0 pid=364731)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364731)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=364731)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=364731)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364731)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=364731)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=364731)[0;0m         config,
[0;36m(EngineCore_DP0 pid=364731)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=364731)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=364731)[0;0m     )
[0;36m(EngineCore_DP0 pid=364731)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=364731)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=364731)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364731)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=364731)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364731)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=364731)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=364731)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364731)[0;0m     )
[0;36m(EngineCore_DP0 pid=364731)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364731)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=364731)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=364731)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364731)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=364731)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364731)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=364731)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=364731)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364731)[0;0m     )
[0;36m(EngineCore_DP0 pid=364731)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364731)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=364731)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=364731)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364731)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=364731)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=364731)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=364731)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=364731)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364731)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=364731)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=364731)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=364731)[0;0m     ),
[0;36m(EngineCore_DP0 pid=364731)[0;0m     ^
[0;36m(EngineCore_DP0 pid=364731)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=364731)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=364731)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=365136)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=365136)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=365136)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=365136)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=365136)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365136)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=365136)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=365136)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365136)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=365136)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=365136)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=365136)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=365136)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=365136)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=365136)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365136)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=365136)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365136)[0;0m     )
[0;36m(EngineCore_DP0 pid=365136)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365136)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=365136)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=365136)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365136)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=365136)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=365136)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365136)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=365136)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=365136)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365136)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=365136)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=365136)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365136)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=365136)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=365136)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365136)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=365136)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365136)[0;0m     )
[0;36m(EngineCore_DP0 pid=365136)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365136)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=365136)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=365136)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=365136)[0;0m     )
[0;36m(EngineCore_DP0 pid=365136)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=365136)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=365136)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=365136)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=365136)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365136)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=365136)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365136)[0;0m     )
[0;36m(EngineCore_DP0 pid=365136)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365136)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=365136)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=365136)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365136)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=365136)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=365136)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365136)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=365136)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365136)[0;0m     )
[0;36m(EngineCore_DP0 pid=365136)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365136)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=365136)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=365136)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365136)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=365136)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=365136)[0;0m         config,
[0;36m(EngineCore_DP0 pid=365136)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=365136)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=365136)[0;0m     )
[0;36m(EngineCore_DP0 pid=365136)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=365136)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=365136)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365136)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=365136)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365136)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=365136)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=365136)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365136)[0;0m     )
[0;36m(EngineCore_DP0 pid=365136)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365136)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=365136)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=365136)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365136)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=365136)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365136)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=365136)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=365136)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365136)[0;0m     )
[0;36m(EngineCore_DP0 pid=365136)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365136)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=365136)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=365136)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365136)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=365136)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=365136)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365136)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=365136)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365136)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=365136)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=365136)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365136)[0;0m     ),
[0;36m(EngineCore_DP0 pid=365136)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365136)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=365136)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=365136)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=365199)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=365199)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=365199)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=365199)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=365199)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365199)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=365199)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=365199)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365199)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=365199)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=365199)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=365199)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=365199)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=365199)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=365199)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365199)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=365199)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365199)[0;0m     )
[0;36m(EngineCore_DP0 pid=365199)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365199)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=365199)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=365199)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365199)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=365199)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=365199)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365199)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=365199)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=365199)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365199)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=365199)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=365199)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365199)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=365199)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=365199)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365199)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=365199)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365199)[0;0m     )
[0;36m(EngineCore_DP0 pid=365199)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365199)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=365199)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=365199)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=365199)[0;0m     )
[0;36m(EngineCore_DP0 pid=365199)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=365199)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=365199)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=365199)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=365199)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365199)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=365199)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365199)[0;0m     )
[0;36m(EngineCore_DP0 pid=365199)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365199)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=365199)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=365199)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365199)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=365199)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=365199)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365199)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=365199)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365199)[0;0m     )
[0;36m(EngineCore_DP0 pid=365199)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365199)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=365199)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=365199)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365199)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=365199)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=365199)[0;0m         config,
[0;36m(EngineCore_DP0 pid=365199)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=365199)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=365199)[0;0m     )
[0;36m(EngineCore_DP0 pid=365199)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=365199)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=365199)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365199)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=365199)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365199)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=365199)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=365199)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365199)[0;0m     )
[0;36m(EngineCore_DP0 pid=365199)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365199)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=365199)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=365199)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365199)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=365199)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365199)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=365199)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=365199)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365199)[0;0m     )
[0;36m(EngineCore_DP0 pid=365199)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365199)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=365199)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=365199)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365199)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=365199)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=365199)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365199)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=365199)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365199)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=365199)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=365199)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365199)[0;0m     ),
[0;36m(EngineCore_DP0 pid=365199)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365199)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=365199)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=365199)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=365261)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=365261)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=365261)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=365261)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=365261)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365261)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=365261)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=365261)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365261)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=365261)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=365261)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=365261)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=365261)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=365261)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=365261)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365261)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=365261)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365261)[0;0m     )
[0;36m(EngineCore_DP0 pid=365261)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365261)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=365261)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=365261)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365261)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=365261)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=365261)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365261)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=365261)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=365261)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365261)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=365261)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=365261)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365261)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=365261)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=365261)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365261)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=365261)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365261)[0;0m     )
[0;36m(EngineCore_DP0 pid=365261)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365261)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=365261)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=365261)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=365261)[0;0m     )
[0;36m(EngineCore_DP0 pid=365261)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=365261)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=365261)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=365261)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=365261)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365261)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=365261)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365261)[0;0m     )
[0;36m(EngineCore_DP0 pid=365261)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365261)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=365261)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=365261)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365261)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=365261)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=365261)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365261)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=365261)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365261)[0;0m     )
[0;36m(EngineCore_DP0 pid=365261)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365261)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=365261)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=365261)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365261)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=365261)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=365261)[0;0m         config,
[0;36m(EngineCore_DP0 pid=365261)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=365261)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=365261)[0;0m     )
[0;36m(EngineCore_DP0 pid=365261)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=365261)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=365261)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365261)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=365261)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365261)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=365261)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=365261)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365261)[0;0m     )
[0;36m(EngineCore_DP0 pid=365261)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365261)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=365261)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=365261)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365261)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=365261)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365261)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=365261)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=365261)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365261)[0;0m     )
[0;36m(EngineCore_DP0 pid=365261)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365261)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=365261)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=365261)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365261)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=365261)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=365261)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365261)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=365261)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365261)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=365261)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=365261)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365261)[0;0m     ),
[0;36m(EngineCore_DP0 pid=365261)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365261)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=365261)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=365261)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=365323)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=365323)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=365323)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=365323)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=365323)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365323)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=365323)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=365323)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365323)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=365323)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=365323)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=365323)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=365323)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=365323)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=365323)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365323)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=365323)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365323)[0;0m     )
[0;36m(EngineCore_DP0 pid=365323)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365323)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=365323)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=365323)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365323)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=365323)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=365323)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365323)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=365323)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=365323)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365323)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=365323)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=365323)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365323)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=365323)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=365323)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365323)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=365323)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365323)[0;0m     )
[0;36m(EngineCore_DP0 pid=365323)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365323)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=365323)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=365323)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=365323)[0;0m     )
[0;36m(EngineCore_DP0 pid=365323)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=365323)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=365323)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=365323)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=365323)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365323)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=365323)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365323)[0;0m     )
[0;36m(EngineCore_DP0 pid=365323)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365323)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=365323)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=365323)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365323)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=365323)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=365323)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365323)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=365323)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365323)[0;0m     )
[0;36m(EngineCore_DP0 pid=365323)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365323)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=365323)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=365323)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365323)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=365323)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=365323)[0;0m         config,
[0;36m(EngineCore_DP0 pid=365323)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=365323)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=365323)[0;0m     )
[0;36m(EngineCore_DP0 pid=365323)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=365323)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=365323)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365323)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=365323)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365323)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=365323)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=365323)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365323)[0;0m     )
[0;36m(EngineCore_DP0 pid=365323)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365323)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=365323)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=365323)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365323)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=365323)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365323)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=365323)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=365323)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365323)[0;0m     )
[0;36m(EngineCore_DP0 pid=365323)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365323)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=365323)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=365323)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365323)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=365323)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=365323)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365323)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=365323)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365323)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=365323)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=365323)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365323)[0;0m     ),
[0;36m(EngineCore_DP0 pid=365323)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365323)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=365323)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=365323)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=365385)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=365385)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=365385)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=365385)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=365385)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365385)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=365385)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=365385)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365385)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=365385)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=365385)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=365385)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=365385)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=365385)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=365385)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365385)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=365385)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365385)[0;0m     )
[0;36m(EngineCore_DP0 pid=365385)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365385)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=365385)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=365385)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365385)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=365385)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=365385)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365385)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=365385)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=365385)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365385)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=365385)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=365385)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365385)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=365385)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=365385)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365385)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=365385)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365385)[0;0m     )
[0;36m(EngineCore_DP0 pid=365385)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365385)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=365385)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=365385)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=365385)[0;0m     )
[0;36m(EngineCore_DP0 pid=365385)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=365385)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=365385)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=365385)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=365385)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365385)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=365385)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365385)[0;0m     )
[0;36m(EngineCore_DP0 pid=365385)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365385)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=365385)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=365385)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365385)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=365385)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=365385)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365385)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=365385)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365385)[0;0m     )
[0;36m(EngineCore_DP0 pid=365385)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365385)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=365385)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=365385)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365385)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=365385)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=365385)[0;0m         config,
[0;36m(EngineCore_DP0 pid=365385)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=365385)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=365385)[0;0m     )
[0;36m(EngineCore_DP0 pid=365385)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=365385)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=365385)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365385)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=365385)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365385)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=365385)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=365385)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365385)[0;0m     )
[0;36m(EngineCore_DP0 pid=365385)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365385)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=365385)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=365385)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365385)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=365385)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365385)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=365385)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=365385)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365385)[0;0m     )
[0;36m(EngineCore_DP0 pid=365385)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365385)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=365385)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=365385)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365385)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=365385)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=365385)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365385)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=365385)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365385)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=365385)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=365385)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365385)[0;0m     ),
[0;36m(EngineCore_DP0 pid=365385)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365385)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=365385)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=365385)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=365447)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=365447)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=365447)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=365447)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=365447)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365447)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=365447)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=365447)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365447)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=365447)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=365447)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=365447)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=365447)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=365447)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=365447)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365447)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=365447)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365447)[0;0m     )
[0;36m(EngineCore_DP0 pid=365447)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365447)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=365447)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=365447)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365447)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=365447)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=365447)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365447)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=365447)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=365447)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365447)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=365447)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=365447)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365447)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=365447)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=365447)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365447)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=365447)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365447)[0;0m     )
[0;36m(EngineCore_DP0 pid=365447)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365447)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=365447)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=365447)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=365447)[0;0m     )
[0;36m(EngineCore_DP0 pid=365447)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=365447)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=365447)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=365447)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=365447)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365447)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=365447)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365447)[0;0m     )
[0;36m(EngineCore_DP0 pid=365447)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365447)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=365447)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=365447)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365447)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=365447)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=365447)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365447)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=365447)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365447)[0;0m     )
[0;36m(EngineCore_DP0 pid=365447)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365447)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=365447)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=365447)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365447)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=365447)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=365447)[0;0m         config,
[0;36m(EngineCore_DP0 pid=365447)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=365447)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=365447)[0;0m     )
[0;36m(EngineCore_DP0 pid=365447)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=365447)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=365447)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365447)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=365447)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365447)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=365447)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=365447)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365447)[0;0m     )
[0;36m(EngineCore_DP0 pid=365447)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365447)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=365447)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=365447)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365447)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=365447)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365447)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=365447)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=365447)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365447)[0;0m     )
[0;36m(EngineCore_DP0 pid=365447)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365447)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=365447)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=365447)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365447)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=365447)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=365447)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365447)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=365447)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365447)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=365447)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=365447)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365447)[0;0m     ),
[0;36m(EngineCore_DP0 pid=365447)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365447)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=365447)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=365447)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=365509)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=365509)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=365509)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=365509)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=365509)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365509)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=365509)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=365509)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365509)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=365509)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=365509)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=365509)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=365509)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=365509)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=365509)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365509)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=365509)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365509)[0;0m     )
[0;36m(EngineCore_DP0 pid=365509)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365509)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=365509)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=365509)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365509)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=365509)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=365509)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365509)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=365509)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=365509)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365509)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=365509)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=365509)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365509)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=365509)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=365509)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365509)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=365509)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365509)[0;0m     )
[0;36m(EngineCore_DP0 pid=365509)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365509)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=365509)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=365509)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=365509)[0;0m     )
[0;36m(EngineCore_DP0 pid=365509)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=365509)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=365509)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=365509)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=365509)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365509)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=365509)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365509)[0;0m     )
[0;36m(EngineCore_DP0 pid=365509)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365509)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=365509)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=365509)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365509)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=365509)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=365509)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365509)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=365509)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365509)[0;0m     )
[0;36m(EngineCore_DP0 pid=365509)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365509)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=365509)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=365509)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365509)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=365509)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=365509)[0;0m         config,
[0;36m(EngineCore_DP0 pid=365509)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=365509)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=365509)[0;0m     )
[0;36m(EngineCore_DP0 pid=365509)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=365509)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=365509)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365509)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=365509)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365509)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=365509)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=365509)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365509)[0;0m     )
[0;36m(EngineCore_DP0 pid=365509)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365509)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=365509)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=365509)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365509)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=365509)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365509)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=365509)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=365509)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365509)[0;0m     )
[0;36m(EngineCore_DP0 pid=365509)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365509)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=365509)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=365509)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365509)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=365509)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=365509)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365509)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=365509)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365509)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=365509)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=365509)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365509)[0;0m     ),
[0;36m(EngineCore_DP0 pid=365509)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365509)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=365509)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=365509)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=365571)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=365571)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=365571)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=365571)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=365571)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365571)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=365571)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=365571)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365571)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=365571)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=365571)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=365571)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=365571)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=365571)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=365571)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365571)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=365571)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365571)[0;0m     )
[0;36m(EngineCore_DP0 pid=365571)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365571)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=365571)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=365571)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365571)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=365571)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=365571)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365571)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=365571)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=365571)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365571)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=365571)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=365571)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365571)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=365571)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=365571)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365571)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=365571)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365571)[0;0m     )
[0;36m(EngineCore_DP0 pid=365571)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365571)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=365571)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=365571)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=365571)[0;0m     )
[0;36m(EngineCore_DP0 pid=365571)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=365571)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=365571)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=365571)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=365571)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365571)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=365571)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365571)[0;0m     )
[0;36m(EngineCore_DP0 pid=365571)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365571)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=365571)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=365571)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365571)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=365571)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=365571)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365571)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=365571)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365571)[0;0m     )
[0;36m(EngineCore_DP0 pid=365571)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365571)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=365571)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=365571)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365571)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=365571)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=365571)[0;0m         config,
[0;36m(EngineCore_DP0 pid=365571)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=365571)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=365571)[0;0m     )
[0;36m(EngineCore_DP0 pid=365571)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=365571)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=365571)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365571)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=365571)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365571)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=365571)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=365571)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365571)[0;0m     )
[0;36m(EngineCore_DP0 pid=365571)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365571)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=365571)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=365571)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365571)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=365571)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365571)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=365571)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=365571)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365571)[0;0m     )
[0;36m(EngineCore_DP0 pid=365571)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365571)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=365571)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=365571)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365571)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=365571)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=365571)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365571)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=365571)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365571)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=365571)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=365571)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365571)[0;0m     ),
[0;36m(EngineCore_DP0 pid=365571)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365571)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=365571)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=365571)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=365633)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=365633)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=365633)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=365633)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=365633)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365633)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=365633)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=365633)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365633)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=365633)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=365633)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=365633)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=365633)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=365633)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=365633)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365633)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=365633)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365633)[0;0m     )
[0;36m(EngineCore_DP0 pid=365633)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365633)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=365633)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=365633)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365633)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=365633)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=365633)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365633)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=365633)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=365633)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=365633)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=365633)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=365633)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365633)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=365633)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=365633)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365633)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=365633)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365633)[0;0m     )
[0;36m(EngineCore_DP0 pid=365633)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365633)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=365633)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=365633)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=365633)[0;0m     )
[0;36m(EngineCore_DP0 pid=365633)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=365633)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=365633)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=365633)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=365633)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365633)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=365633)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365633)[0;0m     )
[0;36m(EngineCore_DP0 pid=365633)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365633)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=365633)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=365633)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365633)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=365633)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=365633)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365633)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=365633)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365633)[0;0m     )
[0;36m(EngineCore_DP0 pid=365633)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365633)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=365633)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=365633)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365633)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=365633)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=365633)[0;0m         config,
[0;36m(EngineCore_DP0 pid=365633)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=365633)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=365633)[0;0m     )
[0;36m(EngineCore_DP0 pid=365633)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=365633)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=365633)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365633)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=365633)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365633)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=365633)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=365633)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365633)[0;0m     )
[0;36m(EngineCore_DP0 pid=365633)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365633)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=365633)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=365633)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365633)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=365633)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365633)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=365633)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=365633)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365633)[0;0m     )
[0;36m(EngineCore_DP0 pid=365633)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365633)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=365633)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=365633)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365633)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=365633)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=365633)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=365633)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=365633)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365633)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=365633)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=365633)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=365633)[0;0m     ),
[0;36m(EngineCore_DP0 pid=365633)[0;0m     ^
[0;36m(EngineCore_DP0 pid=365633)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=365633)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=365633)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=366041)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=366041)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=366041)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=366041)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=366041)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366041)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=366041)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=366041)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366041)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=366041)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=366041)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=366041)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=366041)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=366041)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=366041)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366041)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=366041)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366041)[0;0m     )
[0;36m(EngineCore_DP0 pid=366041)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366041)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=366041)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=366041)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366041)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=366041)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=366041)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366041)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=366041)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=366041)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366041)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=366041)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=366041)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366041)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=366041)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=366041)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366041)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=366041)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366041)[0;0m     )
[0;36m(EngineCore_DP0 pid=366041)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366041)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=366041)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=366041)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=366041)[0;0m     )
[0;36m(EngineCore_DP0 pid=366041)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=366041)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=366041)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=366041)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=366041)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366041)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=366041)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366041)[0;0m     )
[0;36m(EngineCore_DP0 pid=366041)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366041)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=366041)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=366041)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366041)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=366041)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=366041)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366041)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=366041)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366041)[0;0m     )
[0;36m(EngineCore_DP0 pid=366041)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366041)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=366041)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=366041)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366041)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=366041)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=366041)[0;0m         config,
[0;36m(EngineCore_DP0 pid=366041)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=366041)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=366041)[0;0m     )
[0;36m(EngineCore_DP0 pid=366041)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=366041)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=366041)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366041)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=366041)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366041)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=366041)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=366041)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366041)[0;0m     )
[0;36m(EngineCore_DP0 pid=366041)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366041)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=366041)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=366041)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366041)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=366041)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366041)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=366041)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=366041)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366041)[0;0m     )
[0;36m(EngineCore_DP0 pid=366041)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366041)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=366041)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=366041)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366041)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=366041)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=366041)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366041)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=366041)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366041)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=366041)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=366041)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366041)[0;0m     ),
[0;36m(EngineCore_DP0 pid=366041)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366041)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=366041)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=366041)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=366103)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=366103)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=366103)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=366103)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=366103)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366103)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=366103)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=366103)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366103)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=366103)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=366103)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=366103)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=366103)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=366103)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=366103)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366103)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=366103)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366103)[0;0m     )
[0;36m(EngineCore_DP0 pid=366103)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366103)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=366103)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=366103)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366103)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=366103)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=366103)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366103)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=366103)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=366103)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366103)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=366103)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=366103)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366103)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=366103)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=366103)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366103)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=366103)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366103)[0;0m     )
[0;36m(EngineCore_DP0 pid=366103)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366103)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=366103)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=366103)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=366103)[0;0m     )
[0;36m(EngineCore_DP0 pid=366103)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=366103)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=366103)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=366103)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=366103)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366103)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=366103)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366103)[0;0m     )
[0;36m(EngineCore_DP0 pid=366103)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366103)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=366103)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=366103)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366103)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=366103)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=366103)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366103)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=366103)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366103)[0;0m     )
[0;36m(EngineCore_DP0 pid=366103)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366103)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=366103)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=366103)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366103)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=366103)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=366103)[0;0m         config,
[0;36m(EngineCore_DP0 pid=366103)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=366103)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=366103)[0;0m     )
[0;36m(EngineCore_DP0 pid=366103)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=366103)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=366103)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366103)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=366103)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366103)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=366103)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=366103)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366103)[0;0m     )
[0;36m(EngineCore_DP0 pid=366103)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366103)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=366103)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=366103)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366103)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=366103)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366103)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=366103)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=366103)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366103)[0;0m     )
[0;36m(EngineCore_DP0 pid=366103)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366103)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=366103)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=366103)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366103)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=366103)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=366103)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366103)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=366103)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366103)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=366103)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=366103)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366103)[0;0m     ),
[0;36m(EngineCore_DP0 pid=366103)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366103)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=366103)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=366103)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=366165)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=366165)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=366165)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=366165)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=366165)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366165)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=366165)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=366165)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366165)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=366165)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=366165)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=366165)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=366165)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=366165)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=366165)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366165)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=366165)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366165)[0;0m     )
[0;36m(EngineCore_DP0 pid=366165)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366165)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=366165)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=366165)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366165)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=366165)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=366165)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366165)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=366165)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=366165)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366165)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=366165)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=366165)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366165)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=366165)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=366165)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366165)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=366165)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366165)[0;0m     )
[0;36m(EngineCore_DP0 pid=366165)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366165)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=366165)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=366165)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=366165)[0;0m     )
[0;36m(EngineCore_DP0 pid=366165)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=366165)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=366165)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=366165)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=366165)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366165)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=366165)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366165)[0;0m     )
[0;36m(EngineCore_DP0 pid=366165)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366165)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=366165)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=366165)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366165)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=366165)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=366165)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366165)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=366165)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366165)[0;0m     )
[0;36m(EngineCore_DP0 pid=366165)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366165)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=366165)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=366165)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366165)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=366165)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=366165)[0;0m         config,
[0;36m(EngineCore_DP0 pid=366165)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=366165)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=366165)[0;0m     )
[0;36m(EngineCore_DP0 pid=366165)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=366165)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=366165)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366165)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=366165)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366165)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=366165)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=366165)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366165)[0;0m     )
[0;36m(EngineCore_DP0 pid=366165)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366165)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=366165)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=366165)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366165)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=366165)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366165)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=366165)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=366165)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366165)[0;0m     )
[0;36m(EngineCore_DP0 pid=366165)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366165)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=366165)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=366165)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366165)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=366165)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=366165)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366165)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=366165)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366165)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=366165)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=366165)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366165)[0;0m     ),
[0;36m(EngineCore_DP0 pid=366165)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366165)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=366165)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=366165)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=366227)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=366227)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=366227)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=366227)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=366227)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366227)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=366227)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=366227)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366227)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=366227)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=366227)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=366227)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=366227)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=366227)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=366227)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366227)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=366227)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366227)[0;0m     )
[0;36m(EngineCore_DP0 pid=366227)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366227)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=366227)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=366227)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366227)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=366227)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=366227)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366227)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=366227)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=366227)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366227)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=366227)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=366227)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366227)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=366227)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=366227)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366227)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=366227)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366227)[0;0m     )
[0;36m(EngineCore_DP0 pid=366227)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366227)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=366227)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=366227)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=366227)[0;0m     )
[0;36m(EngineCore_DP0 pid=366227)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=366227)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=366227)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=366227)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=366227)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366227)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=366227)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366227)[0;0m     )
[0;36m(EngineCore_DP0 pid=366227)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366227)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=366227)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=366227)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366227)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=366227)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=366227)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366227)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=366227)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366227)[0;0m     )
[0;36m(EngineCore_DP0 pid=366227)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366227)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=366227)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=366227)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366227)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=366227)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=366227)[0;0m         config,
[0;36m(EngineCore_DP0 pid=366227)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=366227)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=366227)[0;0m     )
[0;36m(EngineCore_DP0 pid=366227)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=366227)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=366227)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366227)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=366227)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366227)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=366227)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=366227)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366227)[0;0m     )
[0;36m(EngineCore_DP0 pid=366227)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366227)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=366227)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=366227)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366227)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=366227)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366227)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=366227)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=366227)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366227)[0;0m     )
[0;36m(EngineCore_DP0 pid=366227)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366227)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=366227)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=366227)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366227)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=366227)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=366227)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366227)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=366227)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366227)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=366227)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=366227)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366227)[0;0m     ),
[0;36m(EngineCore_DP0 pid=366227)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366227)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=366227)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=366227)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=366289)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=366289)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=366289)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=366289)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=366289)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366289)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=366289)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=366289)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366289)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=366289)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=366289)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=366289)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=366289)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=366289)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=366289)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366289)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=366289)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366289)[0;0m     )
[0;36m(EngineCore_DP0 pid=366289)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366289)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=366289)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=366289)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366289)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=366289)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=366289)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366289)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=366289)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=366289)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366289)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=366289)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=366289)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366289)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=366289)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=366289)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366289)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=366289)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366289)[0;0m     )
[0;36m(EngineCore_DP0 pid=366289)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366289)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=366289)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=366289)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=366289)[0;0m     )
[0;36m(EngineCore_DP0 pid=366289)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=366289)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=366289)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=366289)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=366289)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366289)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=366289)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366289)[0;0m     )
[0;36m(EngineCore_DP0 pid=366289)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366289)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=366289)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=366289)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366289)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=366289)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=366289)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366289)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=366289)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366289)[0;0m     )
[0;36m(EngineCore_DP0 pid=366289)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366289)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=366289)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=366289)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366289)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=366289)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=366289)[0;0m         config,
[0;36m(EngineCore_DP0 pid=366289)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=366289)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=366289)[0;0m     )
[0;36m(EngineCore_DP0 pid=366289)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=366289)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=366289)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366289)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=366289)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366289)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=366289)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=366289)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366289)[0;0m     )
[0;36m(EngineCore_DP0 pid=366289)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366289)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=366289)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=366289)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366289)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=366289)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366289)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=366289)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=366289)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366289)[0;0m     )
[0;36m(EngineCore_DP0 pid=366289)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366289)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=366289)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=366289)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366289)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=366289)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=366289)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366289)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=366289)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366289)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=366289)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=366289)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366289)[0;0m     ),
[0;36m(EngineCore_DP0 pid=366289)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366289)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=366289)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=366289)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=366351)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=366351)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=366351)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=366351)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=366351)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366351)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=366351)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=366351)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366351)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=366351)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=366351)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=366351)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=366351)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=366351)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=366351)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366351)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=366351)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366351)[0;0m     )
[0;36m(EngineCore_DP0 pid=366351)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366351)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=366351)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=366351)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366351)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=366351)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=366351)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366351)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=366351)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=366351)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366351)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=366351)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=366351)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366351)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=366351)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=366351)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366351)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=366351)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366351)[0;0m     )
[0;36m(EngineCore_DP0 pid=366351)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366351)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=366351)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=366351)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=366351)[0;0m     )
[0;36m(EngineCore_DP0 pid=366351)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=366351)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=366351)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=366351)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=366351)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366351)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=366351)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366351)[0;0m     )
[0;36m(EngineCore_DP0 pid=366351)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366351)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=366351)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=366351)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366351)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=366351)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=366351)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366351)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=366351)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366351)[0;0m     )
[0;36m(EngineCore_DP0 pid=366351)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366351)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=366351)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=366351)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366351)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=366351)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=366351)[0;0m         config,
[0;36m(EngineCore_DP0 pid=366351)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=366351)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=366351)[0;0m     )
[0;36m(EngineCore_DP0 pid=366351)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=366351)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=366351)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366351)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=366351)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366351)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=366351)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=366351)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366351)[0;0m     )
[0;36m(EngineCore_DP0 pid=366351)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366351)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=366351)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=366351)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366351)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=366351)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366351)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=366351)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=366351)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366351)[0;0m     )
[0;36m(EngineCore_DP0 pid=366351)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366351)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=366351)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=366351)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366351)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=366351)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=366351)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366351)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=366351)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366351)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=366351)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=366351)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366351)[0;0m     ),
[0;36m(EngineCore_DP0 pid=366351)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366351)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=366351)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=366351)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=366413)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=366413)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=366413)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=366413)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=366413)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366413)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=366413)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=366413)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366413)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=366413)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=366413)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=366413)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=366413)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=366413)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=366413)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366413)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=366413)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366413)[0;0m     )
[0;36m(EngineCore_DP0 pid=366413)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366413)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=366413)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=366413)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366413)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=366413)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=366413)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366413)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=366413)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=366413)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366413)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=366413)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=366413)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366413)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=366413)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=366413)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366413)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=366413)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366413)[0;0m     )
[0;36m(EngineCore_DP0 pid=366413)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366413)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=366413)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=366413)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=366413)[0;0m     )
[0;36m(EngineCore_DP0 pid=366413)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=366413)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=366413)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=366413)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=366413)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366413)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=366413)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366413)[0;0m     )
[0;36m(EngineCore_DP0 pid=366413)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366413)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=366413)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=366413)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366413)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=366413)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=366413)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366413)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=366413)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366413)[0;0m     )
[0;36m(EngineCore_DP0 pid=366413)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366413)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=366413)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=366413)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366413)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=366413)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=366413)[0;0m         config,
[0;36m(EngineCore_DP0 pid=366413)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=366413)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=366413)[0;0m     )
[0;36m(EngineCore_DP0 pid=366413)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=366413)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=366413)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366413)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=366413)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366413)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=366413)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=366413)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366413)[0;0m     )
[0;36m(EngineCore_DP0 pid=366413)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366413)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=366413)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=366413)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366413)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=366413)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366413)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=366413)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=366413)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366413)[0;0m     )
[0;36m(EngineCore_DP0 pid=366413)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366413)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=366413)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=366413)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366413)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=366413)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=366413)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366413)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=366413)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366413)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=366413)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=366413)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366413)[0;0m     ),
[0;36m(EngineCore_DP0 pid=366413)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366413)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=366413)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=366413)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=366475)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=366475)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=366475)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=366475)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=366475)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366475)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=366475)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=366475)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366475)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=366475)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=366475)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=366475)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=366475)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=366475)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=366475)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366475)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=366475)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366475)[0;0m     )
[0;36m(EngineCore_DP0 pid=366475)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366475)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=366475)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=366475)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366475)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=366475)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=366475)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366475)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=366475)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=366475)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366475)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=366475)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=366475)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366475)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=366475)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=366475)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366475)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=366475)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366475)[0;0m     )
[0;36m(EngineCore_DP0 pid=366475)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366475)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=366475)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=366475)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=366475)[0;0m     )
[0;36m(EngineCore_DP0 pid=366475)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=366475)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=366475)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=366475)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=366475)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366475)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=366475)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366475)[0;0m     )
[0;36m(EngineCore_DP0 pid=366475)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366475)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=366475)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=366475)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366475)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=366475)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=366475)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366475)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=366475)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366475)[0;0m     )
[0;36m(EngineCore_DP0 pid=366475)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366475)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=366475)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=366475)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366475)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=366475)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=366475)[0;0m         config,
[0;36m(EngineCore_DP0 pid=366475)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=366475)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=366475)[0;0m     )
[0;36m(EngineCore_DP0 pid=366475)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=366475)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=366475)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366475)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=366475)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366475)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=366475)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=366475)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366475)[0;0m     )
[0;36m(EngineCore_DP0 pid=366475)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366475)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=366475)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=366475)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366475)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=366475)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366475)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=366475)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=366475)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366475)[0;0m     )
[0;36m(EngineCore_DP0 pid=366475)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366475)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=366475)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=366475)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366475)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=366475)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=366475)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366475)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=366475)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366475)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=366475)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=366475)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366475)[0;0m     ),
[0;36m(EngineCore_DP0 pid=366475)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366475)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=366475)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=366475)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=366880)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=366880)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=366880)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=366880)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=366880)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366880)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=366880)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=366880)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366880)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=366880)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=366880)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=366880)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=366880)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=366880)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=366880)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366880)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=366880)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366880)[0;0m     )
[0;36m(EngineCore_DP0 pid=366880)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366880)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=366880)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=366880)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366880)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=366880)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=366880)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366880)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=366880)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=366880)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366880)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=366880)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=366880)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366880)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=366880)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=366880)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366880)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=366880)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366880)[0;0m     )
[0;36m(EngineCore_DP0 pid=366880)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366880)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=366880)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=366880)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=366880)[0;0m     )
[0;36m(EngineCore_DP0 pid=366880)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=366880)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=366880)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=366880)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=366880)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366880)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=366880)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366880)[0;0m     )
[0;36m(EngineCore_DP0 pid=366880)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366880)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=366880)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=366880)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366880)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=366880)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=366880)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366880)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=366880)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366880)[0;0m     )
[0;36m(EngineCore_DP0 pid=366880)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366880)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=366880)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=366880)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366880)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=366880)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=366880)[0;0m         config,
[0;36m(EngineCore_DP0 pid=366880)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=366880)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=366880)[0;0m     )
[0;36m(EngineCore_DP0 pid=366880)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=366880)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=366880)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366880)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=366880)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366880)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=366880)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=366880)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366880)[0;0m     )
[0;36m(EngineCore_DP0 pid=366880)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366880)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=366880)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=366880)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366880)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=366880)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366880)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=366880)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=366880)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366880)[0;0m     )
[0;36m(EngineCore_DP0 pid=366880)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366880)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=366880)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=366880)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366880)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=366880)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=366880)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366880)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=366880)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366880)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=366880)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=366880)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366880)[0;0m     ),
[0;36m(EngineCore_DP0 pid=366880)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366880)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=366880)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=366880)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=366942)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=366942)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=366942)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=366942)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=366942)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366942)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=366942)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=366942)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366942)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=366942)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=366942)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=366942)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=366942)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=366942)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=366942)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366942)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=366942)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366942)[0;0m     )
[0;36m(EngineCore_DP0 pid=366942)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366942)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=366942)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=366942)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366942)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=366942)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=366942)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366942)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=366942)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=366942)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=366942)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=366942)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=366942)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366942)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=366942)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=366942)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366942)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=366942)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366942)[0;0m     )
[0;36m(EngineCore_DP0 pid=366942)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366942)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=366942)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=366942)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=366942)[0;0m     )
[0;36m(EngineCore_DP0 pid=366942)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=366942)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=366942)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=366942)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=366942)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366942)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=366942)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366942)[0;0m     )
[0;36m(EngineCore_DP0 pid=366942)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366942)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=366942)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=366942)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366942)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=366942)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=366942)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366942)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=366942)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366942)[0;0m     )
[0;36m(EngineCore_DP0 pid=366942)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366942)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=366942)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=366942)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366942)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=366942)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=366942)[0;0m         config,
[0;36m(EngineCore_DP0 pid=366942)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=366942)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=366942)[0;0m     )
[0;36m(EngineCore_DP0 pid=366942)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=366942)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=366942)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366942)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=366942)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366942)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=366942)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=366942)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366942)[0;0m     )
[0;36m(EngineCore_DP0 pid=366942)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366942)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=366942)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=366942)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366942)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=366942)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366942)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=366942)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=366942)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366942)[0;0m     )
[0;36m(EngineCore_DP0 pid=366942)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366942)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=366942)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=366942)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366942)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=366942)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=366942)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=366942)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=366942)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366942)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=366942)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=366942)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=366942)[0;0m     ),
[0;36m(EngineCore_DP0 pid=366942)[0;0m     ^
[0;36m(EngineCore_DP0 pid=366942)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=366942)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=366942)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=367004)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=367004)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=367004)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=367004)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=367004)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367004)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=367004)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=367004)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367004)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=367004)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=367004)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=367004)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=367004)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=367004)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=367004)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367004)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=367004)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367004)[0;0m     )
[0;36m(EngineCore_DP0 pid=367004)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367004)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=367004)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=367004)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367004)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=367004)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=367004)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367004)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=367004)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=367004)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367004)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=367004)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=367004)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367004)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=367004)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=367004)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367004)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=367004)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367004)[0;0m     )
[0;36m(EngineCore_DP0 pid=367004)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367004)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=367004)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=367004)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=367004)[0;0m     )
[0;36m(EngineCore_DP0 pid=367004)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=367004)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=367004)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=367004)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=367004)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367004)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=367004)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367004)[0;0m     )
[0;36m(EngineCore_DP0 pid=367004)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367004)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=367004)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=367004)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367004)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=367004)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=367004)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367004)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=367004)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367004)[0;0m     )
[0;36m(EngineCore_DP0 pid=367004)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367004)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=367004)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=367004)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367004)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=367004)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=367004)[0;0m         config,
[0;36m(EngineCore_DP0 pid=367004)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=367004)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=367004)[0;0m     )
[0;36m(EngineCore_DP0 pid=367004)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=367004)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=367004)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367004)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=367004)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367004)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=367004)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=367004)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367004)[0;0m     )
[0;36m(EngineCore_DP0 pid=367004)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367004)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=367004)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=367004)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367004)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=367004)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367004)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=367004)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=367004)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367004)[0;0m     )
[0;36m(EngineCore_DP0 pid=367004)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367004)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=367004)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=367004)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367004)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=367004)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=367004)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367004)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=367004)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367004)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=367004)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=367004)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367004)[0;0m     ),
[0;36m(EngineCore_DP0 pid=367004)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367004)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=367004)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=367004)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=367066)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=367066)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=367066)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=367066)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=367066)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367066)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=367066)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=367066)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367066)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=367066)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=367066)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=367066)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=367066)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=367066)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=367066)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367066)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=367066)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367066)[0;0m     )
[0;36m(EngineCore_DP0 pid=367066)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367066)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=367066)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=367066)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367066)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=367066)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=367066)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367066)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=367066)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=367066)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367066)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=367066)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=367066)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367066)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=367066)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=367066)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367066)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=367066)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367066)[0;0m     )
[0;36m(EngineCore_DP0 pid=367066)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367066)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=367066)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=367066)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=367066)[0;0m     )
[0;36m(EngineCore_DP0 pid=367066)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=367066)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=367066)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=367066)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=367066)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367066)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=367066)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367066)[0;0m     )
[0;36m(EngineCore_DP0 pid=367066)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367066)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=367066)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=367066)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367066)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=367066)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=367066)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367066)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=367066)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367066)[0;0m     )
[0;36m(EngineCore_DP0 pid=367066)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367066)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=367066)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=367066)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367066)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=367066)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=367066)[0;0m         config,
[0;36m(EngineCore_DP0 pid=367066)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=367066)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=367066)[0;0m     )
[0;36m(EngineCore_DP0 pid=367066)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=367066)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=367066)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367066)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=367066)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367066)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=367066)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=367066)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367066)[0;0m     )
[0;36m(EngineCore_DP0 pid=367066)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367066)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=367066)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=367066)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367066)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=367066)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367066)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=367066)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=367066)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367066)[0;0m     )
[0;36m(EngineCore_DP0 pid=367066)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367066)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=367066)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=367066)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367066)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=367066)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=367066)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367066)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=367066)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367066)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=367066)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=367066)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367066)[0;0m     ),
[0;36m(EngineCore_DP0 pid=367066)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367066)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=367066)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=367066)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=367129)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=367129)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=367129)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=367129)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=367129)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367129)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=367129)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=367129)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367129)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=367129)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=367129)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=367129)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=367129)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=367129)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=367129)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367129)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=367129)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367129)[0;0m     )
[0;36m(EngineCore_DP0 pid=367129)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367129)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=367129)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=367129)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367129)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=367129)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=367129)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367129)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=367129)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=367129)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367129)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=367129)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=367129)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367129)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=367129)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=367129)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367129)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=367129)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367129)[0;0m     )
[0;36m(EngineCore_DP0 pid=367129)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367129)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=367129)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=367129)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=367129)[0;0m     )
[0;36m(EngineCore_DP0 pid=367129)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=367129)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=367129)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=367129)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=367129)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367129)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=367129)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367129)[0;0m     )
[0;36m(EngineCore_DP0 pid=367129)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367129)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=367129)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=367129)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367129)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=367129)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=367129)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367129)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=367129)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367129)[0;0m     )
[0;36m(EngineCore_DP0 pid=367129)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367129)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=367129)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=367129)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367129)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=367129)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=367129)[0;0m         config,
[0;36m(EngineCore_DP0 pid=367129)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=367129)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=367129)[0;0m     )
[0;36m(EngineCore_DP0 pid=367129)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=367129)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=367129)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367129)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=367129)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367129)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=367129)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=367129)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367129)[0;0m     )
[0;36m(EngineCore_DP0 pid=367129)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367129)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=367129)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=367129)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367129)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=367129)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367129)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=367129)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=367129)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367129)[0;0m     )
[0;36m(EngineCore_DP0 pid=367129)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367129)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=367129)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=367129)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367129)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=367129)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=367129)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367129)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=367129)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367129)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=367129)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=367129)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367129)[0;0m     ),
[0;36m(EngineCore_DP0 pid=367129)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367129)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=367129)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=367129)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=367191)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=367191)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=367191)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=367191)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=367191)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367191)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=367191)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=367191)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367191)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=367191)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=367191)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=367191)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=367191)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=367191)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=367191)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367191)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=367191)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367191)[0;0m     )
[0;36m(EngineCore_DP0 pid=367191)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367191)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=367191)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=367191)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367191)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=367191)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=367191)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367191)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=367191)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=367191)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367191)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=367191)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=367191)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367191)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=367191)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=367191)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367191)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=367191)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367191)[0;0m     )
[0;36m(EngineCore_DP0 pid=367191)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367191)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=367191)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=367191)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=367191)[0;0m     )
[0;36m(EngineCore_DP0 pid=367191)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=367191)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=367191)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=367191)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=367191)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367191)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=367191)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367191)[0;0m     )
[0;36m(EngineCore_DP0 pid=367191)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367191)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=367191)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=367191)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367191)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=367191)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=367191)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367191)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=367191)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367191)[0;0m     )
[0;36m(EngineCore_DP0 pid=367191)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367191)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=367191)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=367191)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367191)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=367191)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=367191)[0;0m         config,
[0;36m(EngineCore_DP0 pid=367191)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=367191)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=367191)[0;0m     )
[0;36m(EngineCore_DP0 pid=367191)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=367191)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=367191)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367191)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=367191)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367191)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=367191)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=367191)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367191)[0;0m     )
[0;36m(EngineCore_DP0 pid=367191)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367191)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=367191)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=367191)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367191)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=367191)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367191)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=367191)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=367191)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367191)[0;0m     )
[0;36m(EngineCore_DP0 pid=367191)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367191)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=367191)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=367191)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367191)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=367191)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=367191)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367191)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=367191)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367191)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=367191)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=367191)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367191)[0;0m     ),
[0;36m(EngineCore_DP0 pid=367191)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367191)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=367191)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=367191)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=367253)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=367253)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=367253)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=367253)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=367253)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367253)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=367253)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=367253)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367253)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=367253)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=367253)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=367253)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=367253)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=367253)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=367253)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367253)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=367253)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367253)[0;0m     )
[0;36m(EngineCore_DP0 pid=367253)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367253)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=367253)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=367253)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367253)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=367253)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=367253)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367253)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=367253)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=367253)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367253)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=367253)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=367253)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367253)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=367253)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=367253)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367253)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=367253)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367253)[0;0m     )
[0;36m(EngineCore_DP0 pid=367253)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367253)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=367253)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=367253)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=367253)[0;0m     )
[0;36m(EngineCore_DP0 pid=367253)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=367253)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=367253)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=367253)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=367253)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367253)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=367253)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367253)[0;0m     )
[0;36m(EngineCore_DP0 pid=367253)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367253)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=367253)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=367253)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367253)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=367253)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=367253)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367253)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=367253)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367253)[0;0m     )
[0;36m(EngineCore_DP0 pid=367253)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367253)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=367253)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=367253)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367253)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=367253)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=367253)[0;0m         config,
[0;36m(EngineCore_DP0 pid=367253)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=367253)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=367253)[0;0m     )
[0;36m(EngineCore_DP0 pid=367253)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=367253)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=367253)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367253)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=367253)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367253)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=367253)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=367253)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367253)[0;0m     )
[0;36m(EngineCore_DP0 pid=367253)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367253)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=367253)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=367253)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367253)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=367253)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367253)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=367253)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=367253)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367253)[0;0m     )
[0;36m(EngineCore_DP0 pid=367253)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367253)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=367253)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=367253)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367253)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=367253)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=367253)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367253)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=367253)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367253)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=367253)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=367253)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367253)[0;0m     ),
[0;36m(EngineCore_DP0 pid=367253)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367253)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=367253)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=367253)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=367315)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=367315)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=367315)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=367315)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=367315)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367315)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=367315)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=367315)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367315)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=367315)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=367315)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=367315)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=367315)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=367315)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=367315)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367315)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=367315)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367315)[0;0m     )
[0;36m(EngineCore_DP0 pid=367315)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367315)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=367315)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=367315)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367315)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=367315)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=367315)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367315)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=367315)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=367315)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367315)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=367315)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=367315)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367315)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=367315)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=367315)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367315)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=367315)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367315)[0;0m     )
[0;36m(EngineCore_DP0 pid=367315)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367315)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=367315)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=367315)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=367315)[0;0m     )
[0;36m(EngineCore_DP0 pid=367315)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=367315)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=367315)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=367315)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=367315)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367315)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=367315)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367315)[0;0m     )
[0;36m(EngineCore_DP0 pid=367315)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367315)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=367315)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=367315)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367315)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=367315)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=367315)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367315)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=367315)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367315)[0;0m     )
[0;36m(EngineCore_DP0 pid=367315)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367315)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=367315)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=367315)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367315)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=367315)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=367315)[0;0m         config,
[0;36m(EngineCore_DP0 pid=367315)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=367315)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=367315)[0;0m     )
[0;36m(EngineCore_DP0 pid=367315)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=367315)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=367315)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367315)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=367315)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367315)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=367315)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=367315)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367315)[0;0m     )
[0;36m(EngineCore_DP0 pid=367315)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367315)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=367315)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=367315)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367315)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=367315)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367315)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=367315)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=367315)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367315)[0;0m     )
[0;36m(EngineCore_DP0 pid=367315)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367315)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=367315)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=367315)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367315)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=367315)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=367315)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367315)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=367315)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367315)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=367315)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=367315)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367315)[0;0m     ),
[0;36m(EngineCore_DP0 pid=367315)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367315)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=367315)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=367315)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=367720)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=367720)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=367720)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=367720)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=367720)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367720)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=367720)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=367720)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367720)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=367720)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=367720)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=367720)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=367720)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=367720)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=367720)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367720)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=367720)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367720)[0;0m     )
[0;36m(EngineCore_DP0 pid=367720)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367720)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=367720)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=367720)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367720)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=367720)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=367720)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367720)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=367720)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=367720)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367720)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=367720)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=367720)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367720)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=367720)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=367720)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367720)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=367720)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367720)[0;0m     )
[0;36m(EngineCore_DP0 pid=367720)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367720)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=367720)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=367720)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=367720)[0;0m     )
[0;36m(EngineCore_DP0 pid=367720)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=367720)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=367720)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=367720)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=367720)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367720)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=367720)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367720)[0;0m     )
[0;36m(EngineCore_DP0 pid=367720)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367720)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=367720)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=367720)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367720)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=367720)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=367720)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367720)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=367720)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367720)[0;0m     )
[0;36m(EngineCore_DP0 pid=367720)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367720)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=367720)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=367720)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367720)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=367720)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=367720)[0;0m         config,
[0;36m(EngineCore_DP0 pid=367720)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=367720)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=367720)[0;0m     )
[0;36m(EngineCore_DP0 pid=367720)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=367720)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=367720)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367720)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=367720)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367720)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=367720)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=367720)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367720)[0;0m     )
[0;36m(EngineCore_DP0 pid=367720)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367720)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=367720)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=367720)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367720)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=367720)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367720)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=367720)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=367720)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367720)[0;0m     )
[0;36m(EngineCore_DP0 pid=367720)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367720)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=367720)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=367720)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367720)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=367720)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=367720)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367720)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=367720)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367720)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=367720)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=367720)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367720)[0;0m     ),
[0;36m(EngineCore_DP0 pid=367720)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367720)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=367720)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=367720)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=367782)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=367782)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=367782)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=367782)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=367782)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367782)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=367782)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=367782)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367782)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=367782)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=367782)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=367782)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=367782)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=367782)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=367782)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367782)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=367782)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367782)[0;0m     )
[0;36m(EngineCore_DP0 pid=367782)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367782)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=367782)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=367782)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367782)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=367782)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=367782)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367782)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=367782)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=367782)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367782)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=367782)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=367782)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367782)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=367782)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=367782)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367782)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=367782)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367782)[0;0m     )
[0;36m(EngineCore_DP0 pid=367782)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367782)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=367782)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=367782)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=367782)[0;0m     )
[0;36m(EngineCore_DP0 pid=367782)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=367782)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=367782)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=367782)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=367782)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367782)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=367782)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367782)[0;0m     )
[0;36m(EngineCore_DP0 pid=367782)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367782)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=367782)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=367782)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367782)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=367782)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=367782)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367782)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=367782)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367782)[0;0m     )
[0;36m(EngineCore_DP0 pid=367782)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367782)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=367782)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=367782)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367782)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=367782)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=367782)[0;0m         config,
[0;36m(EngineCore_DP0 pid=367782)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=367782)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=367782)[0;0m     )
[0;36m(EngineCore_DP0 pid=367782)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=367782)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=367782)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367782)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=367782)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367782)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=367782)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=367782)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367782)[0;0m     )
[0;36m(EngineCore_DP0 pid=367782)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367782)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=367782)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=367782)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367782)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=367782)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367782)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=367782)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=367782)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367782)[0;0m     )
[0;36m(EngineCore_DP0 pid=367782)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367782)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=367782)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=367782)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367782)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=367782)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=367782)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367782)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=367782)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367782)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=367782)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=367782)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367782)[0;0m     ),
[0;36m(EngineCore_DP0 pid=367782)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367782)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=367782)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=367782)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=367844)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=367844)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=367844)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=367844)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=367844)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367844)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=367844)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=367844)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367844)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=367844)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=367844)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=367844)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=367844)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=367844)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=367844)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367844)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=367844)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367844)[0;0m     )
[0;36m(EngineCore_DP0 pid=367844)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367844)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=367844)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=367844)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367844)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=367844)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=367844)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367844)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=367844)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=367844)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367844)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=367844)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=367844)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367844)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=367844)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=367844)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367844)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=367844)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367844)[0;0m     )
[0;36m(EngineCore_DP0 pid=367844)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367844)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=367844)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=367844)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=367844)[0;0m     )
[0;36m(EngineCore_DP0 pid=367844)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=367844)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=367844)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=367844)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=367844)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367844)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=367844)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367844)[0;0m     )
[0;36m(EngineCore_DP0 pid=367844)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367844)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=367844)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=367844)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367844)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=367844)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=367844)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367844)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=367844)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367844)[0;0m     )
[0;36m(EngineCore_DP0 pid=367844)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367844)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=367844)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=367844)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367844)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=367844)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=367844)[0;0m         config,
[0;36m(EngineCore_DP0 pid=367844)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=367844)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=367844)[0;0m     )
[0;36m(EngineCore_DP0 pid=367844)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=367844)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=367844)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367844)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=367844)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367844)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=367844)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=367844)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367844)[0;0m     )
[0;36m(EngineCore_DP0 pid=367844)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367844)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=367844)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=367844)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367844)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=367844)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367844)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=367844)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=367844)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367844)[0;0m     )
[0;36m(EngineCore_DP0 pid=367844)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367844)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=367844)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=367844)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367844)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=367844)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=367844)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367844)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=367844)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367844)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=367844)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=367844)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367844)[0;0m     ),
[0;36m(EngineCore_DP0 pid=367844)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367844)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=367844)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=367844)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=367906)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=367906)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=367906)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=367906)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=367906)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367906)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=367906)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=367906)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367906)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=367906)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=367906)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=367906)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=367906)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=367906)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=367906)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367906)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=367906)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367906)[0;0m     )
[0;36m(EngineCore_DP0 pid=367906)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367906)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=367906)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=367906)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367906)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=367906)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=367906)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367906)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=367906)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=367906)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367906)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=367906)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=367906)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367906)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=367906)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=367906)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367906)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=367906)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367906)[0;0m     )
[0;36m(EngineCore_DP0 pid=367906)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367906)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=367906)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=367906)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=367906)[0;0m     )
[0;36m(EngineCore_DP0 pid=367906)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=367906)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=367906)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=367906)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=367906)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367906)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=367906)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367906)[0;0m     )
[0;36m(EngineCore_DP0 pid=367906)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367906)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=367906)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=367906)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367906)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=367906)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=367906)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367906)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=367906)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367906)[0;0m     )
[0;36m(EngineCore_DP0 pid=367906)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367906)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=367906)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=367906)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367906)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=367906)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=367906)[0;0m         config,
[0;36m(EngineCore_DP0 pid=367906)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=367906)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=367906)[0;0m     )
[0;36m(EngineCore_DP0 pid=367906)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=367906)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=367906)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367906)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=367906)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367906)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=367906)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=367906)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367906)[0;0m     )
[0;36m(EngineCore_DP0 pid=367906)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367906)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=367906)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=367906)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367906)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=367906)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367906)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=367906)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=367906)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367906)[0;0m     )
[0;36m(EngineCore_DP0 pid=367906)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367906)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=367906)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=367906)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367906)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=367906)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=367906)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367906)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=367906)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367906)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=367906)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=367906)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367906)[0;0m     ),
[0;36m(EngineCore_DP0 pid=367906)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367906)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=367906)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=367906)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=367968)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=367968)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=367968)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=367968)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=367968)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367968)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=367968)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=367968)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367968)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=367968)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=367968)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=367968)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=367968)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=367968)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=367968)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367968)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=367968)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367968)[0;0m     )
[0;36m(EngineCore_DP0 pid=367968)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367968)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=367968)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=367968)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367968)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=367968)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=367968)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367968)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=367968)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=367968)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=367968)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=367968)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=367968)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367968)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=367968)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=367968)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367968)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=367968)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367968)[0;0m     )
[0;36m(EngineCore_DP0 pid=367968)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367968)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=367968)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=367968)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=367968)[0;0m     )
[0;36m(EngineCore_DP0 pid=367968)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=367968)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=367968)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=367968)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=367968)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367968)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=367968)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367968)[0;0m     )
[0;36m(EngineCore_DP0 pid=367968)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367968)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=367968)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=367968)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367968)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=367968)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=367968)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367968)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=367968)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367968)[0;0m     )
[0;36m(EngineCore_DP0 pid=367968)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367968)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=367968)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=367968)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367968)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=367968)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=367968)[0;0m         config,
[0;36m(EngineCore_DP0 pid=367968)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=367968)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=367968)[0;0m     )
[0;36m(EngineCore_DP0 pid=367968)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=367968)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=367968)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367968)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=367968)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367968)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=367968)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=367968)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367968)[0;0m     )
[0;36m(EngineCore_DP0 pid=367968)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367968)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=367968)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=367968)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367968)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=367968)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367968)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=367968)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=367968)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367968)[0;0m     )
[0;36m(EngineCore_DP0 pid=367968)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367968)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=367968)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=367968)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367968)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=367968)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=367968)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=367968)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=367968)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367968)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=367968)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=367968)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=367968)[0;0m     ),
[0;36m(EngineCore_DP0 pid=367968)[0;0m     ^
[0;36m(EngineCore_DP0 pid=367968)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=367968)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=367968)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=368030)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=368030)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=368030)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=368030)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=368030)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368030)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=368030)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=368030)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368030)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=368030)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=368030)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=368030)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=368030)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=368030)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=368030)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368030)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=368030)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368030)[0;0m     )
[0;36m(EngineCore_DP0 pid=368030)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368030)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=368030)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=368030)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368030)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=368030)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=368030)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368030)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=368030)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=368030)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368030)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=368030)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=368030)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368030)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=368030)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=368030)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368030)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=368030)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368030)[0;0m     )
[0;36m(EngineCore_DP0 pid=368030)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368030)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=368030)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=368030)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=368030)[0;0m     )
[0;36m(EngineCore_DP0 pid=368030)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=368030)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=368030)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=368030)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=368030)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368030)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=368030)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368030)[0;0m     )
[0;36m(EngineCore_DP0 pid=368030)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368030)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=368030)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=368030)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368030)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=368030)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=368030)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368030)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=368030)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368030)[0;0m     )
[0;36m(EngineCore_DP0 pid=368030)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368030)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=368030)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=368030)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368030)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=368030)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=368030)[0;0m         config,
[0;36m(EngineCore_DP0 pid=368030)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=368030)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=368030)[0;0m     )
[0;36m(EngineCore_DP0 pid=368030)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=368030)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=368030)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368030)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=368030)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368030)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=368030)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=368030)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368030)[0;0m     )
[0;36m(EngineCore_DP0 pid=368030)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368030)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=368030)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=368030)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368030)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=368030)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368030)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=368030)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=368030)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368030)[0;0m     )
[0;36m(EngineCore_DP0 pid=368030)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368030)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=368030)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=368030)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368030)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=368030)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=368030)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368030)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=368030)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368030)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=368030)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=368030)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368030)[0;0m     ),
[0;36m(EngineCore_DP0 pid=368030)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368030)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=368030)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=368030)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=368092)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=368092)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=368092)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=368092)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=368092)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368092)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=368092)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=368092)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368092)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=368092)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=368092)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=368092)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=368092)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=368092)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=368092)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368092)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=368092)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368092)[0;0m     )
[0;36m(EngineCore_DP0 pid=368092)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368092)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=368092)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=368092)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368092)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=368092)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=368092)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368092)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=368092)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=368092)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368092)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=368092)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=368092)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368092)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=368092)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=368092)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368092)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=368092)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368092)[0;0m     )
[0;36m(EngineCore_DP0 pid=368092)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368092)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=368092)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=368092)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=368092)[0;0m     )
[0;36m(EngineCore_DP0 pid=368092)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=368092)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=368092)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=368092)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=368092)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368092)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=368092)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368092)[0;0m     )
[0;36m(EngineCore_DP0 pid=368092)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368092)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=368092)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=368092)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368092)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=368092)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=368092)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368092)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=368092)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368092)[0;0m     )
[0;36m(EngineCore_DP0 pid=368092)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368092)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=368092)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=368092)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368092)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=368092)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=368092)[0;0m         config,
[0;36m(EngineCore_DP0 pid=368092)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=368092)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=368092)[0;0m     )
[0;36m(EngineCore_DP0 pid=368092)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=368092)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=368092)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368092)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=368092)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368092)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=368092)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=368092)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368092)[0;0m     )
[0;36m(EngineCore_DP0 pid=368092)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368092)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=368092)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=368092)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368092)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=368092)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368092)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=368092)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=368092)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368092)[0;0m     )
[0;36m(EngineCore_DP0 pid=368092)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368092)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=368092)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=368092)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368092)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=368092)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=368092)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368092)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=368092)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368092)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=368092)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=368092)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368092)[0;0m     ),
[0;36m(EngineCore_DP0 pid=368092)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368092)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=368092)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=368092)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=368154)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=368154)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=368154)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=368154)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=368154)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368154)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=368154)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=368154)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368154)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=368154)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=368154)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=368154)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=368154)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=368154)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=368154)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368154)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=368154)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368154)[0;0m     )
[0;36m(EngineCore_DP0 pid=368154)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368154)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=368154)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=368154)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368154)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=368154)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=368154)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368154)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=368154)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=368154)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368154)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=368154)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=368154)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368154)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=368154)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=368154)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368154)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=368154)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368154)[0;0m     )
[0;36m(EngineCore_DP0 pid=368154)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368154)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=368154)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=368154)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=368154)[0;0m     )
[0;36m(EngineCore_DP0 pid=368154)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=368154)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=368154)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=368154)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=368154)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368154)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=368154)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368154)[0;0m     )
[0;36m(EngineCore_DP0 pid=368154)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368154)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=368154)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=368154)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368154)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=368154)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=368154)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368154)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=368154)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368154)[0;0m     )
[0;36m(EngineCore_DP0 pid=368154)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368154)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=368154)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=368154)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368154)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=368154)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=368154)[0;0m         config,
[0;36m(EngineCore_DP0 pid=368154)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=368154)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=368154)[0;0m     )
[0;36m(EngineCore_DP0 pid=368154)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=368154)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=368154)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368154)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=368154)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368154)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=368154)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=368154)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368154)[0;0m     )
[0;36m(EngineCore_DP0 pid=368154)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368154)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=368154)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=368154)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368154)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=368154)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368154)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=368154)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=368154)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368154)[0;0m     )
[0;36m(EngineCore_DP0 pid=368154)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368154)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=368154)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=368154)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368154)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=368154)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=368154)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368154)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=368154)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368154)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=368154)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=368154)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368154)[0;0m     ),
[0;36m(EngineCore_DP0 pid=368154)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368154)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=368154)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=368154)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=368216)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=368216)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=368216)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=368216)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=368216)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368216)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=368216)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=368216)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368216)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=368216)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=368216)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=368216)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=368216)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=368216)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=368216)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368216)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=368216)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368216)[0;0m     )
[0;36m(EngineCore_DP0 pid=368216)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368216)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=368216)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=368216)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368216)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=368216)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=368216)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368216)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=368216)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=368216)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368216)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=368216)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=368216)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368216)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=368216)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=368216)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368216)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=368216)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368216)[0;0m     )
[0;36m(EngineCore_DP0 pid=368216)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368216)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=368216)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=368216)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=368216)[0;0m     )
[0;36m(EngineCore_DP0 pid=368216)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=368216)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=368216)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=368216)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=368216)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368216)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=368216)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368216)[0;0m     )
[0;36m(EngineCore_DP0 pid=368216)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368216)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=368216)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=368216)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368216)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=368216)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=368216)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368216)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=368216)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368216)[0;0m     )
[0;36m(EngineCore_DP0 pid=368216)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368216)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=368216)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=368216)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368216)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=368216)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=368216)[0;0m         config,
[0;36m(EngineCore_DP0 pid=368216)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=368216)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=368216)[0;0m     )
[0;36m(EngineCore_DP0 pid=368216)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=368216)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=368216)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368216)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=368216)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368216)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=368216)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=368216)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368216)[0;0m     )
[0;36m(EngineCore_DP0 pid=368216)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368216)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=368216)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=368216)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368216)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=368216)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368216)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=368216)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=368216)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368216)[0;0m     )
[0;36m(EngineCore_DP0 pid=368216)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368216)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=368216)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=368216)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368216)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=368216)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=368216)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368216)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=368216)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368216)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=368216)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=368216)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368216)[0;0m     ),
[0;36m(EngineCore_DP0 pid=368216)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368216)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=368216)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=368216)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=368621)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=368621)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=368621)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=368621)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=368621)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368621)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=368621)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=368621)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368621)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=368621)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=368621)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=368621)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=368621)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=368621)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=368621)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368621)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=368621)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368621)[0;0m     )
[0;36m(EngineCore_DP0 pid=368621)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368621)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=368621)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=368621)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368621)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=368621)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=368621)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368621)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=368621)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=368621)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368621)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=368621)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=368621)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368621)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=368621)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=368621)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368621)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=368621)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368621)[0;0m     )
[0;36m(EngineCore_DP0 pid=368621)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368621)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=368621)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=368621)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=368621)[0;0m     )
[0;36m(EngineCore_DP0 pid=368621)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=368621)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=368621)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=368621)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=368621)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368621)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=368621)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368621)[0;0m     )
[0;36m(EngineCore_DP0 pid=368621)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368621)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=368621)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=368621)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368621)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=368621)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=368621)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368621)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=368621)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368621)[0;0m     )
[0;36m(EngineCore_DP0 pid=368621)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368621)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=368621)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=368621)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368621)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=368621)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=368621)[0;0m         config,
[0;36m(EngineCore_DP0 pid=368621)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=368621)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=368621)[0;0m     )
[0;36m(EngineCore_DP0 pid=368621)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=368621)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=368621)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368621)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=368621)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368621)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=368621)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=368621)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368621)[0;0m     )
[0;36m(EngineCore_DP0 pid=368621)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368621)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=368621)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=368621)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368621)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=368621)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368621)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=368621)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=368621)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368621)[0;0m     )
[0;36m(EngineCore_DP0 pid=368621)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368621)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=368621)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=368621)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368621)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=368621)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=368621)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368621)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=368621)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368621)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=368621)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=368621)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368621)[0;0m     ),
[0;36m(EngineCore_DP0 pid=368621)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368621)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=368621)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=368621)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=368683)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=368683)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=368683)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=368683)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=368683)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368683)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=368683)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=368683)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368683)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=368683)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=368683)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=368683)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=368683)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=368683)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=368683)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368683)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=368683)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368683)[0;0m     )
[0;36m(EngineCore_DP0 pid=368683)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368683)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=368683)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=368683)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368683)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=368683)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=368683)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368683)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=368683)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=368683)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368683)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=368683)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=368683)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368683)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=368683)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=368683)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368683)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=368683)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368683)[0;0m     )
[0;36m(EngineCore_DP0 pid=368683)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368683)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=368683)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=368683)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=368683)[0;0m     )
[0;36m(EngineCore_DP0 pid=368683)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=368683)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=368683)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=368683)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=368683)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368683)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=368683)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368683)[0;0m     )
[0;36m(EngineCore_DP0 pid=368683)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368683)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=368683)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=368683)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368683)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=368683)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=368683)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368683)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=368683)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368683)[0;0m     )
[0;36m(EngineCore_DP0 pid=368683)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368683)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=368683)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=368683)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368683)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=368683)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=368683)[0;0m         config,
[0;36m(EngineCore_DP0 pid=368683)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=368683)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=368683)[0;0m     )
[0;36m(EngineCore_DP0 pid=368683)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=368683)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=368683)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368683)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=368683)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368683)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=368683)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=368683)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368683)[0;0m     )
[0;36m(EngineCore_DP0 pid=368683)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368683)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=368683)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=368683)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368683)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=368683)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368683)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=368683)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=368683)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368683)[0;0m     )
[0;36m(EngineCore_DP0 pid=368683)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368683)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=368683)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=368683)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368683)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=368683)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=368683)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368683)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=368683)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368683)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=368683)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=368683)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368683)[0;0m     ),
[0;36m(EngineCore_DP0 pid=368683)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368683)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=368683)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=368683)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=368746)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=368746)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=368746)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=368746)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=368746)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368746)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=368746)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=368746)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368746)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=368746)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=368746)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=368746)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=368746)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=368746)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=368746)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368746)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=368746)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368746)[0;0m     )
[0;36m(EngineCore_DP0 pid=368746)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368746)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=368746)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=368746)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368746)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=368746)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=368746)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368746)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=368746)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=368746)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368746)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=368746)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=368746)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368746)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=368746)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=368746)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368746)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=368746)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368746)[0;0m     )
[0;36m(EngineCore_DP0 pid=368746)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368746)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=368746)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=368746)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=368746)[0;0m     )
[0;36m(EngineCore_DP0 pid=368746)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=368746)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=368746)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=368746)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=368746)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368746)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=368746)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368746)[0;0m     )
[0;36m(EngineCore_DP0 pid=368746)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368746)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=368746)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=368746)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368746)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=368746)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=368746)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368746)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=368746)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368746)[0;0m     )
[0;36m(EngineCore_DP0 pid=368746)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368746)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=368746)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=368746)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368746)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=368746)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=368746)[0;0m         config,
[0;36m(EngineCore_DP0 pid=368746)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=368746)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=368746)[0;0m     )
[0;36m(EngineCore_DP0 pid=368746)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=368746)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=368746)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368746)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=368746)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368746)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=368746)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=368746)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368746)[0;0m     )
[0;36m(EngineCore_DP0 pid=368746)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368746)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=368746)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=368746)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368746)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=368746)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368746)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=368746)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=368746)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368746)[0;0m     )
[0;36m(EngineCore_DP0 pid=368746)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368746)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=368746)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=368746)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368746)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=368746)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=368746)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368746)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=368746)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368746)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=368746)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=368746)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368746)[0;0m     ),
[0;36m(EngineCore_DP0 pid=368746)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368746)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=368746)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=368746)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=368808)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=368808)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=368808)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=368808)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=368808)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368808)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=368808)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=368808)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368808)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=368808)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=368808)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=368808)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=368808)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=368808)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=368808)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368808)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=368808)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368808)[0;0m     )
[0;36m(EngineCore_DP0 pid=368808)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368808)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=368808)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=368808)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368808)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=368808)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=368808)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368808)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=368808)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=368808)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368808)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=368808)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=368808)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368808)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=368808)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=368808)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368808)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=368808)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368808)[0;0m     )
[0;36m(EngineCore_DP0 pid=368808)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368808)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=368808)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=368808)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=368808)[0;0m     )
[0;36m(EngineCore_DP0 pid=368808)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=368808)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=368808)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=368808)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=368808)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368808)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=368808)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368808)[0;0m     )
[0;36m(EngineCore_DP0 pid=368808)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368808)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=368808)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=368808)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368808)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=368808)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=368808)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368808)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=368808)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368808)[0;0m     )
[0;36m(EngineCore_DP0 pid=368808)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368808)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=368808)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=368808)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368808)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=368808)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=368808)[0;0m         config,
[0;36m(EngineCore_DP0 pid=368808)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=368808)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=368808)[0;0m     )
[0;36m(EngineCore_DP0 pid=368808)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=368808)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=368808)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368808)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=368808)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368808)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=368808)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=368808)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368808)[0;0m     )
[0;36m(EngineCore_DP0 pid=368808)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368808)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=368808)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=368808)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368808)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=368808)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368808)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=368808)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=368808)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368808)[0;0m     )
[0;36m(EngineCore_DP0 pid=368808)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368808)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=368808)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=368808)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368808)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=368808)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=368808)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368808)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=368808)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368808)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=368808)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=368808)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368808)[0;0m     ),
[0;36m(EngineCore_DP0 pid=368808)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368808)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=368808)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=368808)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=368870)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=368870)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=368870)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=368870)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=368870)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368870)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=368870)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=368870)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368870)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=368870)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=368870)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=368870)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=368870)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=368870)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=368870)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368870)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=368870)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368870)[0;0m     )
[0;36m(EngineCore_DP0 pid=368870)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368870)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=368870)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=368870)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368870)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=368870)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=368870)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368870)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=368870)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=368870)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368870)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=368870)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=368870)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368870)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=368870)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=368870)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368870)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=368870)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368870)[0;0m     )
[0;36m(EngineCore_DP0 pid=368870)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368870)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=368870)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=368870)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=368870)[0;0m     )
[0;36m(EngineCore_DP0 pid=368870)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=368870)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=368870)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=368870)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=368870)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368870)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=368870)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368870)[0;0m     )
[0;36m(EngineCore_DP0 pid=368870)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368870)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=368870)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=368870)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368870)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=368870)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=368870)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368870)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=368870)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368870)[0;0m     )
[0;36m(EngineCore_DP0 pid=368870)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368870)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=368870)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=368870)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368870)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=368870)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=368870)[0;0m         config,
[0;36m(EngineCore_DP0 pid=368870)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=368870)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=368870)[0;0m     )
[0;36m(EngineCore_DP0 pid=368870)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=368870)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=368870)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368870)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=368870)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368870)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=368870)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=368870)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368870)[0;0m     )
[0;36m(EngineCore_DP0 pid=368870)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368870)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=368870)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=368870)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368870)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=368870)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368870)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=368870)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=368870)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368870)[0;0m     )
[0;36m(EngineCore_DP0 pid=368870)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368870)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=368870)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=368870)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368870)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=368870)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=368870)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368870)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=368870)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368870)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=368870)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=368870)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368870)[0;0m     ),
[0;36m(EngineCore_DP0 pid=368870)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368870)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=368870)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=368870)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=368932)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=368932)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=368932)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=368932)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=368932)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368932)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=368932)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=368932)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368932)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=368932)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=368932)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=368932)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=368932)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=368932)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=368932)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368932)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=368932)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368932)[0;0m     )
[0;36m(EngineCore_DP0 pid=368932)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368932)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=368932)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=368932)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368932)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=368932)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=368932)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368932)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=368932)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=368932)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368932)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=368932)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=368932)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368932)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=368932)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=368932)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368932)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=368932)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368932)[0;0m     )
[0;36m(EngineCore_DP0 pid=368932)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368932)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=368932)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=368932)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=368932)[0;0m     )
[0;36m(EngineCore_DP0 pid=368932)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=368932)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=368932)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=368932)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=368932)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368932)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=368932)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368932)[0;0m     )
[0;36m(EngineCore_DP0 pid=368932)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368932)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=368932)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=368932)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368932)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=368932)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=368932)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368932)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=368932)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368932)[0;0m     )
[0;36m(EngineCore_DP0 pid=368932)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368932)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=368932)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=368932)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368932)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=368932)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=368932)[0;0m         config,
[0;36m(EngineCore_DP0 pid=368932)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=368932)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=368932)[0;0m     )
[0;36m(EngineCore_DP0 pid=368932)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=368932)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=368932)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368932)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=368932)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368932)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=368932)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=368932)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368932)[0;0m     )
[0;36m(EngineCore_DP0 pid=368932)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368932)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=368932)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=368932)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368932)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=368932)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368932)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=368932)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=368932)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368932)[0;0m     )
[0;36m(EngineCore_DP0 pid=368932)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368932)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=368932)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=368932)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368932)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=368932)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=368932)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368932)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=368932)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368932)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=368932)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=368932)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368932)[0;0m     ),
[0;36m(EngineCore_DP0 pid=368932)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368932)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=368932)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=368932)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=368994)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=368994)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=368994)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=368994)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=368994)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368994)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=368994)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=368994)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368994)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=368994)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=368994)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=368994)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=368994)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=368994)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=368994)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368994)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=368994)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368994)[0;0m     )
[0;36m(EngineCore_DP0 pid=368994)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368994)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=368994)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=368994)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368994)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=368994)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=368994)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368994)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=368994)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=368994)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=368994)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=368994)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=368994)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368994)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=368994)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=368994)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368994)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=368994)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368994)[0;0m     )
[0;36m(EngineCore_DP0 pid=368994)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368994)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=368994)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=368994)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=368994)[0;0m     )
[0;36m(EngineCore_DP0 pid=368994)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=368994)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=368994)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=368994)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=368994)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368994)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=368994)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368994)[0;0m     )
[0;36m(EngineCore_DP0 pid=368994)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368994)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=368994)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=368994)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368994)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=368994)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=368994)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368994)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=368994)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368994)[0;0m     )
[0;36m(EngineCore_DP0 pid=368994)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368994)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=368994)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=368994)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368994)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=368994)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=368994)[0;0m         config,
[0;36m(EngineCore_DP0 pid=368994)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=368994)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=368994)[0;0m     )
[0;36m(EngineCore_DP0 pid=368994)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=368994)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=368994)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368994)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=368994)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368994)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=368994)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=368994)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368994)[0;0m     )
[0;36m(EngineCore_DP0 pid=368994)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368994)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=368994)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=368994)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368994)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=368994)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368994)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=368994)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=368994)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368994)[0;0m     )
[0;36m(EngineCore_DP0 pid=368994)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368994)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=368994)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=368994)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368994)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=368994)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=368994)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=368994)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=368994)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368994)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=368994)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=368994)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=368994)[0;0m     ),
[0;36m(EngineCore_DP0 pid=368994)[0;0m     ^
[0;36m(EngineCore_DP0 pid=368994)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=368994)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=368994)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=369399)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=369399)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=369399)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=369399)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=369399)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=369399)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=369399)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=369399)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369399)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=369399)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=369399)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=369399)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=369399)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=369399)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=369399)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=369399)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=369399)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369399)[0;0m     )
[0;36m(EngineCore_DP0 pid=369399)[0;0m     ^
[0;36m(EngineCore_DP0 pid=369399)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=369399)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=369399)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369399)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=369399)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=369399)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=369399)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=369399)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=369399)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=369399)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=369399)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=369399)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369399)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=369399)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=369399)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=369399)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=369399)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369399)[0;0m     )
[0;36m(EngineCore_DP0 pid=369399)[0;0m     ^
[0;36m(EngineCore_DP0 pid=369399)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=369399)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=369399)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=369399)[0;0m     )
[0;36m(EngineCore_DP0 pid=369399)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=369399)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=369399)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=369399)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=369399)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=369399)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=369399)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369399)[0;0m     )
[0;36m(EngineCore_DP0 pid=369399)[0;0m     ^
[0;36m(EngineCore_DP0 pid=369399)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=369399)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=369399)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369399)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=369399)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=369399)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=369399)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=369399)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369399)[0;0m     )
[0;36m(EngineCore_DP0 pid=369399)[0;0m     ^
[0;36m(EngineCore_DP0 pid=369399)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=369399)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=369399)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369399)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=369399)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=369399)[0;0m         config,
[0;36m(EngineCore_DP0 pid=369399)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=369399)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=369399)[0;0m     )
[0;36m(EngineCore_DP0 pid=369399)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=369399)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=369399)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=369399)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=369399)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369399)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=369399)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=369399)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369399)[0;0m     )
[0;36m(EngineCore_DP0 pid=369399)[0;0m     ^
[0;36m(EngineCore_DP0 pid=369399)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=369399)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=369399)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=369399)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=369399)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369399)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=369399)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=369399)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369399)[0;0m     )
[0;36m(EngineCore_DP0 pid=369399)[0;0m     ^
[0;36m(EngineCore_DP0 pid=369399)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=369399)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=369399)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369399)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=369399)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=369399)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=369399)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=369399)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369399)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=369399)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=369399)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369399)[0;0m     ),
[0;36m(EngineCore_DP0 pid=369399)[0;0m     ^
[0;36m(EngineCore_DP0 pid=369399)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=369399)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=369399)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=369461)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=369461)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=369461)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=369461)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=369461)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=369461)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=369461)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=369461)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369461)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=369461)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=369461)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=369461)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=369461)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=369461)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=369461)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=369461)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=369461)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369461)[0;0m     )
[0;36m(EngineCore_DP0 pid=369461)[0;0m     ^
[0;36m(EngineCore_DP0 pid=369461)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=369461)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=369461)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369461)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=369461)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=369461)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=369461)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=369461)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=369461)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=369461)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=369461)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=369461)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369461)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=369461)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=369461)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=369461)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=369461)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369461)[0;0m     )
[0;36m(EngineCore_DP0 pid=369461)[0;0m     ^
[0;36m(EngineCore_DP0 pid=369461)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=369461)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=369461)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=369461)[0;0m     )
[0;36m(EngineCore_DP0 pid=369461)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=369461)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=369461)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=369461)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=369461)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=369461)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=369461)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369461)[0;0m     )
[0;36m(EngineCore_DP0 pid=369461)[0;0m     ^
[0;36m(EngineCore_DP0 pid=369461)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=369461)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=369461)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369461)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=369461)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=369461)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=369461)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=369461)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369461)[0;0m     )
[0;36m(EngineCore_DP0 pid=369461)[0;0m     ^
[0;36m(EngineCore_DP0 pid=369461)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=369461)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=369461)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369461)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=369461)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=369461)[0;0m         config,
[0;36m(EngineCore_DP0 pid=369461)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=369461)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=369461)[0;0m     )
[0;36m(EngineCore_DP0 pid=369461)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=369461)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=369461)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=369461)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=369461)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369461)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=369461)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=369461)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369461)[0;0m     )
[0;36m(EngineCore_DP0 pid=369461)[0;0m     ^
[0;36m(EngineCore_DP0 pid=369461)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=369461)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=369461)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=369461)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=369461)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369461)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=369461)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=369461)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369461)[0;0m     )
[0;36m(EngineCore_DP0 pid=369461)[0;0m     ^
[0;36m(EngineCore_DP0 pid=369461)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=369461)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=369461)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369461)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=369461)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=369461)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=369461)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=369461)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369461)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=369461)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=369461)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369461)[0;0m     ),
[0;36m(EngineCore_DP0 pid=369461)[0;0m     ^
[0;36m(EngineCore_DP0 pid=369461)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=369461)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=369461)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=369523)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=369523)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=369523)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=369523)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=369523)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=369523)[0;0m   File "/sw/rh9.4/spack/v1.0.0/sw/linux-x86_64_v2/python-3.13.5-7bp2p4z/lib/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=369523)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=369523)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369523)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 847, in run_engine_core
[0;36m(EngineCore_DP0 pid=369523)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=369523)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 834, in run_engine_core
[0;36m(EngineCore_DP0 pid=369523)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=369523)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 610, in __init__
[0;36m(EngineCore_DP0 pid=369523)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=369523)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=369523)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=369523)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369523)[0;0m     )
[0;36m(EngineCore_DP0 pid=369523)[0;0m     ^
[0;36m(EngineCore_DP0 pid=369523)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[0;36m(EngineCore_DP0 pid=369523)[0;0m     self.model_executor = executor_class(vllm_config)
[0;36m(EngineCore_DP0 pid=369523)[0;0m                           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369523)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=369523)[0;0m     self._init_executor()
[0;36m(EngineCore_DP0 pid=369523)[0;0m     ~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=369523)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/executor/uniproc_executor.py", line 48, in _init_executor
[0;36m(EngineCore_DP0 pid=369523)[0;0m     self.driver_worker.load_model()
[0;36m(EngineCore_DP0 pid=369523)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=369523)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 273, in load_model
[0;36m(EngineCore_DP0 pid=369523)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[0;36m(EngineCore_DP0 pid=369523)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369523)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3484, in load_model
[0;36m(EngineCore_DP0 pid=369523)[0;0m     self.model = model_loader.load_model(
[0;36m(EngineCore_DP0 pid=369523)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=369523)[0;0m         vllm_config=self.vllm_config, model_config=self.model_config
[0;36m(EngineCore_DP0 pid=369523)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369523)[0;0m     )
[0;36m(EngineCore_DP0 pid=369523)[0;0m     ^
[0;36m(EngineCore_DP0 pid=369523)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/base_loader.py", line 49, in load_model
[0;36m(EngineCore_DP0 pid=369523)[0;0m     model = initialize_model(
[0;36m(EngineCore_DP0 pid=369523)[0;0m         vllm_config=vllm_config, model_config=model_config
[0;36m(EngineCore_DP0 pid=369523)[0;0m     )
[0;36m(EngineCore_DP0 pid=369523)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/model_loader/utils.py", line 48, in initialize_model
[0;36m(EngineCore_DP0 pid=369523)[0;0m     return model_class(vllm_config=vllm_config, prefix=prefix)
[0;36m(EngineCore_DP0 pid=369523)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 656, in __init__
[0;36m(EngineCore_DP0 pid=369523)[0;0m     self.model = GraniteMoeHybridModel(
[0;36m(EngineCore_DP0 pid=369523)[0;0m                  ~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=369523)[0;0m         vllm_config=vllm_config, prefix=maybe_prefix(prefix, "model")
[0;36m(EngineCore_DP0 pid=369523)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369523)[0;0m     )
[0;36m(EngineCore_DP0 pid=369523)[0;0m     ^
[0;36m(EngineCore_DP0 pid=369523)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/compilation/decorators.py", line 291, in __init__
[0;36m(EngineCore_DP0 pid=369523)[0;0m     old_init(self, **kwargs)
[0;36m(EngineCore_DP0 pid=369523)[0;0m     ~~~~~~~~^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369523)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 356, in __init__
[0;36m(EngineCore_DP0 pid=369523)[0;0m     self.start_layer, self.end_layer, self.layers = make_layers(
[0;36m(EngineCore_DP0 pid=369523)[0;0m                                                     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=369523)[0;0m         config.num_hidden_layers, get_layer, prefix=f"{prefix}.layers"
[0;36m(EngineCore_DP0 pid=369523)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369523)[0;0m     )
[0;36m(EngineCore_DP0 pid=369523)[0;0m     ^
[0;36m(EngineCore_DP0 pid=369523)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/utils.py", line 606, in make_layers
[0;36m(EngineCore_DP0 pid=369523)[0;0m     maybe_offload_to_cpu(layer_fn(prefix=f"{prefix}.{idx}"))
[0;36m(EngineCore_DP0 pid=369523)[0;0m                          ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369523)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 347, in get_layer
[0;36m(EngineCore_DP0 pid=369523)[0;0m     return layer_class(
[0;36m(EngineCore_DP0 pid=369523)[0;0m         config,
[0;36m(EngineCore_DP0 pid=369523)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=369523)[0;0m         prefix=prefix,
[0;36m(EngineCore_DP0 pid=369523)[0;0m     )
[0;36m(EngineCore_DP0 pid=369523)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoehybrid.py", line 164, in __init__
[0;36m(EngineCore_DP0 pid=369523)[0;0m     self.block_sparse_moe = GraniteMoeMoE(
[0;36m(EngineCore_DP0 pid=369523)[0;0m                             ~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=369523)[0;0m         num_experts=config.num_local_experts,
[0;36m(EngineCore_DP0 pid=369523)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369523)[0;0m     ...<4 lines>...
[0;36m(EngineCore_DP0 pid=369523)[0;0m         prefix=f"{prefix}.block_sparse_moe",
[0;36m(EngineCore_DP0 pid=369523)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369523)[0;0m     )
[0;36m(EngineCore_DP0 pid=369523)[0;0m     ^
[0;36m(EngineCore_DP0 pid=369523)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/models/granitemoe.py", line 101, in __init__
[0;36m(EngineCore_DP0 pid=369523)[0;0m     self.experts = FusedMoE(
[0;36m(EngineCore_DP0 pid=369523)[0;0m                    ~~~~~~~~^
[0;36m(EngineCore_DP0 pid=369523)[0;0m         num_experts=num_experts,
[0;36m(EngineCore_DP0 pid=369523)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369523)[0;0m     ...<9 lines>...
[0;36m(EngineCore_DP0 pid=369523)[0;0m         is_sequence_parallel=self.is_sequence_parallel,
[0;36m(EngineCore_DP0 pid=369523)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369523)[0;0m     )
[0;36m(EngineCore_DP0 pid=369523)[0;0m     ^
[0;36m(EngineCore_DP0 pid=369523)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/layer.py", line 652, in __init__
[0;36m(EngineCore_DP0 pid=369523)[0;0m     self.quant_method.create_weights(layer=self, **moe_quant_params)
[0;36m(EngineCore_DP0 pid=369523)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369523)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/vllm/model_executor/layers/fused_moe/unquantized_fused_moe_method.py", line 174, in create_weights
[0;36m(EngineCore_DP0 pid=369523)[0;0m     torch.empty(
[0;36m(EngineCore_DP0 pid=369523)[0;0m     ~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=369523)[0;0m         num_experts,
[0;36m(EngineCore_DP0 pid=369523)[0;0m         ^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369523)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=369523)[0;0m         dtype=params_dtype,
[0;36m(EngineCore_DP0 pid=369523)[0;0m         ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=369523)[0;0m     ),
[0;36m(EngineCore_DP0 pid=369523)[0;0m     ^
[0;36m(EngineCore_DP0 pid=369523)[0;0m   File "/projects/bfdz/zluo8/tool_and_judge2/.venv/lib/python3.13/site-packages/torch/utils/_device.py", line 103, in __torch_function__
[0;36m(EngineCore_DP0 pid=369523)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=369523)[0;0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 432.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 192.31 MiB is free. Including non-PyTorch memory, this process has 39.30 GiB memory in use. Of the allocated memory 38.80 GiB is allocated by PyTorch, and 690.50 KiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
